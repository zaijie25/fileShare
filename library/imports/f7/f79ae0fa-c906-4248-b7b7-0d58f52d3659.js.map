{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\msg\\MsgView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { MsgEvent, MsgType } from \"./MsgEvent\";\r\nimport PoolBase from \"../../../core/tool/PoolBase\";\r\nimport ViewBase from \"../../../core/ui/ViewBase\";\r\nimport MsgModel from \"../../../hallcommon/model/MsgModel\";\r\nimport WaitingView from \"../waiting/WaitingView\";\r\n\r\nexport default class MsgView extends ViewBase{\r\n    MsgModel: MsgModel;\r\n    contentNode: any;\r\n    copyItem: any;\r\n    contentTxt:cc.Label;\r\n    fromTxt:cc.Label;\r\n    timeTxt:cc.Label;\r\n    selectId:number;\r\n    deleteBtn: cc.Node;\r\n    leftPanel: cc.Node;\r\n    rightPanel: cc.Node;\r\n    timerID: any;\r\n    flag:boolean\r\n    NoEmail:cc.Node\r\n    msgType :number\r\n    itemPool: MailItemPool;\r\n    deleteTimer:any;\r\n    deleteFlag = true\r\n    nodeList: any[] = [];\r\n    private waitingNode :cc.Node;\r\n    protected onSubViewShow(){\r\n        this.waitingNode.active = true;\r\n        this.MsgModel.on(MsgEvent.MsgListCallback, this, this.RefreshLeftPanel);\r\n        this.MsgModel.on(MsgEvent.ReadMsgCallBack, this, this.RefreshInfoPanel);\r\n        this.MsgModel.on(MsgEvent.DeleteMsgCallback, this, this.OnDeleteMail);\r\n        this.flag = true\r\n        this.InitData()\r\n    }\r\n\r\n\r\n    InitData() {\r\n        let data = this.MsgModel.GetDataByType(this.msgType);\r\n        if(data)\r\n        {\r\n            this.RefreshLeftPanel(data)\r\n        }\r\n        else\r\n        {\r\n            this.MsgModel.GetMsgList(this.msgType)\r\n        }\r\n    }\r\n\r\n    OnDeleteMail(data: any) {\r\n        Global.UI.fastTip(\"删除成功\");\r\n        this.ReSetRightPanel()\r\n        this.RefreshLeftPanel(this.MsgModel.GetDataByType(this.msgType))\r\n\r\n    }\r\n\r\n    private initItemPool(){\r\n       \r\n        this.itemPool = new MailItemPool(this.copyItem);\r\n    }\r\n\r\n    protected initView(){\r\n        this.copyItem = this.getChild(\"LeftPanel/MsgItem\");\r\n        this.leftPanel = this.getChild(\"LeftPanel\");\r\n        this.rightPanel = this.getChild(\"RightPanel\");\r\n        this.contentNode = this.getChild(\"LeftPanel/scrollview/view/content\");\r\n\r\n        let tmpContentTxt = this.getChild(\"RightPanel/scrollview/view/content/Content\");\r\n        this.contentTxt = tmpContentTxt.getComponent(cc.Label);\r\n        this.contentTxt.string = \"\"\r\n\r\n        let tmpFromTxt = this.getChild(\"RightPanel/from\");\r\n        this.fromTxt = tmpFromTxt.getComponent(cc.Label);\r\n        this.fromTxt.string = \"\"\r\n        let tmpTimeTxt = this.getChild(\"RightPanel/time\");\r\n        this.timeTxt = tmpTimeTxt.getComponent(cc.Label);\r\n        this.timeTxt.string = \"\"\r\n        this.deleteBtn = this.getChild(\"RightPanel/DeleteButton\");\r\n        this.deleteBtn.active = false\r\n        this.addCommonClick(\"RightPanel/DeleteButton\", this.DeleteMail, this);\r\n        this.NoEmail = this.getChild(\"NoMail\")\r\n        this.NoEmail.active = false\r\n        this.MsgModel = <MsgModel>Global.ModelManager.getModel(\"MsgModel\");\r\n        this.msgType = MsgType.Mail\r\n        this.initItemPool();\r\n        this.waitingNode = WaitingView.initWaitingView(this.node,cc.v2(120,0));\r\n\r\n    }\r\n    DeleteMail() {\r\n        if(!this.deleteFlag)\r\n        {\r\n            Global.UI.fastTip(\"您的操作太频繁，请稍后重试\")\r\n            return\r\n        }\r\n        this.deleteFlag = false\r\n        this.MsgModel.DelMail(this.selectId);\r\n        this.deleteTimer = setTimeout(() => {\r\n            this.deleteFlag = true\r\n        }, 1000);\r\n        \r\n    }\r\n\r\n   \r\n    protected onSubViewHide() {\r\n        this.ReSetRightPanel()\r\n        this.MsgModel.off(MsgEvent.MsgListCallback, this, this.RefreshLeftPanel);\r\n        this.MsgModel.off(MsgEvent.ReadMsgCallBack, this, this.RefreshInfoPanel);\r\n        this.MsgModel.off(MsgEvent.DeleteMsgCallback, this, this.OnDeleteMail);\r\n        this.selectId = 0;\r\n\r\n        // let MsgFlag = this.MsgModel.CheckIsAnyMailNotRead()\r\n        // if (MsgFlag) {\r\n        //     Global.Event.event(GlobalEvent.ShowRedSpot, [false, HallRedSpotType.Mail]);\r\n        // }\r\n        // else {\r\n        //     Global.Event.event(GlobalEvent.CloseRedSpot, HallRedSpotType.Mail);\r\n        // }\r\n    }\r\n\r\n    RefreshLeftPanel(msg:any)\r\n    {\r\n        if(msg == null)\r\n        {\r\n            this.waitingNode.active = false;\r\n            this.NoEmail.active = true\r\n            this.leftPanel.active =false\r\n            this.rightPanel.active =false\r\n            return\r\n        }\r\n        this.recycle()\r\n        if( msg.mail.length===0)\r\n        {\r\n            this.waitingNode.active = false;\r\n            this.NoEmail.active = true\r\n            this.leftPanel.active =false\r\n            this.rightPanel.active =false\r\n            return;\r\n        }\r\n        \r\n        let arr: Array<any> = msg.mail || [];\r\n\r\n        let count =arr.length;\r\n\r\n        this.leftPanel.active = true;\r\n        this.rightPanel.active = true;\r\n        this.NoEmail.active = false\r\n        this.deleteBtn.active = true\r\n        \r\n        for (let j = 0; j < count; j++) {\r\n            let imageItem = this.itemPool.getItem()\r\n            imageItem.name = String(arr[j].id);\r\n            imageItem.setParent(this.contentNode)\r\n            this.nodeList.push(imageItem);\r\n            if (j === 0) {\r\n                imageItem.getComponent(\"MsgItem\").SetToggleChecked(true)\r\n                imageItem.getComponent(\"MsgItem\").node.name = String(arr[j].id);\r\n                this.selectId = arr[j].id\r\n            }\r\n            imageItem.active = true;\r\n            imageItem.on(cc.Node.EventType.TOUCH_END, this.imageItemClick, this)\r\n            imageItem.getComponent(\"MsgItem\").onInit(arr[j])\r\n        }\r\n        \r\n        let gameData = arr[0]\r\n        if(gameData )\r\n        {\r\n            this.MsgModel.ReadMsg(gameData.id,this.msgType,gameData.red_status,)\r\n        }\r\n            \r\n        \r\n    }\r\n    imageItemClick(event) {\r\n        this.waitingNode.active = true;\r\n        Global.Audio.playBtnSound();\r\n        let item = event.target;\r\n        let gameListItem = item.getComponent(\"MsgItem\")\r\n        let gameData = gameListItem.getGameData()\r\n        this.selectId = gameData.id;\r\n        let data = this.MsgModel.GetContentByID(this.msgType,this.selectId)\r\n        if(data)\r\n        {\r\n            this.RefreshInfoPanel(data)\r\n            return\r\n        }\r\n        this.MsgModel.ReadMsg(gameData.id,this.msgType,gameData.red_status,)\r\n    }\r\n    RefreshInfoPanel(data:any){\r\n        this.waitingNode.active = false;\r\n        this.contentTxt.string = \"\\r\\n\"+ Global.Toolkit.removeEmoji(data.content)  || \"\";\r\n        this.timeTxt.string = data.send_time || \"\"\r\n        this.fromTxt.string = Global.Toolkit.substrEndWithElli(data.from,16) || \"\"//data.from || \"\"\r\n        this.RefreshLeftItem(data);\r\n    }\r\n    \r\n    RefreshLeftItem(data:any)\r\n    {\r\n        let node = cc.find(String(data.id),this.contentNode)\r\n        if(node && node.isValid)  \r\n        {\r\n            node.getComponent(\"MsgItem\").SetUnReadActiveState(false)\r\n        }   \r\n        \r\n    }\r\n    \r\n    ReSetRightPanel()\r\n    {\r\n        this.contentTxt.string = \"\";\r\n        this.timeTxt.string = \"\"\r\n        this.fromTxt.string =\"\"\r\n    }\r\n\r\n    protected onDispose()\r\n    {\r\n        if (this.itemPool)\r\n            this.itemPool.resetPool()\r\n        this.nodeList = [];\r\n        if(this.deleteTimer)\r\n        {\r\n            clearTimeout(this.deleteTimer)\r\n        }\r\n    }\r\n    \r\n    public recycle()\r\n    {\r\n        if (this.itemPool)\r\n            this.itemPool.recycleAll(this.nodeList);\r\n        this.nodeList = [];\r\n    }\r\n    \r\n    \r\n}\r\n\r\nclass MailItemPool extends PoolBase{\r\n    constructor(private copyNode: cc.Node){\r\n        super();\r\n    }\r\n    protected createItem(){\r\n        return cc.instantiate(this.copyNode);\r\n    }\r\n\r\n    protected resetItem(node: cc.Node){\r\n        node.active = false;\r\n        node.setParent(null)\r\n    }\r\n    public recycleAll(arr: Array<any>)\r\n    {\r\n        super.recycleAll(arr)\r\n        arr.forEach(ele => {\r\n            this.resetItem(ele);\r\n        });\r\n\r\n    }\r\n}"]}