{"version":3,"sources":["assets\\bbwz\\Bbwz\\scripts\\subview\\player\\BbwzOtherPlayerView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BbwzPlayerBaseView from \"./BbwzPlayerBaseView\";\r\nimport BbwzBetPlayerInterface from \"./BbwzBetPlayerInterface\";\r\nimport BbwzConstDefine from \"../../data/BbwzConstDefine\";\r\nimport BbwzGameEvent from \"../../data/BbwzGameEvent\";\r\nimport BbwzSkinDefine from \"../../data/BbwzSkinDefine\";\r\nimport BbwzData from \"../../data/BbwzData\";\r\n\r\nexport default class BbwzOtherPlayerView extends BbwzPlayerBaseView implements BbwzBetPlayerInterface {\r\n    public isAniming: boolean = false;\r\n    private shakeCount = 0;\r\n\r\n    private rawPos: cc.Vec3;\r\n\r\n    protected headTipsRoot: cc.Node;\r\n    protected headTipsRootRawPos: cc.Vec3;\r\n\r\n    constructor(node: cc.Node, public chair: number) {\r\n        super();\r\n        this.setNode(node);\r\n    }\r\n\r\n    protected initView() {\r\n        super.initView();\r\n        BbwzConstDefine.addCommonClick(this.node, \"useInfo\", this.onUserInfoClick, this, cc.Button.Transition.NONE);\r\n        this.rawPos = this.node.position;\r\n        BbwzData.instance.playerChipsFlyPos[this.chair] = this.getCenterWorldPos();\r\n        this.headTipsRoot = this.getChild(\"headTipsRoot\");\r\n        this.headTipsRootRawPos = this.headTipsRoot.position;\r\n    }\r\n\r\n    public playBetAnim(timeScale: number, shakeCount: number = 1) {\r\n        if (this.shakeCount >= 3) {\r\n            return;\r\n        }\r\n        this.shakeCount += shakeCount;\r\n        if (this.isAniming) return;\r\n        this.shakeHead(timeScale);\r\n    }\r\n\r\n    /**\r\n     * 执行抖动动作\r\n     */\r\n    private shakeHead(time: number) {\r\n        this.isAniming = true;\r\n        if (this.shakeCount > 0) {\r\n            let offset = this.node.x < 0 ? cc.v2(20, 0) : cc.v2(-20, 0);\r\n            let out = cc.moveBy(time / 2, offset, 0);\r\n            let back = cc.moveBy(time / 2, 0, 0);\r\n            let seq = cc.sequence(out, back, cc.callFunc(this.shakeHead, this));\r\n            this.node.runAction(seq);\r\n            this.shakeCount--;\r\n        } else {\r\n            this.stopAnim();\r\n        }\r\n    }\r\n    /**\r\n     * 停止抖动\r\n     */\r\n    private stopAnim() {\r\n        this.node.stopAllActions();\r\n        this.node.setPosition(this.rawPos);\r\n        this.shakeCount = 0;\r\n        this.isAniming = false;\r\n    }\r\n\r\n    public getCenterWorldPos() {\r\n        return this.headImgSp.node.parent.convertToWorldSpaceAR(this.headImgSp.node.position);\r\n    }\r\n\r\n    public getHeadTipWorldPos() {\r\n        return this.headTipsRoot.parent.convertToWorldSpaceAR(this.headTipsRootRawPos);\r\n    }\r\n\r\n    private onUserInfoClick() {\r\n        Game.Event.event(BbwzGameEvent.onUserInfoTouch, this.chair, this.getHeadTipWorldPos());\r\n    }\r\n\r\n    public clearByRound() {\r\n        super.clearByRound();\r\n        this.stopAnim();\r\n    }\r\n\r\n    //返回头像之间点的世界坐标\r\n    public getChipStartPos() {\r\n        return this.node.parent.convertToWorldSpaceAR(this.node.position);\r\n    }\r\n}"]}