{"version":3,"sources":["assets\\hall\\scripts\\framework\\native\\WebNative.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["export default class WebNative{\r\n    private safetyMode:boolean = false;     //web安全模式(开启的话正式环境下开发者窗口会重定向到空白页)\r\n    private _windowMap:Map<string,Window> = new Map<string,Window>();\r\n    constructor(){\r\n        if(!this.safetyMode) return;\r\n        if(!CC_DEBUG && cc.sys.isBrowser){\r\n            let isTest = (<any>window).packInfo.test || false;\r\n            if(!isTest){    //正式环境下不允许F12调试并关闭console.log\r\n                console.log = ()=>{}    \r\n                console.error = ()=>{}\r\n                console.warn = ()=>{}\r\n                console.info = ()=>{}\r\n                this.checkDevTools({\r\n                    opened: function() {    //打开调试后页面重定向至空白页\r\n                       // console.log(\"打开F12\")\r\n                        window.location.href = \"about:blank\"\r\n                    },\r\n                    offed: function() {\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    setup(){\r\n        this.faceBookInit();\r\n    }\r\n\r\n    faceBookInit(){         //初始化faceBook sdk\r\n        (function(d, s, id){\r\n            var js, fjs = d.getElementsByTagName(s)[0];\r\n            if (d.getElementById(id)) {return;}\r\n            js = d.createElement(s); js.id = id;\r\n            js.src = \"https://connect.facebook.net/en_US/sdk.js\";\r\n            fjs.parentNode.insertBefore(js, fjs);\r\n            // console.log(\"FaceBook:初始化\",js,fjs)\r\n        }(document, 'script', 'facebook-jssdk'));\r\n\r\n\r\n        (<any>window).fbAsyncInit = function(){\r\n            (<any>window).FB.init({\r\n                appId      : \"858850087975908\",\r\n                xfbml      : true,\r\n                version    : \"v8.0\"\r\n            });\r\n            (<any>window).FB.AppEvents.logPageView();\r\n        };\r\n    }\r\n    \r\n    /**\r\n     * 检查faceBook登录状态\r\n     * @param callBack \r\n     */\r\n    checkFaceBookLoginState(callBack?:Function){\r\n        (<any>window).FB.getLoginStatus((response) => {\r\n            if(callBack){\r\n                callBack(response);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * facebook登录\r\n     * @param callBack \r\n     */\r\n    faceBookLogin(callBack?:Function){\r\n        (<any>window).FB.login(function(response) {\r\n            if(callBack){\r\n                callBack(response);\r\n            }\r\n        });\r\n    }\r\n    \r\n    /**\r\n     * facebook登出\r\n     * @param callBack \r\n     */\r\n    faceBookLogout(callBack?:Function){\r\n        (<any>window).FB.logout(function(response) {\r\n            // Person is now logged out\r\n            if(callBack){\r\n                callBack(response);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * web端复制文本函数\r\n     * @param text 需要复制的文本内容\r\n     * @param callBack \r\n     */\r\n    webCopyTextToClipboard(text:string,callBack?:Function){\r\n        let result = -1;\r\n        const textString = text.toString();\r\n\r\n        let input:HTMLInputElement = document.getElementById(\"copy_input\") as HTMLInputElement;\r\n        if(!input){\r\n            input = document.createElement(\"input\");\r\n            input.id = \"copy_input\";\r\n            input.readOnly = true;\r\n            input.style.position = \"absolute\";\r\n            input.style.left = \"-10000px\";\r\n            input.style.zIndex = \"-1000\";\r\n            document.body.appendChild(input);\r\n        }\r\n        input.value = textString;\r\n        let endIndex = textString.length\r\n        selectText(input,0,endIndex);\r\n        if(document.execCommand(\"copy\")){\r\n            document.execCommand(\"copy\");\r\n            result = 0;\r\n        }\r\n\r\n        function selectText(textBox:HTMLInputElement,startIndex:number,endIndex:number) {\r\n            textBox.setSelectionRange(startIndex,endIndex);\r\n            textBox.focus();\r\n        }\r\n\r\n        if(callBack){\r\n            callBack({\"result\":result});\r\n            document.body.removeChild(input);\r\n            callBack = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 初始化一个外部窗口\r\n     * @param key 窗口key\r\n     */\r\n    initWindow(key:string){\r\n        if(!key){\r\n            Logger.error(\"key is null\")\r\n            return;\r\n        }\r\n        this._windowMap.set(key,window.open(\"\",\"_blank\"));\r\n    }\r\n\r\n    //当页签在当前页签时，清空之前所有的外部窗口\r\n    clearWindowMap(){\r\n        this._windowMap.clear();\r\n    }\r\n\r\n    /**\r\n     * ios专用打开外部链接窗口\r\n     * @param key 窗口key\r\n     * @param url 重定向url\r\n     */\r\n    openWindowByKey(key:string,url:string){\r\n        if(!key || !url){\r\n            Logger.error(\"key or url is null\")\r\n            return;\r\n        }\r\n        let win = this._windowMap.get(key);\r\n      //  console.log(\"打开外部链接\",this._windowMap);\r\n        if(!win)\r\n            Logger.error(key,\"window is null\");\r\n        else\r\n            win.location.href = url\r\n    }\r\n\r\n    /**\r\n     * web防止F12调式(只能阻止正常打开F12方式,如果)\r\n     * @param options 传入开发者模式打开/关闭回调函数\r\n     */\r\n    checkDevTools(options) {\r\n        const isFF = ~navigator.userAgent.indexOf(\"Firefox\");\r\n        let toTest = \"\";\r\n        if (isFF) {\r\n           toTest = /./;\r\n           toTest.toString = function() {\r\n             options.opened();\r\n           }\r\n        } else {\r\n         toTest = new Image();\r\n         toTest.__defineGetter__('id', function() {\r\n             options.opened();\r\n         });\r\n        }\r\n        setInterval(function() {\r\n           options.offed();\r\n         //  console.log(toTest);\r\n           console.clear && console.clear();\r\n        }, 1000);\r\n     }\r\n}\r\n\r\nexport enum WindowKeyType {\r\n    GameWin = \"GameWin\",            //外接游戏\r\n    RechargeWin = \"RechargeWin\"     //充值\r\n}"]}