{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\DailyGiftMoney\\WndDailyGiftMoneyUI.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WndBase from \"../../../core/ui/WndBase\";\r\nimport { HallRedSpotType } from \"../../../hallcommon/model/HallModel\";\r\nimport HallPopMsgHelper from \"../../tool/HallPopMsgHelper\";\r\nimport { ActivityType } from \"../Activity/ActivityConstants\";\r\n\r\nexport default class WndDailyGiftMoneyUI extends WndBase {\r\n    private dayLabel: cc.Label;\r\n    private weekLabel: cc.Label;\r\n    private monthLabel: cc.Label;\r\n    /**可领取 */\r\n    private selectedNode = [];\r\n    /**已经领取 */\r\n    private noSelectedNode = [];\r\n    /**未达成条件*/\r\n    private unacommpolishedNode = [];\r\n    private daily_cfg = null;\r\n    protected onInit() {\r\n        this.isNeedDelay = true\r\n        this.name = \"WndDailyGiftMoneyUI\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/DailyGiftMoney/DailyGiftMoneyUI\";\r\n    }\r\n    /**日可领取 */\r\n    yesterdayBetBool = false;\r\n    /**周可领取 */\r\n    weekBetBool = false;\r\n    /**月可领取 */\r\n    monthBetBool = false;\r\n\r\n    protected initView() {\r\n        this.selectedNode = [];\r\n        this.noSelectedNode = [];\r\n        this.unacommpolishedNode = [];\r\n        this.dayLabel = this.getComponent(\"item1/jibiLabel\", cc.Label);\r\n        this.weekLabel = this.getComponent(\"item2/jibiLabel\", cc.Label);\r\n        this.monthLabel = this.getComponent(\"item3/jibiLabel\", cc.Label);\r\n        this.addCommonClick(\"button\", this.giftMoneyList, this)\r\n        this.addCommonClick('close', this.close, this)\r\n        for (let i = 1; i < 4; i++) {\r\n            let item = this.getChild(\"item\" + i)\r\n            let selected = cc.find(\"button/btn_lqjl1\", item)\r\n            let noSelected = cc.find(\"button/btn_lqjl3\", item)\r\n            let unacommpolished = cc.find(\"button/btn_lqjl2\", item)\r\n            if (i == 1) {\r\n                Global.UIHelper.addCommonClick(item, \"button/btn_lqjl1\", this.onGetdaily, this);\r\n            } else if (i == 2) {\r\n                Global.UIHelper.addCommonClick(item, \"button/btn_lqjl1\", this.onGetweekly, this);\r\n            } else if (i == 3) {\r\n                Global.UIHelper.addCommonClick(item, \"button/btn_lqjl1\", this.onGetmonthly, this);\r\n            }\r\n            this.selectedNode.push(selected);\r\n            this.noSelectedNode.push(noSelected)\r\n            this.unacommpolishedNode.push(unacommpolished)\r\n            noSelected.active = false;\r\n            selected.active = false;\r\n            unacommpolished.active = false;\r\n        }\r\n        this.dayLabel.string = \"0.00\"\r\n        this.weekLabel.string = \"0.00\"\r\n        this.monthLabel.string = \"0.00\"\r\n    }\r\n    protected onOpen() {\r\n        this.OnDataPrepared();\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.GetDailyGiftMoneyCfg, null, (data) => {\r\n            this.daily_cfg = data;\r\n            let daily = data.daily_cfg\r\n            let weekly = data.weekly_cfg\r\n            let monthly = data.monthly_cfg\r\n            if (!daily || !weekly || !monthly)\r\n                return;\r\n            this.dayLabel.string = Global.Toolkit.GetMoneyFormat(data.daily_point);\r\n            this.weekLabel.string = Global.Toolkit.GetMoneyFormat(data.weekly_point)\r\n            this.monthLabel.string = Global.Toolkit.GetMoneyFormat(data.monthly_point)\r\n            if (data.daily_point == 0) {\r\n                this.selectedNode[0].active = false;\r\n                this.noSelectedNode[0].active = false;\r\n                this.unacommpolishedNode[0].active = true;\r\n                this.yesterdayBetBool = false;\r\n            } else {\r\n                if (data.daily) {\r\n                    this.selectedNode[0].active = true;\r\n                    this.noSelectedNode[0].active = false;\r\n                    this.unacommpolishedNode[0].active = false;\r\n                    this.yesterdayBetBool = true;\r\n                } else {\r\n                    this.selectedNode[0].active = false;\r\n                    this.noSelectedNode[0].active = true;\r\n                    this.unacommpolishedNode[0].active = false;\r\n                    this.yesterdayBetBool = false;\r\n                }\r\n            }\r\n            if (data.weekly_point == 0) {\r\n                this.selectedNode[1].active = false;\r\n                this.noSelectedNode[1].active = false;\r\n                this.unacommpolishedNode[1].active = true;\r\n                this.weekBetBool = false;\r\n            } else {\r\n                if (data.weekly) {\r\n                    this.selectedNode[1].active = true;\r\n                    this.noSelectedNode[1].active = false;\r\n                    this.unacommpolishedNode[1].active = false;\r\n                    this.weekBetBool = true;\r\n                } else {\r\n                    this.selectedNode[1].active = false;\r\n                    this.noSelectedNode[1].active = true;\r\n                    this.unacommpolishedNode[1].active = false;\r\n                    this.weekBetBool = false;\r\n                }\r\n            }\r\n            if (data.monthly_point == 0) {\r\n                this.selectedNode[2].active = false;\r\n                this.noSelectedNode[2].active = false;\r\n                this.unacommpolishedNode[2].active = true;\r\n                this.monthBetBool = false;\r\n            } else {\r\n                if (data.monthly) {\r\n                    this.selectedNode[2].active = true;\r\n                    this.noSelectedNode[2].active = false;\r\n                    this.unacommpolishedNode[2].active = false;\r\n                    this.monthBetBool = true;\r\n                } else {\r\n                    this.selectedNode[2].active = false;\r\n                    this.noSelectedNode[2].active = true;\r\n                    this.unacommpolishedNode[2].active = false;\r\n                    this.monthBetBool = false;\r\n                }\r\n            }\r\n        }, (error) => {\r\n            Global.UI.fastTip(error._errstr);\r\n            // console.log(error);\r\n        }, false, 60);\r\n    }\r\n\r\n    onDispose() {\r\n        // this.CashBackModel.off(CashBackEvent.GetActivityCfg, this, this.DescriptionDay);\r\n        // this.CashBackModel.off(CashBackEvent.GetDayFlowBackAll, this, this.GetAwardResq);\r\n    }\r\n    giftMoneyList() {\r\n        Global.UI.show(\"WndGiftMoneyListUI\", this.daily_cfg)\r\n    }\r\n\r\n    private onGetdaily() {\r\n        this.onGetMoney(1);\r\n    }\r\n\r\n    private onGetweekly() {\r\n        this.onGetMoney(2);\r\n    }\r\n\r\n    private onGetmonthly() {\r\n        this.onGetMoney(3);\r\n    }\r\n\r\n    private onGetMoney(num) {\r\n        let param = {\r\n            \"gift_money_type\": num\r\n        }\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.DoDailyGiftMoney, param, (data) => {\r\n            Global.UI.show(\"WndRebateGet\", data.point);\r\n            Global.HallServer.clearCache(NetAppface.mod, NetAppface.GetDailyGiftMoneyCfg, null)\r\n            this.onOpen()\r\n        }, (error) => {\r\n            Global.UI.fastTip(error._errstr);\r\n            // console.log(error);\r\n        });\r\n    }\r\n\r\n    onClose() {\r\n        if (this.yesterdayBetBool || this.weekBetBool || this.monthBetBool) {\r\n            Global.Event.event(GlobalEvent.ShowRedSpot, [true, HallRedSpotType.DailyGift])\r\n        }else{\r\n            Global.Event.event(GlobalEvent.CloseRedSpot, HallRedSpotType.DailyGift);\r\n        }\r\n        HallPopMsgHelper.Instance.releaseLock(ActivityType.dailyGift);\r\n    }\r\n} \r\n"]}