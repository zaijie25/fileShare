{"version":3,"sources":["assets\\ddz\\ddz\\scripts\\handlers\\DdzPlayHandler.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DdzBaseHandler from \"./DdzBaseHandler\";\r\nimport { DdzGameActState } from \"../data/DdzGameConst\";\r\nimport DdzRuleConst from \"../data/DdzRuleConst\";\r\nimport { DdzAudioConst } from \"../data/DdzPathHelper\";\r\nimport DdzDriver from \"../DdzDriver\";\r\n\r\nexport class DdzPlayStartHandler extends DdzBaseHandler{\r\n    protected execute(msg){\r\n        this.mainUI.callAllPlayers('setState', false);\r\n        this.mainUI.showActionTimer(false);\r\n        this.mainUI.showMarker(true);\r\n        this.mainUI.askActionView.setAutoPlayBtnShow(true);\r\n    }\r\n\r\n    protected executeSync(msg){\r\n        this.execute(msg);\r\n    }\r\n}\r\n\r\nexport class DdzCalPlayHandler extends DdzBaseHandler{\r\n    protected refreshData(msg){\r\n        if (msg._para.play_type == 0){\r\n            this.context.set(this.Define.FieldOnOutPokers, {});     // 清除牌桌当前出牌\r\n        }\r\n    }\r\n    protected execute(msg){\r\n        let localSeat = this.SitHelper.serverSToLocalN(msg._src);\r\n        this.mainUI.callPlayer(localSeat, 'setState', false);\r\n        if (localSeat == 0){\r\n            let selfHandpokers = this.context.getSelfHandPokers()\r\n            if(msg._para.count != selfHandpokers.length)\r\n            {\r\n                this.SendRedeal()\r\n            }\r\n            let isAction = this.context.get(this.Define.FieldOnPlayAction);\r\n            if (isAction){      // 手动出异常牌重新call_play时 刷新手牌  理论上不会粗线 以防万一\r\n                this.mainUI.selfPlayView.refreshHandPokersOnErr(); \r\n                this.context.set(this.Define.FieldOnPlayAction, false);\r\n            }\r\n            // this.mainUI.selfPlayView.setValidPokers();  // 预防\r\n            if (msg._para.play_type == 0){\r\n                this.mainUI.askActionView.setPlayViewShow(true, false, false);            // 主动出牌情况\r\n            }\r\n            else{\r\n                DdzDriver.instance.PlayRuleHelper.initRecommendHelper(this.context.getSelfHandPokers(), this.context.get(this.Define.FieldOnOutPokers));\r\n                if (DdzDriver.instance.PlayRuleHelper.checkBigger()){\r\n                    this.mainUI.askActionView.setPlayViewShow(true, true, true);            // 要得起的情况\r\n                }\r\n                else{\r\n                    this.mainUI.askActionView.setCannotPlayViewShow(true);      // 要不起的情况\r\n                }\r\n            }\r\n        }\r\n        let time = 0;\r\n        let serverTime = msg._times;\r\n        if (serverTime && Game.Component.correctTime){\r\n            let dev = Game.Component.correctTime(serverTime);\r\n            time = msg._timeo * 1000 - dev;\r\n        }\r\n        else{\r\n            time = msg._timeo * 1000 - (Date.now() - msg._receiveTime);\r\n        }\r\n        if (!time || time <= 0)\r\n            time = 1000;\r\n        this.mainUI.showActionTimer(true, localSeat, time, null);\r\n        this.mainUI.clockComp.setClockAudioEnable(true);\r\n        this.mainUI.callPlayer(localSeat, 'showPlayPokers', false);\r\n        this.mainUI.callPlayer(localSeat, 'showPlayerThinkEffect');\r\n    }\r\n\r\n    protected executeSync(msg){\r\n        this.execute(msg);\r\n    }\r\n\r\n    private SendRedeal()\r\n    {\r\n        Game.Server.send(this.Define.CmdRefreshHandPokers,{})\r\n    }\r\n}\r\n\r\nexport class DdzOnPlayHandler extends DdzBaseHandler{\r\n    protected execute(msg){\r\n        let localSeat = this.SitHelper.serverSToLocalN(msg._src);\r\n        let count = msg._para.count;\r\n        let cards = msg._para.cards;\r\n        let type = msg._para.type;\r\n        let playData = DdzDriver.instance.PlayRuleHelper.getPokersType(msg._para.cards);\r\n        this.context.set(this.Define.FieldOnOutPokers, playData);   // 设置当前轮最大出牌数据\r\n\r\n        if (localSeat == 0){\r\n            DdzDriver.instance.PlayRuleHelper.clearRecommend();     //清除提示工具\r\n            this.mainUI.askActionView.setPlayViewShow(false);\r\n            this.context.removeSelfHandPokers(cards);\r\n            let isAction = this.context.get(this.Define.FieldOnPlayAction);\r\n            let isSysPlay = msg._para.flag == 1;            // 系统出牌\r\n            if (isAction){          // 存在临界状态 点了出牌 服务器同时下发超时出牌 导致手牌丢失    (不需要了，等回包再出牌)\r\n                if (isSysPlay){     // 操作了出牌 但是服务器给的是系统出牌\r\n                    this.mainUI.selfPlayView.refreshHandPokersOnErr();\r\n                    this.mainUI.doPlayPokers(cards);\r\n                }\r\n                else{\r\n                    this.mainUI.doResetPokers();\r\n                    this.mainUI.doPlayPokers(cards);\r\n                }\r\n            }\r\n            else{   // 自动出牌走这\r\n                this.mainUI.doResetPokers();\r\n                this.mainUI.doPlayPokers(cards);\r\n            }\r\n        }\r\n        else{\r\n            this.mainUI.callPlayer(localSeat, 'setPlayerLeftPokers', true, count);\r\n            this.mainUI.callPlayer(localSeat, 'showPlayPokers', true, cards, true);\r\n        }\r\n        this.mainUI.showActionTimer(false);\r\n        this.context.set(this.Define.FieldOnPlayAction, false);\r\n        \r\n        let soundRes = DdzRuleConst.getPlayTypeSoundRes(type, playData.weight);\r\n        if (soundRes){\r\n            Global.Audio.playGameBundleSound(DdzAudioConst.genderSoundPath(soundRes, 0), true);\r\n        }\r\n        if (!this.context.get(this.Define.FieldBombBgm)){\r\n            if (DdzRuleConst.checkIsBomb(type) || DdzRuleConst.checkIsRocket(type)){\r\n                Global.Audio.playGameBundleMusic(DdzAudioConst.Bgm2, true);\r\n                this.context.set(this.Define.FieldBombBgm, true);\r\n            }\r\n        }\r\n\r\n        let totalTime = 0.1;\r\n        Game.Component.scheduleOnce(()=>{\r\n            this.mainUI.showPokerTypeEffect(localSeat, type);\r\n        }, totalTime);\r\n\r\n        totalTime += 0.1;       // 分帧执行 否则低端手机会出现卡顿\r\n        Game.Component.scheduleOnce(()=>{\r\n            this.mainUI.callPlayer(localSeat, 'showPlayerPlayEffect', DdzRuleConst.checkIsBomb(type) || DdzRuleConst.checkIsRocket(type));\r\n        }, totalTime);\r\n\r\n        totalTime += 0.1;\r\n        Game.Component.scheduleOnce(()=>{\r\n            this.context.updateMarkerData(cards);\r\n        }, totalTime);\r\n\r\n        totalTime += 0.1;\r\n        if (count > 0 && count <= this.Define.WarnLeftPokerCount){\r\n            this.mainUI.callPlayer(localSeat, 'showWarnSign', true);\r\n            let soundArr = [];\r\n            if (count == 1){\r\n                soundArr = DdzAudioConst.WarningOneArr;\r\n            }\r\n            else if (count == 2){\r\n                soundArr = DdzAudioConst.WarningTwoArr;\r\n            }\r\n            let res = soundArr[Global.Toolkit.getRoundInteger(soundArr.length)];\r\n            if (res){\r\n                Game.Component.scheduleOnce(()=>{\r\n                    Global.Audio.playGameBundleSound(DdzAudioConst.audioCommonPath + DdzAudioConst.WarningAudio, true);\r\n                    Global.Audio.playGameBundleSound(DdzAudioConst.genderSoundPath(res, 0), true);\r\n                }, totalTime);\r\n            }\r\n        }\r\n\r\n        Game.Event.event(Game.EVENT_ADDTIMELOCK, 'DdzOnPlayHandler', totalTime + 0.1);\r\n    }\r\n}\r\n\r\nexport class DdzOnPassHandler extends DdzBaseHandler{\r\n    protected execute(msg){\r\n        let localSeat = this.SitHelper.serverSToLocalN(msg._src);\r\n        if (localSeat == 0){\r\n            this.mainUI.askActionView.setPlayViewShow(false);\r\n            this.mainUI.askActionView.setCannotPlayViewShow(false);\r\n            this.mainUI.doResetPokers();\r\n            DdzDriver.instance.PlayRuleHelper.clearRecommend();\r\n        }\r\n        let data = this.context.get(this.Define.FieldOnOutPokers);\r\n        let res = DdzRuleConst.getPassSoundRes(data.type);\r\n        if (res)\r\n            Global.Audio.playGameBundleSound(DdzAudioConst.genderSoundPath(res, 0), true);\r\n        this.mainUI.callPlayer(localSeat, 'setState', true, DdzGameActState.Play, 0);\r\n        this.mainUI.callPlayer(localSeat, 'showPlayerNormalEffect');\r\n    }\r\n}"]}