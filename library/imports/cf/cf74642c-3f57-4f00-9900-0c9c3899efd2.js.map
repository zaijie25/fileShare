{"version":3,"sources":["assets\\hall\\scripts\\logic\\core\\component\\UIAnimComponent.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n\r\n\r\n@ccclass\r\nexport default class UIAnimComponent extends cc.Component {\r\n\r\n    //动画时长\r\n    private ANIM_TIME = 0.3;\r\n    //背景透明度\r\n    private BG_ALPHA = 178;\r\n\r\n\r\n    @property(cc.Node)\r\n    bg:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    ui:cc.Node= null;\r\n\r\n    public target:IAnimWnd = null;\r\n\r\n    //支持回调方式 也支持接口方式\r\n    public doPopupOpenAnim(finishCallback?)\r\n    {\r\n        if(this.node == null || !this.node.isValid)\r\n        {\r\n            Logger.error(\"doPopupOpenAnim, this.node == null !!!!!\")\r\n            return;\r\n        }\r\n        this.ui.scale = 0.6;\r\n        this.ui.opacity = 255;\r\n        let alphaAction = cc.fadeTo(this.ANIM_TIME, this.BG_ALPHA).easing(cc.easeQuadraticActionInOut());\r\n        let scaleAction = cc.scaleTo(this.ANIM_TIME, 1, 1).easing(cc.easeBackOut());\r\n        let funcAction = cc.callFunc(this.onOpenAnimFinish, this, finishCallback);\r\n        let seq = cc.sequence(scaleAction, funcAction);\r\n        if(this.bg){\r\n            this.bg.opacity = this.BG_ALPHA;//2019-6-5 xiaoC 透明度为0开始变化，有一定几率锁住触屏事件\r\n            this.bg.active = true;\r\n            // this.bg.runAction(alphaAction);\r\n        }\r\n        if(this.ui)\r\n            this.ui.runAction(seq);\r\n        this.setTargetAnimRunning();\r\n    }\r\n\r\n    public doPopupCloseAnim(finishCallback?)\r\n    {\r\n        if(this.node == null || !this.node.isValid)\r\n        {\r\n            Logger.error(\"doPopupCloseAnim, this.node == null !!!!!\")\r\n            return;\r\n        }\r\n        let alphaAction = cc.fadeTo(0.1, 0).easing(cc.easeCubicActionIn());\r\n        //let scaleAction = cc.scaleTo(this.ANIM_TIME, 0.8, 0.8).easing(cc.easeBackIn());\r\n        let scaleAction = cc.fadeTo(0.1, 1).easing(cc.easeBackIn());\r\n        // let hideAction = cc.hide();\r\n        let funcAction = cc.callFunc(this.onCloseAnimFinish, this, finishCallback);\r\n        let seq = cc.sequence(scaleAction, funcAction);\r\n        if(this.bg){\r\n            this.bg.active = true;\r\n            this.bg.runAction(alphaAction);\r\n        }\r\n        if(this.ui)\r\n            this.ui.runAction(seq);\r\n        this.setTargetAnimRunning();\r\n    }\r\n\r\n    public doFullScreenOpenAnim(topNode:cc.Node, leftNode:cc.Node, centerNodeList:cc.Node[],botNode:cc.Node)\r\n    {\r\n        if(topNode)\r\n        {\r\n            let originTopPos = topNode.position;\r\n            topNode.y += topNode.height;\r\n            topNode.runAction(cc.moveTo(0.2, originTopPos).easing(cc.easeCubicActionOut()));\r\n        }\r\n       \r\n        if(leftNode)\r\n        {\r\n            let originLeftPos = leftNode.position;\r\n            leftNode.y += leftNode.height;\r\n            leftNode.runAction(cc.moveTo(0.3, originLeftPos).easing(cc.easeBackOut()));\r\n        }\r\n\r\n        if(centerNodeList && centerNodeList.length > 0)\r\n        {\r\n            for(let i = 0; i < centerNodeList.length; i++)\r\n            {\r\n                let centerNode = centerNodeList[i];\r\n                centerNode.opacity = 1;\r\n                centerNode.runAction(cc.fadeTo(0.3, 255));\r\n            }\r\n        }\r\n\r\n        if(botNode)\r\n        {\r\n            let originTopPos = botNode.position;\r\n            botNode.y -= botNode.height;\r\n            botNode.runAction(cc.moveTo(0.2, originTopPos).easing(cc.easeCubicActionOut()));\r\n        }\r\n\r\n    }\r\n\r\n\r\n    private setTargetAnimRunning()\r\n    {\r\n        if(this.target)\r\n            this.target.isRuningAnim = true;\r\n    }\r\n\r\n    private onOpenAnimFinish(node, finishCallback)\r\n    {\r\n        if(this.target)\r\n        {\r\n            this.target.isRuningAnim = false;\r\n            if(this.target.openAnimFinish)\r\n            {\r\n                this.target.openAnimFinish();\r\n                if(this.target.afterAnimFinish)\r\n                {\r\n                    Global.Component.scheduleOnce(()=>{\r\n                        if(!cc.isValid(this.node))\r\n                            return;\r\n                        this.target.afterAnimFinish();\r\n                    }, 0);\r\n                }\r\n            }\r\n        }\r\n        if(finishCallback)\r\n            finishCallback();\r\n    }\r\n\r\n    private onCloseAnimFinish(node, finishCallback)\r\n    {\r\n        if(this.target)\r\n        {\r\n            this.target.isRuningAnim = false;\r\n            if(this.target.closeAnimFinish)\r\n            {\r\n                this.target.closeAnimFinish();\r\n            }\r\n        }\r\n        if(finishCallback)\r\n            finishCallback();\r\n    }\r\n\r\n}\r\n"]}