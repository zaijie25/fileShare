{"version":3,"sources":["assets\\ermj\\Ermj\\scripts\\subView\\mahjong\\ErmjPlayerHandView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ErmjBaseView from \"../ErmjBaseView\";\r\nimport ErmjOutMjViewManager from \"../../manager/ErmjOutMjViewManager\";\r\nimport ErmjMahjongHandView from \"./ErmjMahjongHandView\";\r\nimport ErmjGameEvent from \"../../data/ErmjGameEvent\";\r\nimport ErmjMahjongOutView from \"./ErmjMahjongOutView\";\r\nimport ErmjMjStyleHelper from \"../../tool/ErmjMjStyleHelper\";\r\nimport ErmjDriver from \"../../ErmjDriver\";\r\n\r\nexport class ErmjPlayerDarkHandView extends ErmjBaseView{\r\n    private lastDealMjItem: ErmjMahjongHandView;\r\n    private handLayout: cc.Layout;\r\n    /** 所有的麻将子数组 不包括摸牌区域那张 */\r\n    private mjHandList: ErmjMahjongHandView[] = [];\r\n    /** 显示在用的麻将子数组 不包括摸牌区域那张 */\r\n    private validMjList: ErmjMahjongHandView[] = [];\r\n    public validCount: number = 0;\r\n    public inRoundDeal: boolean = false;\r\n\r\n    \r\n    constructor(node: cc.Node, protected nSeat: number){\r\n        super();\r\n        this.setNode(node);\r\n    }\r\n\r\n    protected initView(){\r\n        this.handLayout = this.getComponent(\"handLayout\", cc.Layout);\r\n        let copyMjNode = this.getChild(\"mahjongHandView\");\r\n        copyMjNode.active = false;\r\n        this.lastDealMjItem = new ErmjMahjongHandView(copyMjNode);\r\n        this.lastDealMjItem.active = false;\r\n        for (let i = 0; i < this.Define.HandMjMaxCount + 1; i++){       // 多一张发牌时用\r\n            let node = cc.instantiate(copyMjNode);\r\n            node.setParent(this.handLayout.node);\r\n            node.active = true;\r\n            let view = new ErmjMahjongHandView(node);\r\n            view.active = false;\r\n            view.isOut = false;\r\n            this.mjHandList.push(view);\r\n        }\r\n    }\r\n\r\n    public setHandMjShow(flag: boolean){\r\n        this.handLayout.node.active = flag;\r\n    }\r\n\r\n    public setHandMjOutScreen(){\r\n        this.handLayout.node.setPosition(cc.v3(0, -1000));      // debug 自己的虚拟手牌不能作隐藏 直接移出屏幕 \r\n    }\r\n\r\n    /**\r\n     * 发牌\r\n     * @param count 一次摸几张\r\n     * @param valueArr 牌值数组 元素空代表暗牌\r\n     */\r\n    public dealHandMj(count: number = 1, valueArr: number[] = []){\r\n        this.inRoundDeal = false;\r\n        for (let i = 0; i< count; i++){\r\n            this.validCount ++;\r\n            let mjItem = this.mjHandList[this.validCount - 1];\r\n            if (mjItem){\r\n                mjItem.active = true;\r\n                mjItem.isOut = false;\r\n                mjItem.isFront = false;\r\n            }\r\n        }\r\n        this.updateValidPokers();\r\n    }\r\n\r\n    /**\r\n     * 摸牌 轮次摸牌 目前只支持摸一张\r\n     */\r\n    public drawHandMj(){\r\n        let index = this.validCount - 1;\r\n        Logger.error(\"drawHandMj\", this.nSeat, this.validCount);\r\n        if(this.validMjList[index]){\r\n            this.inRoundDeal = true;\r\n            this.lastDealMjItem.active = true;\r\n            this.lastDealMjItem.isFront = false;\r\n            this.lastDealMjItem.isOut = false;\r\n            let worldPos = this.validMjList[index].getWorldPos();\r\n            let localPos = this.lastDealMjItem.node.parent.convertToNodeSpaceAR(worldPos);\r\n            this.lastDealMjItem.node.setPosition(localPos.add(this.Define.LastOneDealOffset[this.nSeat]));\r\n            this.validCount += 1;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 玩家补花 补进来的都是暗牌表现\r\n     * @param outArr 花牌\r\n     * @param isRoundDeal 是否轮次摸牌、开杠摸牌\r\n     */\r\n    public changeFlower(outArr: number[], callback: Function){\r\n        let count = 0;\r\n        let outCount = outArr.length;\r\n        if (this.inRoundDeal && this.lastDealMjItem){           // 摸牌阶段摸到花牌\r\n            this.lastDealMjItem.doChangeFlower(0, 0.2, 0.2);\r\n            count += 1;\r\n        }\r\n        if (count < outCount){\r\n            for(let i = this.validCount - outCount; i < this.validCount; i++){\r\n                let item = this.validMjList[i];\r\n                if(item)\r\n                    item.doChangeFlower(0, 0.2, 0.2);\r\n            }\r\n        }\r\n        Game.Component.scheduleOnce(()=>{\r\n            // 花牌区域add显示\r\n            if (callback)\r\n                callback();\r\n            Game.Event.event(ErmjGameEvent.doPatchwork, outCount);     // 通知从牌山末尾补countz张麻将\r\n        }, 0.2);\r\n\r\n        if(!this.inRoundDeal){\r\n            Game.Component.scheduleOnce(()=>{   // 补花后整理手牌\r\n                this.sortCardDirectly();\r\n            }, 0.71);\r\n        }\r\n    }\r\n\r\n    /** 暗牌n + 1 */\r\n    public readyForOut(){\r\n        if (this.inRoundDeal)\r\n            return;\r\n        let lastOneMj = this.validMjList.pop();\r\n        lastOneMj.active = false;\r\n        lastOneMj.isOut = true;\r\n\r\n        this.inRoundDeal = true;\r\n        this.lastDealMjItem.mahjongValue = lastOneMj.mahjongValue;\r\n        this.lastDealMjItem.active = true;\r\n        this.lastDealMjItem.isOut = false;\r\n        let worldPos = this.validMjList[this.validMjList.length - 1].getWorldPos();\r\n        let localPos = this.lastDealMjItem.node.parent.convertToNodeSpaceAR(worldPos);\r\n        this.lastDealMjItem.node.setPosition(localPos.add(this.Define.LastOneDealOffset[this.nSeat]));\r\n    }\r\n\r\n    public outCard(value: number, callback: Function){\r\n        let outItem = this.getOutItem();\r\n        if (outItem && !outItem.isOut){\r\n            this.handLayout.enabled = false;\r\n            outItem.active = false;\r\n            outItem.isOut = true;\r\n            if(callback){\r\n                callback();\r\n            }\r\n            Game.Component.scheduleOnce(()=>{       // 等0.5s再合并手牌\r\n                this.handLayout.enabled = true;\r\n                this.updateValidPokers();\r\n                this.sortCardDirectly(false);\r\n                this.inRoundDeal = false;\r\n                this.validCount -= 1;\r\n            }, 0.5);\r\n        }\r\n        else{\r\n            console.error(\"outCard outIndex == -1\", this.validCount, outItem);        // 找不到要出的指定牌\r\n        }\r\n    }\r\n\r\n    /** 碰 */\r\n    public pongCard(valueArr: number[]){\r\n        let arr = this.getRightMjItem(2);\r\n        arr.forEach(mjItem=>{\r\n            mjItem.active = false;\r\n            mjItem.isOut = true;\r\n        })\r\n\r\n        this.validCount -= 2;\r\n        this.sortCardDirectly(false);\r\n    }\r\n\r\n    /** 吃 */\r\n    public chowCard(valueArr: number[], chowCard: number){\r\n        let arr = this.getRightMjItem(2);\r\n        arr.forEach(mjItem=>{\r\n            mjItem.active = false;\r\n            mjItem.isOut = true;\r\n        })\r\n\r\n        this.validCount -= 2;\r\n        this.sortCardDirectly(false);\r\n    }\r\n\r\n    /** 杠 */\r\n    public kongCard(type: number, valueArr: number[]){\r\n        if(type == 4){          // 直杠 去掉3张手牌\r\n            let arr = this.getRightMjItem(3);\r\n            arr.forEach(mjItem=>{\r\n                mjItem.active = false;\r\n                mjItem.isOut = true;\r\n            })\r\n            this.validCount -= 3;\r\n        }\r\n        else if(type == 5){     // 碰杠 1张\r\n            let mjItem = this.getOutItem();\r\n            mjItem.active = false;\r\n            mjItem.isOut = true;\r\n            this.validCount -= 1;\r\n        }\r\n        else if(type == 6){     // 暗杠 4张\r\n            let random = Global.Toolkit.getRoundInteger(0, 10);     // 0~9 取随机 摸上手直接杠概率大点\r\n            if (random <= 5 && this.inRoundDeal){\r\n                let arr = this.getRightMjItem(3);     // 手上3张 摸的1张\r\n                arr.forEach(mjItem=>{\r\n                    mjItem.active = false;\r\n                    mjItem.isOut = true;\r\n                })\r\n                this.lastDealMjItem.active = false;\r\n                this.lastDealMjItem.isOut = true;\r\n            }\r\n            else{\r\n                let arr = this.getRightMjItem(4);     // 手上4张\r\n                arr.forEach(mjItem=>{\r\n                    mjItem.active = false;\r\n                    mjItem.isOut = true;\r\n                })\r\n            }\r\n            this.validCount -= 4;\r\n        }\r\n        this.sortCardDirectly(false);\r\n    }\r\n\r\n    /** 随机找一个所出的牌 摸牌了的话随机会计入摸的那张 */ \r\n    public getOutItem(){\r\n        let total = this.validCount;\r\n        let random = Global.Toolkit.getRoundInteger(total);\r\n        if (this.inRoundDeal && random == this.validCount - 1)      // 摸牌后this.validCount会多出一张\r\n            return this.lastDealMjItem;\r\n        else\r\n            return this.validMjList[random];\r\n    }\r\n    \r\n    /** 获取最右几个麻将子 */\r\n    public getRightMjItem(count: number){\r\n        return this.validMjList.slice(this.validMjList.length - count, this.validMjList.length);        // debug 此处不可用validCount, 这个数量是加上发牌那张的\r\n    }\r\n\r\n    public winHideLastDraw(){\r\n        if (this.inRoundDeal && this.lastDealMjItem.active){\r\n            this.lastDealMjItem.active = false;\r\n            this.lastDealMjItem.isOut = true;\r\n            this.inRoundDeal = false;\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * 直接合并手牌排序并刷新位置\r\n     * @param isAnim 是否播放整理动画\r\n     */ \r\n    public sortCardDirectly(isAnim: boolean = false){\r\n        if (this.inRoundDeal && !this.lastDealMjItem.isOut){        // 摸了牌 并且没有打出去或杠出去 合并它\r\n            for(let i = 0; i < this.mjHandList.length; i++){\r\n                let mjItem = this.mjHandList[i];\r\n                if (!mjItem.active && mjItem.isOut){\r\n                    mjItem.active = true;\r\n                    mjItem.isOut = false;\r\n                    mjItem.mahjongValue = this.lastDealMjItem.mahjongValue;\r\n                    break;\r\n                }\r\n            }\r\n            this.lastDealMjItem.active = false;\r\n            this.lastDealMjItem.isOut = true;\r\n        }\r\n        this.updateValidPokers();\r\n        this.sortMjHandList();\r\n    }\r\n\r\n    /** 麻将子数量发生变动时设置 */\r\n    public updateValidPokers(){\r\n        this.validMjList = [];\r\n        this.validMjList = this.mjHandList.filter((item) => {\r\n            return item.active && !item.isOut;\r\n        });\r\n    }\r\n\r\n    /** 排序手牌数组 不刷新位置 此时显示可能是乱序的 */\r\n    private sortMjHandList(){\r\n        this.mjHandList.sort((item1, item2)=>{\r\n            if (!item1.mahjongValue || !item2.mahjongValue)\r\n                return 0;\r\n            return item1.mahjongValue - item2.mahjongValue;\r\n        })\r\n    }\r\n\r\n    public reset(){\r\n        this.inRoundDeal = false;\r\n        this.validCount = 0;\r\n        this.mjHandList.forEach(item=>{\r\n            item.active = false;\r\n            if (item.isSelect)\r\n                item.onSelect();\r\n            item.reset();\r\n        })\r\n        this.lastDealMjItem.active = false;\r\n        this.lastDealMjItem.reset();\r\n        this.handLayout.enabled = true;\r\n    }\r\n}\r\n\r\nexport class ErmjPlayerBrightHandView extends ErmjBaseView{\r\n    protected outMjMgr: ErmjOutMjViewManager;\r\n    private handListNode: cc.Node;\r\n    private handBrightMjList: ErmjMahjongOutView[] = [];\r\n    private validValueArr: number[] = [];\r\n    private inRoundDeal: boolean = false;\r\n\r\n    constructor(node: cc.Node, protected nSeat: number){\r\n        super();\r\n        this.outMjMgr = ErmjDriver.instance.outMjManager;\r\n        this.setNode(node);\r\n    }\r\n\r\n    protected initView(){\r\n        this.handListNode = this.getChild(\"handList\");\r\n    }\r\n\r\n    /** 展示手牌 胡的时候最后一张为胡牌 听牌展示对家时全为手牌 */\r\n    public showDown(cards: number[], isWin: boolean = false, isSort: boolean = false){\r\n        let validCount = 0;\r\n        let nRelative = this.nSeat - this.Context.selfLocalSeat;\r\n        let start = cc.Vec3.ZERO;\r\n        let lastOffset = nRelative == 0 ? cc.v3(10, 0) : cc.v3(-10, 0);\r\n        if (isSort){\r\n            cards.sort((v1, v2)=>{\r\n                return v1 - v2;\r\n            })\r\n        }\r\n        for(let i = 0; i < cards.length; i++){\r\n            let mjItem = this.handBrightMjList[i];\r\n            if (!mjItem)\r\n                mjItem = this.getOneBrightMj();\r\n            let nPersp = this.Define.winBrightMjPerspArr[validCount] || 0;\r\n            mjItem.active = true;\r\n            mjItem.mahjongValue = cards[i];\r\n            mjItem.isFront = true;\r\n            mjItem.setPerspStyle(nPersp, nRelative);\r\n            let config = ErmjMjStyleHelper.getPerspectiveCfg(nPersp);\r\n            mjItem.node.setSiblingIndex(14 - validCount);\r\n            if (isWin && cards.length - 1 == i){\r\n                mjItem.node.setPosition(start.add(lastOffset));\r\n                mjItem.active = false;          // 胡牌把牌放到胡牌区域, 这里隐藏掉\r\n            }\r\n            else{\r\n                mjItem.node.setPosition(start);\r\n                let offsetX = config.dir > 0 ? config.cfg.devSpaceX : config.cfg.negDevSpaceX;\r\n                let spaceX = nRelative == 0 ? offsetX : -offsetX;\r\n                start = cc.v3(start.x + spaceX, 0);\r\n            }     \r\n            validCount ++;\r\n            this.validValueArr.push(cards[i]);\r\n        }\r\n    }\r\n\r\n    public updateBrightMjList(isSeparated: boolean){\r\n        let dev = this.validValueArr.length - this.handBrightMjList.length;\r\n        if (dev > 0){\r\n             for(let i = 0; i < dev; i++){\r\n                this.getOneBrightMj();\r\n             }\r\n        }\r\n        let validCount = 0;\r\n        let nRelative = this.nSeat - this.Context.selfLocalSeat;\r\n        let start = cc.Vec3.ZERO;\r\n        let lastOffset = nRelative == 0 ? cc.v3(10, 0) : cc.v3(-10, 0);\r\n        for(let i = 0; i < this.handBrightMjList.length; i++){\r\n            let mjItem = this.handBrightMjList[i];\r\n            let value = this.validValueArr[i];\r\n            if(value){\r\n                let nPersp = this.Define.winBrightMjPerspArr[validCount] || 0;\r\n                mjItem.active = true;\r\n                mjItem.mahjongValue = value;\r\n                mjItem.isFront = true;\r\n                mjItem.setPerspStyle(nPersp, nRelative);\r\n                let config = ErmjMjStyleHelper.getPerspectiveCfg(nPersp);\r\n                mjItem.node.setSiblingIndex(14 - validCount);\r\n                if (isSeparated && this.validValueArr.length - 1 == i){\r\n                    mjItem.node.setPosition(start.add(lastOffset));\r\n                }\r\n                else{\r\n                    mjItem.node.setPosition(start);\r\n                    let offsetX = config.dir > 0 ? config.cfg.devSpaceX : config.cfg.negDevSpaceX;\r\n                    let spaceX = nRelative == 0 ? offsetX : -offsetX;\r\n                    start = cc.v3(start.x + spaceX, 0);\r\n                }\r\n            }\r\n            else{\r\n                mjItem.active = false;\r\n            }\r\n            validCount ++;\r\n        }\r\n    }\r\n    \r\n    public drawHandMj(value: number){\r\n        this.inRoundDeal = true;\r\n        this.validValueArr.push(value);\r\n        this.updateBrightMjList(true);\r\n    }\r\n\r\n    public readyForOut(value: number){\r\n        if(this.inRoundDeal)\r\n            return;\r\n        this.sortValidValueList();\r\n        let index = this.validValueArr.indexOf(value);\r\n        if (index > -1){\r\n            this.validValueArr.splice(index, 1);\r\n            this.validValueArr.push(value);\r\n        }\r\n        this.updateBrightMjList(true);\r\n    }\r\n\r\n    public changeFlower(outArr: number[], inArr: number[], callback: Function){\r\n        if(outArr.length != 1)\r\n            return console.error(\"error 只会进摸牌补花阶段\", outArr.length);      // 理论上发牌不会进这, 所以无须理牌\r\n        let [outValue] = outArr;\r\n        let [inValue] = inArr;\r\n        let mjItem = this.findMjItemByValue(outValue);\r\n        if (mjItem){\r\n            mjItem.active = false;\r\n            if (callback)\r\n                callback();\r\n            let index = this.validValueArr.indexOf(outValue);\r\n            if (index > -1)\r\n                this.validValueArr.splice(index, 1);\r\n            this.validValueArr.push(inValue);\r\n            Game.Component.scheduleOnce(()=>{\r\n                mjItem.active = true;\r\n                mjItem.mahjongValue = inValue;\r\n            }, 0.4);\r\n        }\r\n    }\r\n\r\n    public outCard(value: number, callback: Function){\r\n        this.inRoundDeal = false;\r\n        let mjItem = this.findMjItemByValue(value);\r\n        if (mjItem){\r\n            if (callback)\r\n                callback();\r\n            mjItem.active = false;\r\n            let index = -1;\r\n            for(let i= this.validValueArr.length -1; i >= 0; i--){\r\n                if (this.validValueArr[i] == value){\r\n                    index = i;\r\n                    break;          // 倒序查找, 优先出右边那张\r\n                }\r\n            }\r\n            if (index > -1)\r\n                this.validValueArr.splice(index, 1);\r\n            Game.Component.scheduleOnce(()=>{\r\n                this.sortValidValueList();\r\n                this.updateBrightMjList(false);\r\n            }, 0.5);\r\n        }\r\n    }\r\n\r\n    public pongCard(valueArr: number[]){\r\n        let count = 2;\r\n        for(let i=0; i < valueArr.length; i++){\r\n            let mjItem = this.findMjItemByValue(valueArr[i]);\r\n            mjItem.active = false;\r\n            let index = this.validValueArr.indexOf(valueArr[i]);\r\n            if (index > -1)\r\n                this.validValueArr.splice(index, 1);\r\n            count --;\r\n            if (count == 0)\r\n                break;\r\n        }\r\n        this.updateBrightMjList(false);\r\n    }\r\n\r\n    public chowCard(valueArr: number[], chowCard: number){\r\n        let count = 2;\r\n        for(let i=0; i < valueArr.length; i++){\r\n            let value = valueArr[i];\r\n            if (value == chowCard)\r\n                continue;\r\n            let mjItem = this.findMjItemByValue(value);\r\n            mjItem.active = false;\r\n            let index = this.validValueArr.indexOf(value);\r\n            if (index > -1)\r\n                this.validValueArr.splice(index, 1);\r\n            count --;\r\n            if (count == 0)\r\n                break;\r\n        }\r\n        this.updateBrightMjList(false);\r\n    }\r\n\r\n    public kongCard(type: number, valueArr: number[]){\r\n        if(type == 4){          // 直杠 去掉3张手牌\r\n            let count = 3;\r\n            for(let i=0; i < valueArr.length; i++){\r\n                let value = valueArr[i];\r\n                let mjItem = this.findMjItemByValue(value);\r\n                mjItem.active = false;\r\n                let index = this.validValueArr.indexOf(value);\r\n                if (index > -1)\r\n                    this.validValueArr.splice(index, 1);\r\n                count --;\r\n                if (count == 0)\r\n                    break;\r\n            }\r\n        }\r\n        else if(type == 5){     // 碰杠 1张\r\n            let value = valueArr[0];\r\n            let mjItem = this.findMjItemByValue(value);\r\n            mjItem.active = false;\r\n            let index = this.validValueArr.indexOf(value);\r\n            if (index > -1)\r\n                this.validValueArr.splice(index, 1);\r\n        }\r\n        else if(type == 6){     // 暗杠 4张\r\n            let count = 4;\r\n            for(let i=0; i < valueArr.length; i++){\r\n                let value = valueArr[i];\r\n                let mjItem = this.findMjItemByValue(value);\r\n                mjItem.active = false;\r\n                let index = this.validValueArr.indexOf(value);\r\n                if (index > -1)\r\n                    this.validValueArr.splice(index, 1);\r\n                count --;\r\n                if (count == 0)\r\n                    break;\r\n            }\r\n        }\r\n        this.updateBrightMjList(false);\r\n    }\r\n\r\n    public winHideLastDraw(value: number){\r\n        let lastMj = this.handBrightMjList[this.validValueArr.length - 1];\r\n        if (this.inRoundDeal && lastMj && lastMj.mahjongValue == value){\r\n            lastMj.active = false;\r\n            this.inRoundDeal = false;\r\n        }\r\n    }\r\n\r\n    private getOneBrightMj(){\r\n        let mjItem = this.outMjMgr.getOneBrightMj();\r\n        mjItem.node.setParent(this.handListNode);\r\n        this.handBrightMjList.push(mjItem);\r\n        return mjItem;\r\n    }\r\n\r\n    private findMjItemByValue(value: number){\r\n        for(let i = this.handBrightMjList.length - 1; i >= 0; i--){     // 倒序查找 优先新摸的牌\r\n            let item = this.handBrightMjList[i];\r\n            if (item.active && item.mahjongValue == value)\r\n                return item;\r\n        }\r\n    }\r\n\r\n    private sortValidValueList(){\r\n        this.validValueArr.sort((v1, v2)=>{\r\n            return v1 - v2;\r\n        })\r\n    }\r\n\r\n    public reset(){\r\n        this.inRoundDeal = false;\r\n        this.handBrightMjList = [];     // 回收麻将子交给ErmjOutMjViewManager\r\n        this.validValueArr = [];\r\n    }\r\n}"]}