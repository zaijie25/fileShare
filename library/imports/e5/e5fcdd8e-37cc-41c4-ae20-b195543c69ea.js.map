{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\playerInfo\\WndNewPlayerInfo.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WndBase from \"../../../core/ui/WndBase\";\r\nimport PlayerInfoModel from \"../../../hallcommon/model/PlayerInfoModel\";\r\nimport BindingGiftModel from \"../../../hallcommon/model/BindingGiftModel\";\r\nimport HallBtnHelper from \"../hall/views/HallBtnHelper\";\r\n\r\nexport default class WndNewPlayerInfo extends WndBase{\r\n\r\n    /**\r\n     * 数据对象\r\n     */\r\n    private model: PlayerInfoModel;\r\n    //昵称\r\n    private nickName:cc.Label;\r\n    //id\r\n    private idLabel:cc.Label;\r\n    //金币\r\n    private pointLabel:cc.Label;\r\n    //手机号\r\n    private phoneLabel:cc.Label;\r\n    //头像\r\n    spriteHead:cc.Sprite = null;\r\n    //头像框\r\n    spriteHeadFrame:cc.Sprite = null;\r\n\r\n    private vipFrame:cc.Sprite;\r\n\r\n    //绑定手机按钮\r\n    private bindBtn:cc.Node;\r\n\r\n    //已绑定手机节点\r\n    private binded:cc.Node;\r\n\r\n    /**\r\n     * 初始化脚本\r\n     */\r\n    protected onInit() {\r\n        this.name = \"WndNewPlayerInfo\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/PlayerInfo/NewPlayerInfoUI\";\r\n        this.model = <PlayerInfoModel>Global.ModelManager.getModel(\"PlayerInfoModel\");\r\n    }\r\n\r\n    onDispose(){\r\n        Global.Event.off(GlobalEvent.PERSONALINFOUPDATE, this, this.refreshPersonInfo)\r\n\r\n    }\r\n\r\n    /**\r\n     * 初始化UI\r\n     */\r\n    protected initView() {\r\n        Global.Event.on(GlobalEvent.PERSONALINFOUPDATE, this, this.refreshPersonInfo)\r\n        this.binded = this.getChild(\"personInfo/panel/bind/binded\");\r\n\r\n        this.addCommonClick(\"bg/close\",this.closeBtnFunc,this);\r\n        this.addCommonClick(\"personInfo/changeBtn\",this.showChooseHeadView,this);\r\n        this.addCommonClick(\"personInfo/idLabel/btn\",this.copyIdFunc,this);\r\n        this.addCommonClick(\"personInfo/nickName/changeBtn\",this.openEditNicknameUI,this);\r\n        this.addCommonClick(\"personInfo/panel/logout\",this.logOutFunc,this);\r\n        this.bindBtn = this.addCommonClick(\"personInfo/panel/bind/bindBtn\",this.openBindUi,this);\r\n        this.addCommonClick(\"personInfo/panel/setting\",this.openSettingUi,this);\r\n        this.addCommonClick(\"personInfo/coinBar/add\",this.addPonitBtn,this);\r\n        this.addCommonClick(\"personInfo/vipFrame\",this.showVipView,this);\r\n\r\n\r\n        this.nickName = this.getComponent(\"personInfo/nickName/nickLabel\",cc.Label);\r\n        this.idLabel = this.getComponent(\"personInfo/idLabel/id\",cc.Label);\r\n        this.pointLabel = this.getComponent(\"personInfo/coinBar/coinLabel\",cc.Label);\r\n        this.spriteHead =this.getComponent(\"headImg/headFrame\", cc.Sprite);\r\n        this.spriteHeadFrame = this.getComponent(\"headbox\", cc.Sprite);\r\n        this.phoneLabel = this.getComponent(\"personInfo/panel/bind/binded/phone\",cc.Label);\r\n        this.vipFrame = this.getComponent(\"personInfo/vipFrame\",cc.Sprite);\r\n    }\r\n\r\n    private showVipView(){\r\n        Global.Event.event(GlobalEvent.SHOW_NET_WAITING, \"WndVip3\")\r\n        Global.UI.show(\"WndVip3\");\r\n    }\r\n\r\n    private showChooseHeadView(){\r\n        Global.UI.show(\"WndChooseHead\");\r\n    }\r\n\r\n    private copyIdFunc(){\r\n        Global.NativeEvent.copyTextToClipboard(String(Global.PlayerData.uid), this.copyTextToClipboardCallBack.bind(this) );\r\n    }\r\n\r\n    private openEditNicknameUI(){\r\n        Global.UI.show(\"WndEditName\");\r\n    }\r\n\r\n    private copyTextToClipboardCallBack(retStr){\r\n        if (retStr.result == 0) {\r\n            Global.UI.fastTip(\"复制成功\");\r\n        }else {\r\n            Global.UI.fastTip(\"复制失败\");\r\n        }\r\n    }\r\n\r\n    private logOutFunc(){\r\n        Global.UI.show(\"WndMessageBox\", \"您确定退出当前账号返回登录界面？\", 1, ()=>{\r\n            Global.SceneManager.goToLogin();\r\n        }, ()=>{\r\n            \r\n        });\r\n    }\r\n\r\n    private openBindUi(){\r\n        Global.UI.show(\"WndBindPhone\");\r\n    }\r\n\r\n    private openSettingUi(){\r\n        Global.UI.show(\"WndSetting\");\r\n    }\r\n\r\n    private addPonitBtn(){\r\n        HallBtnHelper.WndRechargeOpen();\r\n    }\r\n\r\n    /**\r\n     * 界面打开回调\r\n     */\r\n    protected onOpen(){\r\n        this.model.reqGetUserInfo(null,null);\r\n        this.refreshPersonInfo();\r\n        var model = <BindingGiftModel>Global.ModelManager.getModel(\"BindingGiftModel\");\r\n        let playerData = Global.PlayerData;\r\n        if (playerData.phone == \"\" && model.BindAwardNum != 0) {\r\n            Global.UI.show(\"WndBindingGift\"); \r\n        }\r\n    }\r\n\r\n    private refreshPersonInfo(){\r\n        if(Global.SceneManager.inGame())\r\n        {\r\n            return\r\n        }\r\n        var data = Global.PlayerData;\r\n        this.nickName.string = Global.Toolkit.removeEmoji(data.nickname);\r\n        this.idLabel.string =   String(data.uid);\r\n\r\n        let phoneStr = data.phone.split(\" \")[1];\r\n        phoneStr = phoneStr || data.phone;\r\n        this.bindBtn.active = phoneStr == \"\";\r\n        this.binded.active = phoneStr != \"\";\r\n        this.phoneLabel.string = Global.Toolkit.formateStrWithAsterisk(phoneStr, 3, 4);\r\n        this.pointLabel.string = Global.Toolkit.formatPointStr(Global.PlayerData.point, true).toString();\r\n        this.spriteHead.spriteFrame = Global.Toolkit.getLocalHeadSf(data.headimg);\r\n        //头像框设置\r\n        Global.Toolkit.loadLocalHeadFrame(this.spriteHeadFrame, data.headkuang);\r\n\r\n        //vip图标设置\r\n        var atlasString = \"hall/texture/hall/playerInfo/AutoAtlas_playerinfo\";\r\n        var sfString0 = \"vip_tq\" + data.vip;\r\n        Global.ResourceManager.loadAutoAtlas(this.vipFrame, atlasString, sfString0, null, false);\r\n    }\r\n    /**\r\n     * 界面关闭回调\r\n     */\r\n    protected onClose(){\r\n        // this.currYeqian = -1\r\n        // this.close();\r\n    }\r\n\r\n    /**\r\n     * 关闭按钮点击\r\n     */\r\n    private closeBtnFunc(){\r\n        this.close();\r\n    }\r\n}"]}