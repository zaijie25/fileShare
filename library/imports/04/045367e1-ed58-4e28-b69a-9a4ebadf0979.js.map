{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\hall\\views\\GameItemView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ViewBase from \"../../../../core/ui/ViewBase\";\r\nimport GameHotUpdateComponent from \"../../../../core/hotUpdate/component/GameHotUpdateComponent\";\r\nimport HallStorageKey from \"../../../../hallcommon/const/HallStorageKey\";\r\nimport HallModel from \"../../../../hallcommon/model/HallModel\";\r\nimport { GameType } from \"../../ChooseRoom/WndGameLobbyShell\";\r\nimport BindingButtonEffect from \"../../../../core/component/BindingButtonEffect\";\r\nimport ButtonPlus from \"../../../../core/component/ButtonPlus\";\r\nimport YXButton from \"../../../../core/component/YXButton\";\r\n//初始 -1000 -1 没下载过 0 下载成功并且版本是最新  1下载成功，版本不是最新 2下载中 3等待下载   4下载失败\r\nenum GameDownloadStatus {\r\n    INIT = -1000,\r\n    NEVER_DOWNLOAD = -1,\r\n    NEW_VERSION_SUCCESS = 0,\r\n    OLD_VERSION = 1,\r\n    DOWNLOADING = 2,\r\n    WAIT_DOWNLOAD = 3,\r\n    FAILD = 4\r\n}\r\n\r\n// 1开放，2即将上线，3维护\r\nenum GameStatue {\r\n    None = 0,\r\n    Open,\r\n    Soon,\r\n    Maintain,\r\n}\r\n\r\n\r\nexport default class GameItemView extends ViewBase {\r\n    gameData: any;\r\n    //纯客户端资源配置\r\n    public gameResData: any;\r\n    updateState: cc.Node;\r\n\r\n    gameUpdateState = GameDownloadStatus.INIT;  //  -1 没下载过 0 下载成功并且版本是最新  1下载成功，版本不是最新 2下载中 3等待下载   4下载失败   ----// 1 new 2 下载中 3下载成功  4下载失败  \r\n\r\n    updateState_download: cc.Node;\r\n    updateState_waiting: cc.Node;\r\n    updateState_update: cc.Node;\r\n    updateState_stop: cc.Node;\r\n    updateState_loading: cc.Node;\r\n    //gameitem中的spine节点\r\n    spineNode: cc.Node;\r\n\r\n    isBtnClick = false;\r\n    checked = false;\r\n    updateComponent: GameHotUpdateComponent;\r\n\r\n\r\n    private index;\r\n\r\n    private tagImg: cc.Node;\r\n    private tagSpineNode: cc.Node;\r\n    private grayImg: cc.Node;\r\n    private weihuFlag: cc.Node;\r\n    private waitFlag: cc.Node;\r\n\r\n    private tagParent:cc.Node\r\n\r\n    private gameIconNode: cc.Node;\r\n\r\n    private effectMountNode: cc.Node;\r\n\r\n    //支持spine和dragonbones两种格式\r\n    private spine: sp.Skeleton;\r\n    private dragonBones: dragonBones.ArmatureDisplay;\r\n\r\n    private tagResMap = {\r\n        1: \"hall@effect/gameicon/huobao\",\r\n        2: \"hall@effect/gameicon/tuijian\",\r\n        3: \"hall@effect/gameicon/zuixin\",\r\n    }\r\n\r\n    /**\r\n     * 将子游戏icon渲染层进行分成达到优化drawcall\r\n     * @param parentNode 分层父节点\r\n     */\r\n    moveSpine(parentNode:cc.Node)\r\n     {\r\n        if(!cc.isValid(parentNode)) return\r\n        let spineNode = parentNode.getChildByName(\"spineNode\")\r\n\r\n       \r\n        let spine = cc.find(`${this.gameData.prefabName}/effect`,this.effectMountNode)\r\n        if(cc.isValid(spine))\r\n        {\r\n            let pos = Global.UIUtil.convertSameNodePos(this.effectMountNode,spineNode,spine.position)\r\n            spine.setParent(spineNode)\r\n            spine.setPosition(pos)\r\n        }\r\n        let backgroundNode = parentNode.getChildByName(\"backgroundNode\")\r\n        let pos1 = Global.UIUtil.convertSameNodePos(this.node,backgroundNode)\r\n        if(cc.isValid( this.effectMountNode))\r\n        {\r\n            this.effectMountNode.setParent(backgroundNode)\r\n            this.effectMountNode.setPosition(pos1)\r\n        }\r\n       \r\n        let tagStr = `tagNode_${this.gameData.top}`\r\n        let tagParentNode =  parentNode.getChildByName(tagStr)\r\n        let tagNode = cc.find(\"tag\",this.node)\r\n\r\n        let pos2 = Global.UIUtil.convertSameNodePos(tagNode,backgroundNode)\r\n\r\n        if(cc.isValid( this.tagSpineNode))\r\n        {\r\n            this.tagSpineNode.setParent(tagParentNode)\r\n            this.tagSpineNode.setPosition(pos2)\r\n        }\r\n\r\n        let nameParentNode =  parentNode.getChildByName(\"nameNode\")\r\n        let nameNode = cc.find(`${this.gameData.prefabName}/name`,this.effectMountNode)\r\n        let prefabNode = cc.find(`${this.gameData.prefabName}`,this.effectMountNode)\r\n\r\n        let pos3 = Global.UIUtil.convertSameNodePos(prefabNode,nameParentNode)\r\n\r\n        if(cc.isValid( nameNode))\r\n        {\r\n            nameNode.setParent(nameParentNode)\r\n            nameNode.setPosition(pos3)\r\n        }\r\n\r\n\r\n    }   \r\n\r\n    registerEvent() {\r\n        Global.Event.on(GlobalEvent.UPDATE_SUB_GAME_FAILED, this, this.onUpdateSubGameFailed)\r\n        Global.Event.on(GlobalEvent.UPDATE_SUB_GAME_FINISH, this, this.onUpdateSubGameFinish)\r\n        Global.Event.on(GlobalEvent.UPDATE_SUB_GAME_PERCENT, this, this.onUpdateSubGamePercent)\r\n        Global.Event.on(GlobalEvent.UPDATE_SUB_GAME_STATE, this, this.checkGameUpdateState)\r\n    }\r\n\r\n    unRegisterEvent() {\r\n        Global.Event.off(GlobalEvent.UPDATE_SUB_GAME_FAILED, this, this.onUpdateSubGameFailed)\r\n        Global.Event.off(GlobalEvent.UPDATE_SUB_GAME_FINISH, this, this.onUpdateSubGameFinish)\r\n        Global.Event.off(GlobalEvent.UPDATE_SUB_GAME_PERCENT, this, this.onUpdateSubGamePercent)\r\n        Global.Event.off(GlobalEvent.UPDATE_SUB_GAME_STATE, this, this.checkGameUpdateState)\r\n    }\r\n\r\n    onUpdateSubGameFailed(gid) {\r\n        \r\n        if (!gid) {\r\n            Logger.error(\"onUpdateSubGameFailed gid == null\")\r\n            return;\r\n        }\r\n        if (!this.gameData) {\r\n            Logger.error(\"onUpdateSubGameFailed this.gameData == null\")\r\n            return;\r\n        }\r\n        if (Number(gid) === this.gameData.game_id) {\r\n            this.needFaildView();\r\n        }\r\n    }\r\n    onUpdateSubGameFinish(gid) {\r\n        if (!gid) {\r\n            return;\r\n        }\r\n        if (!this.gameData) {\r\n            return;\r\n        }\r\n        if (gid === this.gameData.game_id) {\r\n            if(!this.gameIconNode || !this.gameIconNode.isValid)\r\n            {\r\n                return\r\n            }\r\n            this.setNodeAlpha(255)\r\n            //Global.UIHelper.setNodeGray(this.gameIconNode, false, 255, true);\r\n            this.alreadyGameView(true)\r\n        }\r\n    }\r\n\r\n    \r\n\r\n\r\n    onUpdateSubGamePercent(gid, per) {\r\n        if (!gid) {\r\n            return;\r\n        }\r\n        if (!this.gameData) {\r\n            return;\r\n        }\r\n        // Logger.log(\"onUpdateSubGamePercent  gid = \" + gid + \" per = \" + per)\r\n        if (gid === this.gameData.game_id) {\r\n            this.downloadingView(per)\r\n        }\r\n    }\r\n\r\n    protected initView() {\r\n        this.tagImg = cc.find(\"tag/img\", this.node)\r\n        this.tagSpineNode = cc.find(\"tag/spineNode/spineParent\", this.node)\r\n        this.grayImg = cc.find(\"grayImg\", this.node);\r\n        this.weihuFlag = this.grayImg.getChildByName('weihuFlag');\r\n        this.waitFlag = this.grayImg.getChildByName('waitFlag');\r\n        this.spineNode = cc.find(\"spineNode\", this.node)\r\n\r\n        this.effectMountNode = this.getChild(\"iconMountNode\");\r\n\r\n        this.updateState = cc.find(\"updateState\", this.node)\r\n        this.updateState.active = true;\r\n        this.updateState_download = this.updateState.getChildByName(\"download\");\r\n        this.updateState_waiting = this.updateState.getChildByName(\"waiting\");\r\n        this.updateState_update = this.updateState.getChildByName(\"update\");\r\n        this.updateState_stop = this.updateState.getChildByName(\"stop\");\r\n        this.updateState_loading = this.updateState.getChildByName(\"loading\");\r\n        this.updateState_download.active = false;\r\n        this.updateState_waiting.active = false;\r\n        this.updateState_update.active = false;\r\n        this.updateState_stop.active = false;\r\n        this.updateState_loading.active = false;\r\n\r\n        this.registerEvent();\r\n        this.isBtnClick = false;\r\n        // this.node.on(cc.Node.EventType.TOUCH_END, this.onItemClick, this);\r\n        // this.updateState.on(cc.Node.EventType.TOUCH_END, this.onItemClick, this);\r\n    }\r\n\r\n    public setServerInfo(gameData, index) {\r\n        this.gameData = gameData;\r\n        this.index = index;\r\n        this.updateTag();\r\n        this.updateGameStatus();\r\n    }\r\n\r\n    //设置资源信息\r\n    public async setResInfo(gameRes) {\r\n        return new Promise(async resolve =>{\r\n            this.gameResData = gameRes;\r\n            let name = gameRes.prefabName\r\n            let result = await this.loadGameIcon(name);\r\n            resolve(result)\r\n        })\r\n       \r\n    }\r\n\r\n    private loadGameIcon(name) {\r\n        return new Promise((resolve,reject )=> {\r\n            let iconPath = \"hall@effect/gameicon/\" + name;\r\n            if (this.gameResData.platformIconPath && this.gameResData.platformIconPath != \"\")\r\n                iconPath = this.gameResData.platformIconPath;\r\n            Global.ResourceManager.releaseHelper.markUsed(iconPath);\r\n            Global.ResourceManager.loadRes(iconPath, (error, prefab) => {\r\n                if (error != null) {\r\n                    Logger.error(\"加载图标特效异常\", iconPath);\r\n                    reject(error)\r\n                }\r\n               if(!cc.isValid(this.node) || !cc.isValid(this.effectMountNode)) return\r\n                let effect = cc.instantiate(prefab) as cc.Node;\r\n                // effect.scale = 0.95;\r\n                this.effectMountNode.addChild(effect);\r\n\r\n                effect.position = cc.Vec2.ZERO;\r\n                for (let index = 0; index < effect.childrenCount; index++) {\r\n                    let element = effect.children[index];\r\n                    let component = element.getComponent(BindingButtonEffect)\r\n                    if(!component)\r\n                    {\r\n                        element.addComponent(BindingButtonEffect)\r\n                    }\r\n                    \r\n                }\r\n                this.gameIconNode = effect;\r\n               \r\n                this.spine = effect.getComponentInChildren(sp.Skeleton)\r\n                this.dragonBones = effect.getComponentInChildren(dragonBones.ArmatureDisplay);\r\n\r\n                this.gameIconNode.setPosition(0, 0)\r\n                resolve(prefab)\r\n            }, null, null, false, true)\r\n        })\r\n\r\n    }\r\n\r\n\r\n\r\n    //tag状态，最新、火爆等\r\n    private updateTag() {\r\n        if (this.gameData.status !== 1) {\r\n            this.tagImg.active = false;\r\n            this.tagSpineNode.active = false;\r\n            return;\r\n        }\r\n        this.tagSpineNode.active = true\r\n        let tagEffPath = \"\";\r\n        let tagRes = this.tagResMap[this.gameData.top];\r\n        if (tagRes != null) {\r\n            this.tagSpineNode.active = true;\r\n            tagEffPath = tagRes;\r\n            this.tagSpineNode.removeAllChildren();\r\n            this.tagImg.active = false\r\n            Global.ResourceManager.loadRes(tagEffPath, (error, Prefab) => {\r\n                if (error) {\r\n                    return;\r\n                }\r\n                if(!cc.isValid(this.node) || !cc.isValid(this.tagSpineNode)) return\r\n                if (Prefab) {\r\n                    let preTag = cc.instantiate(Prefab);\r\n                    preTag.name = \"newTag\";\r\n                    let component = this.tagSpineNode.getComponent(BindingButtonEffect)\r\n                    if(!component)\r\n                    {\r\n                        component =  this.tagSpineNode.addComponent(BindingButtonEffect)\r\n                    }\r\n                    let btn = this.node.getComponent(YXButton)\r\n                    if(btn)\r\n                    {\r\n                        btn.setBind(component)\r\n                    }\r\n                    this.tagSpineNode.addChild(preTag);\r\n                    let arr = Global.Setting.SkinConfig.getHallGameListTagOffsetX()\r\n                    preTag.setPosition(cc.v2(arr[0],arr[1]))\r\n                    // preTag.scale = 0.95;\r\n                }\r\n            }, cc.Prefab, null, true)\r\n        }\r\n\r\n        let openFlag = this.gameData.top2\r\n        //开启体验场标签\r\n        this.tagImg.active = openFlag == 1;\r\n    }\r\n\r\n    //更新游戏状态  开启/敬请期待\r\n    private updateGameStatus() {\r\n        this.gameIconNode.active = true;\r\n        if (this.gameData.status == GameStatue.Open) {\r\n            this.pauseIcon(false)\r\n            this.grayImg.active = false;\r\n            this.checkGameUpdateState();\r\n            //在下载中，从子游戏切到大厅，gameicon 会重新加载，需要重置状态\r\n            let isUpdating = false;\r\n            let gameHotUpdateComp = Global.HotUpdateManager.getHotUpdateGameComp(this.gameData.game_id);\r\n            if (gameHotUpdateComp && !gameHotUpdateComp._updating) {\r\n                this.setNodeAlpha(255)\r\n            }\r\n        }\r\n        else if (this.gameData.status == GameStatue.Soon) {\r\n            this.setNodeAlpha(255 * 0.3)\r\n            //Global.UIHelper.setNodeGray(this.gameIconNode, true, 255 * 0.3, true);\r\n            this.pauseIcon(true)\r\n            this.grayImg.active = true;\r\n            this.weihuFlag.active = false;\r\n            this.waitFlag.active = true;\r\n        }\r\n        else if (this.gameData.status == GameStatue.Maintain) {\r\n            this.pauseIcon(true)\r\n            this.setNodeAlpha(255 * 0.3)\r\n            //Global.UIHelper.setNodeGray(this.gameIconNode, true, 255 * 0.3, true);\r\n            this.grayImg.active = true;\r\n            this.weihuFlag.active = true;\r\n            this.waitFlag.active = false;\r\n        }\r\n    }\r\n\r\n    setNodeAlpha(alpha)\r\n    {\r\n        Global.UIHelper.setNodeGray(this.gameIconNode, true, alpha, true);\r\n        let btn = this.node.getComponent(YXButton)\r\n        if(btn && cc.isValid(btn.node))\r\n        {\r\n            let bindObjArr = btn.bindedObject\r\n\r\n            if(bindObjArr)\r\n            {\r\n                for (let index = 0; index < bindObjArr.length; index++) {\r\n                    let item = bindObjArr[index];\r\n                    if(item && cc.isValid(item.node))\r\n                    {\r\n                        Global.UIHelper.setNodeGray(item.node, true, alpha, true);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private pauseIcon(value) {\r\n        if (this.spine)\r\n            this.spine.timeScale = value ? 0 : 1;\r\n        if (this.dragonBones)\r\n            this.dragonBones.timeScale = value ? 0 : 1;\r\n    }\r\n\r\n    private updateDownState() {\r\n        if(cc.sys.isBrowser) return;\r\n        this.updateState_download.active = this.gameUpdateState == GameDownloadStatus.NEVER_DOWNLOAD;\r\n        this.updateState_waiting.active = this.gameUpdateState == GameDownloadStatus.WAIT_DOWNLOAD;\r\n        this.updateState_update.active = this.gameUpdateState == GameDownloadStatus.OLD_VERSION;\r\n        this.updateState_stop.active = this.gameUpdateState == GameDownloadStatus.FAILD;\r\n        this.updateState_loading.active = this.gameUpdateState == GameDownloadStatus.DOWNLOADING;\r\n    }\r\n\r\n    checkGameUpdateState(gid = null) {\r\n        if(gid && gid != this.gameData.game_id)\r\n        {\r\n            return\r\n        }\r\n        let gameHotUpdateComp = Global.HotUpdateManager.getHotUpdateGameComp(this.gameData.game_id);\r\n        if (gameHotUpdateComp) {\r\n            if (!gameHotUpdateComp._updating) {\r\n                this.needWaitingView();\r\n            }else {\r\n                if (gameHotUpdateComp._download_percent){\r\n                    this.downloadingView(gameHotUpdateComp._download_percent)\r\n                }else {\r\n                    this.downloadingView(0)\r\n                }\r\n            }\r\n        } else {\r\n            let isGameDownloaded = this.checkDownloaded()\r\n            if(isGameDownloaded){\r\n                this.alreadyGameView();\r\n            }else{\r\n                this.needDownloadView();\r\n            }\r\n            // let nativeVersion = Global.HotUpdateManager.nativeVersions[this.gameData.game_id.toString()] || \"0.0.0\"\r\n            // // Logger.log(\"---------gameid nativeVersion ---\" + nativeVersion)\r\n            // let newVersion = this.gameData.version;\r\n            // let isGameDownloaded = this.checkDownloaded()\r\n            // if (newVersion != \"\" ) {\r\n            //     let versionCompareFlag = Global.Toolkit.versionCompare(newVersion, nativeVersion)\r\n            //     let isBackVersionFlag = this.gameData.isBackVersionFlag\r\n            //     if ((versionCompareFlag > 0) || ((versionCompareFlag < 0) && isBackVersionFlag  == 1)) {\r\n            //         if (((versionCompareFlag < 0) && isBackVersionFlag  == 1)){\r\n            //             Logger.log(\"回滚版本操作 gameID = \" + this.gameData.game_id)\r\n            //         }\r\n            //         if (isGameDownloaded) {\r\n            //             // Logger.log(\"enter needUpdateView\")\r\n            //             this.needUpdateView();\r\n            //         } else {\r\n            //             // Logger.log(\"enter needDownloadView\")\r\n            //             this.needDownloadView();\r\n            //         }\r\n            //     }else {\r\n            //         if (isGameDownloaded) {\r\n            //             // Logger.log(\"enter alreadyGameView 0\")\r\n            //             this.alreadyGameView();\r\n            //         }\r\n            //     }\r\n            // } else {\r\n            //     if (isGameDownloaded) {\r\n            //         // Logger.log(\"enter alreadyGameView 1\")\r\n            //         this.alreadyGameView();\r\n            //     }\r\n            // }\r\n        }\r\n    }\r\n    //  -1 没下载过 0 下载成功并且版本是最新  1下载过，版本不是最新 2下载中 3等待下载  4网络问题下载停止\r\n    needDownloadView() {\r\n        this.gameUpdateState = GameDownloadStatus.NEVER_DOWNLOAD\r\n        this.updateDownState();\r\n    }\r\n\r\n    needUpdateView() {\r\n        this.gameUpdateState = GameDownloadStatus.OLD_VERSION\r\n        this.updateDownState();\r\n    }\r\n\r\n    needWaitingView() {\r\n        this.gameUpdateState = GameDownloadStatus.WAIT_DOWNLOAD;\r\n        this.updateDownState();\r\n    }\r\n\r\n    needFaildView() {\r\n        this.gameUpdateState = GameDownloadStatus.FAILD;\r\n        this.updateDownState();\r\n    }\r\n\r\n   \r\n    downloadingView(per = 0) {\r\n\r\n        if (!this.node || !this.node.isValid) {\r\n            // Logger.log(\"downloadingView node === null\" + per)\r\n            return;\r\n        }\r\n\r\n        this.gameUpdateState = GameDownloadStatus.DOWNLOADING;\r\n        this.updateDownState();\r\n        let progress_label = this.updateState_loading.getChildByName(\"progressLabel\")\r\n        let perStr = \"\"\r\n        if (per) {\r\n            perStr = Math.floor(per * 100) + \"%\"\r\n        } else {\r\n            perStr = \"0%\";\r\n        }\r\n        progress_label.getComponent(cc.Label).string = perStr;\r\n        this.UpdateFillange(per)\r\n    }\r\n\r\n\r\n    UpdateFillange(per) {\r\n        if (!per) {\r\n            per = 0\r\n        }\r\n        let progress_Sprite = this.updateState_loading.getChildByName(\"RadialProgress\")\r\n        let rangeSprite = progress_Sprite.getComponent(cc.Sprite)\r\n        rangeSprite.fillRange = 1 - per\r\n        if (per > 0.99999) {\r\n            rangeSprite.fillRange = 0\r\n        }\r\n        if (!this.gameIconNode || !this.gameIconNode.isValid) {\r\n            Logger.error(\"UpdateFillange this.gameIconNode.isValid = false\")\r\n            return\r\n        }\r\n        let alpha = 255 * 0.3 + (255 * 0.7 * per)\r\n        this.setNodeAlpha(alpha)\r\n        //Global.UIHelper.setNodeGray(this.gameIconNode, true, alpha, true);\r\n\r\n    }\r\n\r\n    alreadyGameView(isHotBack: boolean = false) {\r\n        Logger.log('游戏已经下载')\r\n        this.gameUpdateState = GameDownloadStatus.NEW_VERSION_SUCCESS\r\n        this.updateDownState();\r\n        Global.HotUpdateManager.gIsGameDownloading[this.gameData.game_id] = false;\r\n        Global.HotUpdateManager.gameChecked[this.gameData.game_id] = false;\r\n\r\n    }\r\n\r\n    checkDownloaded() {\r\n        if (!cc.sys.isNative) {\r\n            return true;\r\n        }\r\n        else {\r\n            return Global.HotUpdateManager.checkIsGameDownload(this.gameData.game_id)\r\n        }\r\n    }\r\n\r\n    public getGameData() {\r\n        return this.gameData;\r\n    }\r\n\r\n\r\n    private checkMoney() {\r\n        if (this.gameData.checkMoney) {\r\n            if (this.gameData.levels && this.gameData.levels.length == 1) {\r\n                let pointLow = this.gameData.levels[0].PointLow;\r\n                if (Global.PlayerData.point < pointLow) {\r\n                    let limit = Global.Toolkit.formatPointStr(pointLow);\r\n                    let str = \"游戏准入\" + limit + \"金币，请您充值哦！\"\r\n                    //Global.UI.fastTip();\r\n                    Global.Toolkit.showMoneyNotEnough(str)\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private checkVersion() {\r\n        if (this.gameData.supportVersion && this.gameData.supportVersion > 0) {\r\n            if (!Global.Toolkit.checkVersionSupport(this.gameData.supportVersion, this.gameData.supportIosVersion)) {\r\n                Global.UI.showYesNoBox(\"版本过旧，请下载新包使用该功能\", () => {\r\n                    cc.sys.openURL(Global.Setting.Urls.downLoadUrl);\r\n                })\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private checkGameCfg() {\r\n        //进游戏前判断是否拉到游戏配置\r\n        if(Game.Control.GAME_DDZ_HJ_ARR[0] == this.gameData.game_id){\r\n            return true;\r\n        }\r\n        if (this.gameData && this.gameData.levels && this.gameData.levels.length > 0) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private enterGame() {\r\n        let self = this;\r\n        let enterFunc = async () => {\r\n            self.reSetGameDownloading();\r\n            if (Global.Setting.needHallChooseRoom && this.gameData.levels.length == 1 && this.gameData.gameType != GameType.PVP) //除了PVP只有一个选场直接进游戏\r\n            {\r\n                let level = this.gameData.levels[0].level || \"l0\"\r\n                if(!Global.Toolkit.checkMoney(level,this.gameData))\r\n                {\r\n                    return\r\n                }\r\n                Global.Event.event(GlobalEvent.RecordGameListOffsetX);\r\n                Game.Control.curLv = level\r\n                if (self.gameData.levelType == 1) {\r\n                    Game.Control.connnectAndEnterGame(self.gameData.game_id, \"l0\");\r\n                }\r\n                else {\r\n                    Global.SceneManager.loadGameScene();\r\n                }\r\n                return\r\n            }\r\n\r\n            let gid = this.gameData.game_id;\r\n            Game.GamePreloadTool.setup(gid);\r\n            if (Game.GamePreloadTool.checkPreloadBundleExist(gid)){        // 配置了走游戏选场\r\n                await Game.GamePreloadTool.preloadBundle();\r\n                await Game.GamePreloadTool.preloadPrefab(Game.GamePreloadTool.lobbyUIPath);\r\n                Global.UI.show(\"WndGameLobbyShell\", gid);\r\n                return;\r\n            }\r\n            Global.Event.event(GlobalEvent.RecordGameListOffsetX);\r\n            if (self.gameData.levelType == 1) {\r\n                Game.Control.connnectAndEnterGame(self.gameData.game_id, \"l0\");\r\n            }\r\n            else {\r\n                Global.SceneManager.loadGameScene();\r\n            }\r\n        }\r\n\r\n        //进游戏前判断是否拉到游戏配置\r\n        if (!this.checkGameCfg()) {\r\n            //弹框提示游戏没有配置\r\n            Global.UI.showSingleBox(\"游戏配置没有拉到，请稍等~\");\r\n            return;\r\n        }\r\n\r\n        if (!this.checkMoney())\r\n            return;\r\n\r\n        if (!this.checkVersion())\r\n            return;\r\n\r\n        //检查是否需要显示横竖屏切换提示\r\n        if (this.gameData.portraitModel) {\r\n            Global.UI.showPortraitScreenNotice(enterFunc);\r\n        }\r\n        else {\r\n            enterFunc();\r\n        }\r\n    }\r\n\r\n    private reSetGameDownloading() {\r\n        let HotUpdateManager = Global.HotUpdateManager\r\n        for (let key in HotUpdateManager.gIsGameDownloading) {\r\n            if (HotUpdateManager.gIsGameDownloading[key]) {\r\n                HotUpdateManager.gIsGameDownloading[key] = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    private itemClickWaiting: boolean = false;\r\n    public onItemClick() {\r\n        //防止连续多次点击游戏图标出发多次进入\r\n        if (this.itemClickWaiting) {\r\n            return;\r\n        }\r\n        \r\n        this.itemClickWaiting = true;\r\n        setTimeout(() => {\r\n            this.itemClickWaiting = false;\r\n        }, 1000);\r\n\r\n        this.isBtnClick = true;\r\n        if (Global.SceneManager.inGame())\r\n            return;\r\n\r\n        Global.HotUpdateManager.CurrentGame = this.gameData.game_id;\r\n        let nativeVersion = Global.HotUpdateManager.getNativeHotUpdateVersion(this.gameData.game_id)\r\n        //// 是否显示  0不 1显示 2待开放  3维护中\r\n        if (this.gameData.status == 2 || this.gameData.status == 3) {\r\n            cc.error(\"game status = \" + this.gameData.status)\r\n            Global.Audio.playAudioSource(\"hall/sound/coming_soon\")\r\n            return;\r\n        }\r\n        Global.Audio.playBtnSound();\r\n        //百盛游戏\r\n        if (this.gameData.gtype === 8){\r\n            if (this.checkVersion())\r\n            {\r\n                let hallModel:HallModel = Global.ModelManager.getModel(\"HallModel\")\r\n                hallModel.requestApplyEnterGame(this.gameData.game_id)\r\n            }\r\n            return;\r\n        }\r\n        //外接web游戏\r\n        if (this.gameData.gameType === 9){\r\n            let hallModel:HallModel = Global.ModelManager.getModel(\"HallModel\")\r\n            hallModel.requestApplyEnterGame(this.gameData.game_id)\r\n            return;\r\n        }\r\n        if (!cc.sys.isNative||this.gameData.isNew) {\r\n            Logger.log(\"已经更新过一次\"+this.gameData.isNew)\r\n            this.enterGame();\r\n            return;\r\n        }\r\n      \r\n        let versionUrl = `${this.gameData.getUpdateUrl()}/${this.gameData.version}/${this.gameData.game_id}/${Global.HotUpdateManager.versionCfgFileName}`;\r\n        Logger.log(\"这是当前的版本号获取url=\"+versionUrl)\r\n        Global.HotUpdateManager.getGameVersion(versionUrl).then(data=>{\r\n            let  nativeVersion = Global.HotUpdateManager.getNativeHotUpdateVersion(this.gameData.game_id)\r\n            Logger.log(\"远程版本=\"+data.version +\"本地当前版本=\"+nativeVersion)\r\n            this.gameData.native_version = nativeVersion;\r\n            this.gameData.remote_version = data.version;\r\n            if(Global.Toolkit.versionCompare(this.gameData.native_version,data.version) == -1){\r\n                this.needUpdateView();\r\n            }else{\r\n                this.gameData.isNew = true;\r\n                this.enterGame();\r\n                return\r\n            }\r\n            this.checkByGameUpdateState();\r\n        },()=>{\r\n            Global.UI.showSingleBox(\"配置拉取失败，请检查网络\");\r\n        })       \r\n      \r\n    }\r\n    checkByGameUpdateState(){\r\n  //// 1 new 2 下载中 3下载成功  4下载失败\r\n        //// -1 没下载过 0 下载成功并且版本是最新  1下载过，版本不是最新 2下载中 3等待下载 4 下载异常\r\n        switch (this.gameUpdateState) {\r\n            case GameDownloadStatus.OLD_VERSION:\r\n            case GameDownloadStatus.NEVER_DOWNLOAD:\r\n                let gid = Global.HotUpdateManager.getWhichGameIsDowning()\r\n                if (gid) {\r\n                    if (gid == this.gameData.game_id) {\r\n                        this.downloadingView(0)\r\n                    } else {\r\n                        this.needWaitingView();\r\n                        Global.UI.fastTip(this.gameData.name + \"已加入下载队列\")\r\n                        Global.HotUpdateManager.addHotUpdateGameComp(this.gameData.game_id, this.gameData.version, this.gameData.getUpdateUrl(), this.gameData.remote_version)\r\n\r\n                    }\r\n                } else {\r\n                    this.downloadingView(0)\r\n                    Global.HotUpdateManager.addHotUpdateGameComp(this.gameData.game_id, this.gameData.version, this.gameData.getUpdateUrl(), this.gameData.remote_version)\r\n                }\r\n                break;\r\n            case GameDownloadStatus.NEW_VERSION_SUCCESS:\r\n                this.enterGame();\r\n                break;\r\n            case GameDownloadStatus.DOWNLOADING:\r\n                Logger.log(\"正在下载中\")\r\n                break;\r\n            case GameDownloadStatus.WAIT_DOWNLOAD:\r\n                Global.HotUpdateManager.removeHotUpdateGameComp(this.gameData.game_id)\r\n                Global.UI.fastTip(cc.js.formatStr(\"%s已取消下载\",this.gameData.name))\r\n                this.gameUpdateState = GameDownloadStatus.NEVER_DOWNLOAD \r\n                this.checkGameUpdateState()\r\n                Logger.log(\"等待下载\")\r\n                break;\r\n            case GameDownloadStatus.FAILD:\r\n                Logger.log(\"下载失败\", this.gameData.game_id);\r\n                let f_gid = Global.HotUpdateManager.getWhichGameIsDowning()\r\n                if (f_gid) {\r\n                    if (f_gid == this.gameData.game_id) {\r\n                        this.downloadingView(0)\r\n                    } else {\r\n                        this.needWaitingView();\r\n                        Global.UI.fastTip(this.gameData.name + \"已加入下载队列\")\r\n                        Global.HotUpdateManager.addHotUpdateGameComp(this.gameData.game_id, this.gameData.version, this.gameData.getUpdateUrl(), this.gameData.isBackVersionFlag,nativeVersion)\r\n                    }\r\n                } else {\r\n                    this.downloadingView(0)\r\n                    Global.HotUpdateManager.addHotUpdateGameComp(this.gameData.game_id, this.gameData.version, this.gameData.getUpdateUrl(), this.gameData.isBackVersionFlag,nativeVersion)\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n  \r\n    public destroy() {\r\n        this.isBtnClick = false;\r\n        this.unRegisterEvent()\r\n    }\r\n\r\n    public releaseGameIcon() {\r\n        if (this.index >= Global.Setting.cachedGameItemCount) {\r\n            let iconPath = \"hall/effect/gameicon/\" + this.gameResData.prefabName;\r\n            if (this.gameResData.platformIconPath && this.gameResData.platformIconPath != \"\")\r\n                iconPath = this.gameResData.platformIconPath;\r\n            Global.ResourceManager.releaseCache(iconPath, null);\r\n        }\r\n    }\r\n    onDispose() {\r\n        let tag = this.tagSpineNode.getChildByName(\"newTag\")\r\n        if (tag) {\r\n            tag.removeFromParent()\r\n            tag.destroy()\r\n        }\r\n    }\r\n    protected onClose() {\r\n    }\r\n}"]}