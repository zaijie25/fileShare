{"version":3,"sources":["assets\\bbwz\\Bbwz\\scripts\\subview\\player\\BbwzPlayerBaseView.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,gDAA2C;AAC3C,+CAA0C;AAC1C,4DAAuD;AACvD,8DAAyD;AAEzD;IAAgD,sCAAY;IAA5D;QAAA,qEA6EC;QArEW,gBAAU,GAAG,KAAK,CAAC;;IAqE/B,CAAC;IAlEG,sBAAW,yCAAS;aAApB;YACI,OAAO,IAAI,CAAC,UAAU,CAAC;QAC3B,CAAC;;;OAAA;IAES,qCAAQ,GAAlB;QACI,IAAI,CAAC,SAAS,GAAc,IAAI,CAAC,YAAY,CAAC,kBAAkB,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC;QAC7E,IAAI,CAAC,SAAS,GAAc,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC;QACvE,IAAI,CAAC,QAAQ,GAAa,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC;QAChE,IAAI,CAAC,OAAO,GAAa,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC;QACnE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QAC9C,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,KAAK,CAAC;QAC/B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC;QAC7C,IAAI,CAAC,SAAS,GAAa,IAAI,CAAC,YAAY,CAAC,yBAAyB,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC;QAClF,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC,CAAC;QACzD,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;QAClC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC;QAC3D,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,KAAK,CAAC;IACvC,CAAC;IAEM,kCAAK,GAAZ,UAAa,IAAS;QAClB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACnB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACvB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QACxC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACnC,CAAC;IAEM,oCAAO,GAAd;QACI,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;QACxB,IAAI,CAAC,YAAY,EAAE,CAAC;IACxB,CAAC;IAEM,qCAAQ,GAAf,UAAgB,OAAe,EAAE,KAAa;QAC1C,IAAI,CAAC,SAAS,CAAC,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;QACpE,oBAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;QAC5D,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,KAAK,CAAC;IACjC,CAAC;IAEM,uCAAU,GAAjB,UAAkB,IAAY;QAC1B,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,IAAI,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;IAC3E,CAAC;IAEM,sCAAS,GAAhB,UAAiB,KAAa;QAC1B,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;QAC9B,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,cAAc,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QACzE,IAAI,QAAQ,GAAG,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,yBAAe,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,yBAAe,CAAC,aAAa,CAAC,IAAI,CAAC;QAEnG,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,IAAI,CAAC;YACjC,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,KAAK,CAAC;SACtC;aACI,IAAI,KAAK,GAAG,CAAC,EAAE;YAChB,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;YAClC,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,IAAI,CAAC;SACrC;QACD,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,MAAM,CAAC,eAAe,CAAC,YAAY,CAAC,yBAAe,CAAC,OAAO,EAAE,wBAAc,CAAC,eAAe,GAAG,qBAAqB,GAAG,QAAQ,EAAE,EAAE,CAAC,IAAI,CAAC,CAAC;QAC/J,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAC/C,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;IACrF,CAAC;IAEM,yCAAY,GAAnB;QACI,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;QAClC,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,KAAK,CAAC;QACnC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,KAAK,CAAC;QAC/B,IAAI,CAAC,UAAU,CAAC,cAAc,EAAE,CAAC;IACrC,CAAC;IACL,yBAAC;AAAD,CA7EA,AA6EC,CA7E+C,sBAAY,GA6E3D","file":"","sourceRoot":"/","sourcesContent":["import BbwzBaseView from \"../BbwzBaseView\";\r\nimport BbwzDriver from \"../../BbwzDriver\";\r\nimport BbwzPathHelper from \"../../tool/BbwzPathHelper\";\r\nimport BbwzConstDefine from \"../../data/BbwzConstDefine\";\r\n\r\nexport default class BbwzPlayerBaseView extends BbwzBaseView {\r\n    protected headImgSp: cc.Sprite;\r\n    protected headBoxSp: cc.Sprite;\r\n    protected vipLevel: cc.Label;\r\n    protected nameLbl: cc.Label;\r\n    protected piaoziNode: cc.Node;\r\n    protected piaoziRawPos: cc.Vec2;\r\n    protected resultLbl: cc.Label;\r\n    private _isSomeone = false;\r\n    private winEffectNode: cc.Node;\r\n    private loseEffectNode: cc.Node;\r\n    public get isSomeOne() {\r\n        return this._isSomeone;\r\n    }\r\n\r\n    protected initView() {\r\n        this.headImgSp = <cc.Sprite>this.getComponent(\"mask/sprite_head\", cc.Sprite);\r\n        this.headBoxSp = <cc.Sprite>this.getComponent(\"head_kuang\", cc.Sprite);\r\n        this.vipLevel = <cc.Label>this.getComponent(\"vipLbl\", cc.Label);\r\n        this.nameLbl = <cc.Label>this.getComponent(\"label_name\", cc.Label);\r\n        this.piaoziNode = this.getChild(\"piaoziNode\");\r\n        this.piaoziNode.active = false;\r\n        this.piaoziRawPos = this.piaoziNode.position;\r\n        this.resultLbl = <cc.Label>this.getComponent(\"piaoziNode/label_result\", cc.Label);\r\n        this.winEffectNode = this.getChild(\"spineNode/spineWin\");\r\n        this.winEffectNode.active = false;\r\n        this.loseEffectNode = this.getChild(\"spineNode/spineLose\");\r\n        this.loseEffectNode.active = false;\r\n    }\r\n\r\n    public onSit(data: any) {\r\n        this.active = true;\r\n        this._isSomeone = true;\r\n        this.loadHead(data.headimg, data.a_box);\r\n        this.setNameLbl(data.nickname);\r\n    }\r\n\r\n    public onLeave() {\r\n        this.active = false;\r\n        this._isSomeone = false;\r\n        this.clearByRound();\r\n    }\r\n\r\n    public loadHead(headimg: string, a_box: string) {\r\n        this.headImgSp.spriteFrame = Global.Toolkit.getLocalHeadSf(headimg);\r\n        BbwzDriver.instance.loadVipHeadKuang(this.headBoxSp, a_box);\r\n        this.vipLevel.string = a_box;\r\n    }\r\n\r\n    public setNameLbl(name: string) {\r\n        this.nameLbl.string = Global.Toolkit.substrEndWithElli(name, 12, true);\r\n    }\r\n\r\n    public setReward(point: number) {\r\n        this.piaoziNode.active = true;\r\n        this.resultLbl.string = Global.Toolkit.formatPointStr(point, true, true);\r\n        let fontName = point >= 0 ? BbwzConstDefine.rewardFontStr.Win : BbwzConstDefine.rewardFontStr.Lose;\r\n\r\n        if (point > 0) {\r\n            this.winEffectNode.active = true;\r\n            this.loseEffectNode.active = false;\r\n        }\r\n        else if (point < 0) {\r\n            this.winEffectNode.active = false;\r\n            this.loseEffectNode.active = true;\r\n        }\r\n        this.resultLbl.font = Global.ResourceManager.getBundleRes(BbwzConstDefine.GAME_ID, BbwzPathHelper.gameTexturePath + \"atlas/dynamic/font/\" + fontName, cc.Font);\r\n        this.piaoziNode.setPosition(this.piaoziRawPos);\r\n        this.piaoziNode.runAction(cc.moveBy(0.5, cc.v2(0, 30)).easing(cc.easeBackOut()));\r\n    }\r\n\r\n    public clearByRound() {\r\n        this.winEffectNode.active = false;\r\n        this.loseEffectNode.active = false;\r\n        this.piaoziNode.active = false;\r\n        this.piaoziNode.stopAllActions();\r\n    }\r\n}"]}