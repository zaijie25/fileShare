{"version":3,"sources":["assets\\ermj\\Ermj\\scripts\\subView\\mahjong\\ErmjMjPlayerView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ErmjBaseView from \"../ErmjBaseView\";\r\nimport ErmjOutMjViewManager from \"../../manager/ErmjOutMjViewManager\";\r\nimport ErmjMahjongOperView from \"./ErmjMahjongOperView\";\r\nimport ErmjPathHelper from \"../../data/ErmjPathHelper\";\r\nimport ErmjMjStyleHelper from \"../../tool/ErmjMjStyleHelper\";\r\nimport { ErmjPlayerDarkHandView, ErmjPlayerBrightHandView } from \"./ErmjPlayerHandView\";\r\nimport ErmjGameConst from \"../../data/ErmjGameConst\";\r\nimport ErmjDriver from \"../../ErmjDriver\";\r\n\r\n/** 抽象为全是暗牌 用作吃碰杠胡牌出牌表现展示的玩家对象 包括自己也虚拟了一个 */\r\nexport default class ErmjMjPlayerView extends ErmjBaseView{\r\n    private outMjMgr: ErmjOutMjViewManager;\r\n    private outShowStartWorldPos: cc.Vec3;\r\n    /** 出牌展示 父节点 也是排列起点 不同缩放分行 有层级的要求所以分节点 最多可能有三行*/\r\n    private outShowRoot0: cc.Node;\r\n    private outShowRoot1: cc.Node;\r\n    private outShowRoot2: cc.Node;\r\n    /** 打出去的麻将展示栏的数量 不包括补花的 */\r\n    private outShowCount: number = 0;\r\n    /** 下一次打出麻将子的本地坐标 */\r\n    private nextOutMjPos: cc.Vec3 = cc.Vec3.ZERO;\r\n    /** 补花父节点 layout排列*/\r\n    private flowerRoot: cc.Node;\r\n    private flowerCount: number;\r\n    private nextflowerMjPos: cc.Vec3 = cc.Vec3.ZERO;\r\n    /** 吃碰杠 操作牌墩数组*/\r\n    private operViewList: ErmjMahjongOperView[] = [];\r\n    /** 操作牌墩数组 当前索引指向 */\r\n    private operCurIndex: number = 0;\r\n    /** 吃碰杠牌墩父节点 也是排列起点*/\r\n    private operRoot: cc.Node;\r\n    private winShowView: WinMjItemsShowView;\r\n\r\n    public isBright: boolean = false;\r\n    private darkHandView: ErmjPlayerDarkHandView;\r\n    private brightHandView: ErmjPlayerBrightHandView;\r\n    private inBeTinged: boolean = false;\r\n\r\n    constructor(node: cc.Node, public nSeat: number){\r\n        super();\r\n        this.setNode(node);\r\n    }\r\n\r\n    protected initView(){\r\n        this.outMjMgr = ErmjDriver.instance.outMjManager;\r\n        this.darkHandView = new ErmjPlayerDarkHandView(this.getChild(\"darkView\"), this.nSeat);\r\n        this.darkHandView.active = false;\r\n        this.brightHandView = new ErmjPlayerBrightHandView(this.getChild(\"brightView\"), this.nSeat);\r\n        this.brightHandView.active = false;\r\n\r\n        this.outShowStartWorldPos = this.node.convertToWorldSpaceAR(this.getChild(\"outStartPoint\").position);\r\n        this.outShowRoot0 = this.getChild(\"outShowRoot0\");\r\n        this.outShowRoot1 = this.getChild(\"outShowRoot1\");\r\n        this.outShowRoot2 = this.getChild(\"outShowRoot2\");\r\n        this.flowerRoot = this.getChild(\"flowerRoot\");     \r\n        this.operRoot = this.getChild(\"operRoot\");\r\n        this.winShowView = new WinMjItemsShowView(this.getChild(\"winShowRoot\"), this.nSeat);\r\n        this.winShowView.active = false;\r\n    }\r\n\r\n    public setHandMjShow(flag: boolean){\r\n        this.darkHandView.active = true;\r\n    }\r\n\r\n    public setDarkHandMjOutScreen(){\r\n        this.darkHandView.setHandMjOutScreen();\r\n    }\r\n\r\n    /**\r\n     * 发牌\r\n     * @param count 一次摸几张\r\n     * @param valueArr 牌值数组 元素空代表暗牌\r\n     */\r\n    public dealHandMj(count: number = 1, valueArr: number[] = []){\r\n        this.darkHandView.dealHandMj(count, valueArr);\r\n    }\r\n\r\n    /**\r\n     * 摸牌 轮次摸牌 目前只支持摸一张\r\n     * @param value 牌值\r\n     */\r\n    public drawHandMj(value?: number){\r\n        if (!this.inBeTinged){\r\n            this.darkHandView.drawHandMj();\r\n        }\r\n        else{\r\n            this.brightHandView.drawHandMj(value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 玩家补花 补进来的都是暗牌表现\r\n     * @param outArr 花牌\r\n     * @param isRoundDeal 是否轮次摸牌、开杠摸牌\r\n     */\r\n    public changeFlower(outArr: number[], inArr: number[]){\r\n        if (!this.inBeTinged){\r\n            this.darkHandView.changeFlower(outArr, ()=>{\r\n                this.flowerCardAdd(outArr);     // 花牌区域add显示\r\n            });\r\n        }\r\n        else{\r\n            this.brightHandView.changeFlower(outArr, inArr, ()=>{\r\n                this.flowerCardAdd(outArr);     // 花牌区域add显示\r\n            });\r\n        }\r\n    }\r\n\r\n    /** 添加花牌到桌上 */\r\n    public flowerCardAdd(outArr: number[]){\r\n        let relative = this.nSeat - this.Context.selfLocalSeat; \r\n        for(let i = 0; i < outArr.length; i++){\r\n            let item = this.outMjMgr.getOneFlowerMj();\r\n            item.mahjongValue = outArr[i];\r\n            item.isFront = true;\r\n            item.node.setParent(this.flowerRoot);\r\n            let nPersp = this.Define.flowerMjPerspArr[this.flowerCount] || 0;\r\n            item.setPerspStyle(nPersp, relative);\r\n            \r\n            let {cfg, dir} = ErmjMjStyleHelper.getPerspectiveCfg(nPersp);\r\n            item.node.setSiblingIndex(10 - this.flowerCount);           \r\n            if (this.flowerCount == 0){\r\n                item.node.setPosition(cc.Vec3.ZERO);\r\n                let offsetX = dir > 0 ? cfg.devSpaceX : cfg.negDevSpaceX;\r\n                let spaceX = relative == 0 ? offsetX : -offsetX;\r\n                this.nextflowerMjPos = cc.v3(spaceX, 0);\r\n            }\r\n            else{\r\n                item.node.setPosition(this.nextflowerMjPos);\r\n                let offsetX = dir > 0 ? cfg.devSpaceX : cfg.negDevSpaceX;\r\n                let spaceX = relative == 0 ? offsetX : -offsetX;\r\n                this.nextflowerMjPos = cc.v3(this.nextflowerMjPos.x + spaceX, 0);\r\n            }\r\n            this.flowerCount++;\r\n            item.active = true;\r\n        }\r\n    }\r\n\r\n    public readyForOut(lastCard: number){\r\n        if (!this.inBeTinged){\r\n            this.darkHandView.readyForOut();\r\n        }\r\n        else{\r\n            this.brightHandView.readyForOut(lastCard);\r\n        }\r\n    }\r\n\r\n    public outCard(value: number){\r\n        if (!this.inBeTinged){\r\n            this.darkHandView.outCard(value, ()=>{\r\n                this.doOutFlyAnim(value);\r\n            })\r\n        }\r\n        else{\r\n            this.brightHandView.outCard(value, ()=>{\r\n                this.doOutFlyAnim(value);\r\n            })\r\n        }\r\n    }\r\n\r\n    /** 出牌飞麻将子 */\r\n    private doOutFlyAnim(value: number){\r\n        let relative = this.nSeat - this.Context.selfLocalSeat; \r\n\r\n        let flyItem = this.outMjMgr.getOneOutMj();\r\n        this.outShowCount += 1;\r\n        let [row, col] = [Math.ceil(this.outShowCount / this.Define.OutShowMjMaxCol) -1, (this.outShowCount - 1) % this.Define.OutShowMjMaxCol];\r\n        if (row == 0){\r\n            flyItem.node.setParent(this.outShowRoot0);\r\n        }\r\n        else if(row == 1){\r\n            flyItem.node.setParent(this.outShowRoot1);\r\n        }\r\n        else{\r\n            flyItem.node.setParent(this.outShowRoot2);\r\n        }\r\n        flyItem.mahjongValue = value;\r\n        flyItem.active = true;\r\n        flyItem.isFront = true;\r\n        let startPos = flyItem.node.parent.convertToNodeSpaceAR(this.outShowStartWorldPos);\r\n\r\n        let curPersp = this.Define.outMjPerspArr[col];\r\n        let curCfg = ErmjMjStyleHelper.getPerspectiveCfg(curPersp);\r\n        if (col == 0){\r\n            let endPos = cc.v3(0, 0);\r\n            \r\n            let offsetX = curCfg.dir > 0 ? curCfg.cfg.devSpaceX : curCfg.cfg.negDevSpaceX;\r\n            let spaceX = relative == 0 ? offsetX : -offsetX;\r\n            this.nextOutMjPos = cc.v3(spaceX, 0);\r\n            flyItem.doOutAnim(startPos, endPos, curPersp, relative);\r\n        }\r\n        else{\r\n            let endPos = this.nextOutMjPos;\r\n            let offsetX = curCfg.dir > 0 ? curCfg.cfg.devSpaceX : curCfg.cfg.negDevSpaceX;\r\n            let spaceX = relative == 0 ? offsetX : -offsetX;\r\n            this.nextOutMjPos = cc.v3(endPos.x + spaceX, 0);\r\n            flyItem.doOutAnim(startPos, endPos, curPersp, relative);\r\n        }\r\n        Game.Component.scheduleOnce(()=>{\r\n            flyItem.node.setSiblingIndex(this.Define.OutShowMjMaxCol - col);\r\n        }, this.Define.outMjShowTime + this.Define.outMjFlyTime + 0.1);\r\n    }\r\n\r\n    /** 直接显示桌上打出的麻将子 重连用 */\r\n    public showOutCardDirectly(cards: number[] = []){\r\n        let relative = this.nSeat - this.Context.selfLocalSeat; \r\n\r\n        cards.forEach(value => {\r\n            let flyItem = this.outMjMgr.getOneOutMj();\r\n            this.outShowCount += 1;\r\n            let [row, col] = [Math.ceil(this.outShowCount / this.Define.OutShowMjMaxCol) -1, (this.outShowCount - 1) % this.Define.OutShowMjMaxCol];\r\n            if (row == 0){\r\n                flyItem.node.setParent(this.outShowRoot0);\r\n            }\r\n            else if(row == 1){\r\n                flyItem.node.setParent(this.outShowRoot1);\r\n            }\r\n            else{\r\n                flyItem.node.setParent(this.outShowRoot2);\r\n            }\r\n            flyItem.mahjongValue = value;\r\n            flyItem.active = true;\r\n            flyItem.isFront = true;\r\n            let curPersp = this.Define.outMjPerspArr[col];\r\n            flyItem.node.setSiblingIndex(this.Define.OutShowMjMaxCol - col);\r\n            let curCfg = ErmjMjStyleHelper.getPerspectiveCfg(curPersp);\r\n            if (col == 0){\r\n                let endPos = cc.v3(0, 0);\r\n                let offsetX = curCfg.dir > 0 ? curCfg.cfg.devSpaceX : curCfg.cfg.negDevSpaceX;\r\n                let spaceX = relative == 0 ? offsetX : -offsetX;\r\n                this.nextOutMjPos = cc.v3(spaceX, 0);\r\n                flyItem.node.setPosition(endPos);\r\n                flyItem.setPerspStyle(curPersp, relative);\r\n            }\r\n            else{\r\n                let endPos = this.nextOutMjPos;\r\n                let offsetX = curCfg.dir > 0 ? curCfg.cfg.devSpaceX : curCfg.cfg.negDevSpaceX;\r\n                let spaceX = relative == 0 ? offsetX : -offsetX;\r\n                this.nextOutMjPos = cc.v3(endPos.x + spaceX, 0);\r\n                flyItem.node.setPosition(endPos);\r\n                flyItem.setPerspStyle(curPersp, relative);\r\n            }\r\n        });\r\n    }\r\n\r\n    /** 被吃碰杠时 减少桌面一个麻将子 */\r\n    public reduceOneOutMj(){\r\n        let relative = this.nSeat - this.Context.selfLocalSeat; \r\n        let [row, col] = [Math.ceil(this.outShowCount / this.Define.OutShowMjMaxCol) -1, (this.outShowCount - 1) % this.Define.OutShowMjMaxCol];\r\n        let curPersp = this.Define.outMjPerspArr[col];\r\n        let curCfg = ErmjMjStyleHelper.getPerspectiveCfg(curPersp);\r\n        let offsetX = curCfg.dir > 0 ? curCfg.cfg.devSpaceX : curCfg.cfg.negDevSpaceX;\r\n        let spaceX = relative == 0 ? offsetX : -offsetX;\r\n        this.nextOutMjPos = cc.v3(this.nextOutMjPos.x - spaceX, 0);\r\n        this.outShowCount -= 1;\r\n    }\r\n    \r\n    /** 碰 */\r\n    public pongCard(valueArr: number[]){\r\n        if (!this.inBeTinged){\r\n            this.darkHandView.pongCard(valueArr);\r\n        }\r\n        else{\r\n            this.brightHandView.pongCard(valueArr);\r\n        }\r\n\r\n        let operView = this.getOneOperView();\r\n        operView.active = true;\r\n        let perspArr = this.Define.operMjGroupPerspArr.slice((this.operCurIndex - 1) * 3, this.operCurIndex * 3);\r\n        operView.setPongStyle(valueArr, perspArr);\r\n    }\r\n\r\n    /** 吃 */\r\n    public chowCard(valueArr: number[], chowCard: number){\r\n        if (!this.inBeTinged){\r\n            this.darkHandView.chowCard(valueArr, chowCard);\r\n        }\r\n        else{\r\n            this.brightHandView.chowCard(valueArr, chowCard);\r\n        }\r\n\r\n        let operView = this.getOneOperView();\r\n        operView.active = true;\r\n        let perspArr = this.Define.operMjGroupPerspArr.slice((this.operCurIndex - 1) * 3, this.operCurIndex * 3);\r\n        operView.setChowStyle(valueArr, chowCard, perspArr);\r\n    }\r\n\r\n    /** 杠 */\r\n    public kongCard(type: number, valueArr: number[]){\r\n        if (!this.inBeTinged){\r\n            this.darkHandView.kongCard(type, valueArr);\r\n        }\r\n        else{\r\n            this.brightHandView.kongCard(type, valueArr);\r\n        }\r\n\r\n        if (type == 5){\r\n            let [operView, index] = this.findPongKongOper(valueArr[0]);      // 碰杠 找到现存碰 加一张\r\n            if (operView){\r\n                let perspArr = this.Define.operMjGroupPerspArr.slice((index - 1) * 3, index * 3);\r\n                operView.setKongStyle(valueArr, true, false, perspArr);\r\n            }\r\n        }\r\n        else{\r\n            let operView = this.getOneOperView();\r\n            operView.active = true;\r\n            let perspArr = this.Define.operMjGroupPerspArr.slice((this.operCurIndex - 1) * 3, this.operCurIndex * 3);\r\n            operView.setKongStyle(valueArr, type !== 6, this.nSeat == this.Context.selfLocalSeat || this.inBeTinged, perspArr);\r\n        }\r\n    }\r\n\r\n    /** 获取未使用的吃碰杠麻将墩 */\r\n    private getOneOperView(){\r\n        if(!this.operViewList[this.operCurIndex]){\r\n            let relative = this.nSeat - this.Context.selfLocalSeat; \r\n            let prefab = Global.ResourceManager.getBundleRes(ErmjGameConst.Gid, ErmjPathHelper.gamePrefabsPath + \"panel/mahjong/mahjongOperView\", cc.Prefab);\r\n            let node = <cc.Node>cc.instantiate(prefab);\r\n            node.setParent(this.operRoot);\r\n            node.setPosition(this.Define.OperViewSpace[this.nSeat].mul(this.operCurIndex));\r\n            let view = new ErmjMahjongOperView(node, relative);\r\n            view.active = false;\r\n            this.operViewList[this.operCurIndex] = view;\r\n        }\r\n        let item = this.operViewList[this.operCurIndex];\r\n        this.operCurIndex += 1;\r\n        return item;\r\n    }\r\n\r\n    /** 找到现存碰、杠 */\r\n    private findPongKongOper(value: number): [ErmjMahjongOperView, number]{\r\n        for(let i=0; i < this.operViewList.length; i++){\r\n            let view = this.operViewList[i];\r\n            if (view.value == value && (view.checkPongValid() || view.checkKongValid()))  // 不会出现同一种牌的杠和碰 暗杠不会被抢杠\r\n                return [view, i + 1];\r\n        }\r\n    }\r\n\r\n    /** 被抢杠胡 */\r\n    public robbedKongLose(value: number){\r\n        let [view] = this.findPongKongOper(value);\r\n        if (view)\r\n            view.beKongRobbed();\r\n    }\r\n\r\n    /** 把暗杠变成可见的3+1 结算和听牌时*/\r\n    public showDarkKongSeen(darkList: any[] = []){\r\n        let count = 0;\r\n        for(let i = 0; i < this.operViewList.length; i++){\r\n            if (count == darkList.length)\r\n                break;\r\n            let view = this.operViewList[i];\r\n            if (view.checkDarkKongValid()){  // 找到暗杠\r\n                let perspArr = this.Define.operMjGroupPerspArr.slice(i * 3, (i + 1) * 3);\r\n                view.setKongStyle(darkList[count], false, true, perspArr);\r\n                count ++;\r\n            }\r\n        }\r\n    }\r\n\r\n    /** 重连复盘吃碰杠牌 */\r\n    public syncAllOperView(list: any[] = []){\r\n        list.forEach(data=>{\r\n            let operView = this.getOneOperView();\r\n            operView.active = true;\r\n            let perspArr = this.Define.operMjGroupPerspArr.slice((this.operCurIndex - 1) * 3, this.operCurIndex * 3);\r\n            let type = data.type;\r\n            let valueArr = data.all_cards || [];\r\n            let card = data.card;\r\n            if (type == 2){\r\n                operView.setChowStyle(valueArr, card, perspArr);\r\n            }\r\n            else if(type == 3){\r\n                operView.setPongStyle(valueArr, perspArr);\r\n            }\r\n            else{\r\n                operView.setKongStyle(valueArr, type !== 6, this.nSeat == this.Context.selfLocalSeat, perspArr);\r\n            }\r\n        })\r\n    }\r\n\r\n    public addWinMjShow(value: number){\r\n        this.winShowView.active = true;\r\n        this.winShowView.addOneHuMjItem(value);\r\n    }\r\n\r\n    /** 自摸时隐藏上手那张胡牌 */\r\n    public winHideLastDraw(value: number){\r\n        if(!this.inBeTinged){\r\n            this.darkHandView.winHideLastDraw();\r\n        }\r\n        else{\r\n            this.brightHandView.winHideLastDraw(value);\r\n        }\r\n    }\r\n\r\n    public setBeInTing(){\r\n        this.inBeTinged = true;\r\n    }\r\n\r\n    public showDownHand(flag: boolean, valueArr: number[], isWin: boolean, isSort: boolean){\r\n        this.darkHandView.active = false;\r\n        this.brightHandView.active = flag;\r\n        this.brightHandView.showDown(valueArr, isWin, isSort);\r\n    }\r\n\r\n    /** 回收所有吃碰杠麻将墩 */\r\n    private recycleAllOperView(){\r\n        this.operViewList.forEach((view)=>{\r\n            view.active = false;\r\n        })\r\n        this.operCurIndex = 0;      // 重置计数作为回收, 数量有限个不另作池管理\r\n    }\r\n\r\n    public getLightningWorldPos(){\r\n        return this.winShowView.getWinItemWorldPos();\r\n    }\r\n\r\n    public reset(){\r\n        this.darkHandView.reset();\r\n        this.darkHandView.active = false;\r\n        this.brightHandView.reset();\r\n        this.brightHandView.active = false;\r\n\r\n        this.flowerCount = 0;\r\n        this.recycleAllOperView();\r\n        this.outShowCount = 0;\r\n        this.winShowView.active = false;\r\n        this.inBeTinged = false;\r\n    }\r\n\r\n    public clearByRound(){\r\n        this.reset();\r\n    }\r\n}\r\n\r\nclass WinMjItemsShowView extends ErmjBaseView{\r\n    private outMjMgr: ErmjOutMjViewManager;\r\n    private bgSp: cc.Sprite;\r\n    private mjRoot: cc.Node;\r\n    private winCount: number = 0;\r\n    private nextWinMjPos: cc.Vec3 = cc.Vec3.ZERO;\r\n    private readonly maxCol = 5;\r\n    private readonly bgWidthLimit = 28;\r\n    private readonly bgWidthStep = 40;\r\n    private mjParentList: cc.Node[] = [];\r\n\r\n    constructor(node: cc.Node, private nRelative: number){\r\n        super();\r\n        this.setNode(node);\r\n    }\r\n\r\n    protected initView(){\r\n        this.outMjMgr = ErmjDriver.instance.outMjManager;\r\n        this.bgSp = this.getComponent(\"bgSp\", cc.Sprite);\r\n        this.mjRoot = this.getChild(\"mjRoot\");\r\n    }\r\n\r\n    // 获取一个父节点, 用于层次\r\n    private getMjRoot(){\r\n        let row = Math.ceil(this.winCount / this.maxCol) - 1;\r\n        if (!this.mjParentList[row]){\r\n            let node = cc.instantiate(this.mjRoot);\r\n            node.setParent(this.node);\r\n            node.scale = this.mjRoot.scale;\r\n            node.position = this.mjRoot.position;\r\n            this.mjParentList[row] = node;\r\n        }\r\n        return this.mjParentList[row];\r\n    }\r\n\r\n    public addOneHuMjItem(value: number){\r\n        this.winCount ++;\r\n        let [row, col] = [Math.ceil(this.winCount / this.maxCol) - 1, (this.winCount - 1) % this.maxCol];\r\n        let mjItem = this.outMjMgr.getOneWinMj();\r\n        mjItem.mahjongValue = value;\r\n        mjItem.active = true;\r\n        mjItem.isFront = true;\r\n        let root = this.getMjRoot();\r\n        mjItem.node.setParent(root);\r\n        let nPersp = this.Define.winMjPerspArr[col] || 0;\r\n        mjItem.setPerspStyle(nPersp, this.nRelative);\r\n        \r\n        let {cfg, dir} = ErmjMjStyleHelper.getPerspectiveCfg(nPersp);\r\n        mjItem.node.setSiblingIndex(0);       // 上面的层级更高 row和col都是0开始\r\n        if (col == 0){\r\n            mjItem.node.setPosition(cc.v3(0, row * this.Define.winMoreOffsetY));\r\n            let offsetX = dir > 0 ? cfg.devSpaceX : cfg.negDevSpaceX;\r\n            let spaceX = this.nRelative == 0 ? offsetX : -offsetX;\r\n            this.nextWinMjPos = cc.v3(spaceX, row * this.Define.winMoreOffsetY);\r\n        }\r\n        else{\r\n            mjItem.node.setPosition(this.nextWinMjPos);\r\n            let offsetX = dir > 0 ? cfg.devSpaceX : cfg.negDevSpaceX;\r\n            let spaceX = this.nRelative == 0 ? offsetX : -offsetX;\r\n            this.nextWinMjPos = cc.v3(this.nextWinMjPos.x + spaceX, row * this.Define.winMoreOffsetY);\r\n        }\r\n        this.updateBgWidth();\r\n    }\r\n\r\n    public updateBgWidth(){\r\n        if(this.winCount >= this.maxCol){\r\n            this.bgSp.node.width = this.bgWidthLimit + this.maxCol * this.bgWidthStep;\r\n        }\r\n        else{\r\n            let col = this.winCount % this.maxCol;\r\n            this.bgSp.node.width = this.bgWidthLimit + col * this.bgWidthStep;\r\n        }\r\n    }\r\n\r\n    public getWinItemWorldPos(){\r\n        let mjItem = this.outMjMgr.getLastWinMj();\r\n        if (mjItem && mjItem.active)\r\n            return mjItem.node.parent.convertToWorldSpaceAR(mjItem.node.position);\r\n        else{\r\n            return this.node.convertToWorldSpaceAR(cc.Vec3.ZERO);\r\n        }\r\n    }\r\n    \r\n    protected onClose(){\r\n        this.winCount = 0;\r\n    }\r\n}"]}