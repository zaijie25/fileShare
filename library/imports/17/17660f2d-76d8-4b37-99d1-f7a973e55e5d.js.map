{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\recharge\\CashListView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ViewBase from \"../../../core/ui/ViewBase\";\r\nimport ExtractModel from \"../../../hallcommon/model/ExtractModel\";\r\nimport { ExtractEvent } from \"../money/ui/extractCash/ExtractEvent\";\r\nimport PoolBase from \"../../../core/tool/PoolBase\";\r\n\r\nexport default class CashListView extends ViewBase {\r\n    private model : ExtractModel;\r\n    private copyItem: any;\r\n    private contentNode: cc.Node;\r\n    private pageLabel: cc.Label;\r\n    private nextBtn: cc.Node;\r\n    private lastBtn: cc.Node;\r\n    //没有数据\r\n    private nothingNode:cc.Node;\r\n    private itemPool: RecordingItemPool;\r\n    private nodeList: any[] = [];\r\n    private limit = 6\r\n    private arrList: Array<any>\r\n    private isRecharge: boolean\r\n    protected initView()\r\n    {\r\n        // cc.log(\"打开界面\");\r\n        this.model = <ExtractModel>Global.ModelManager.getModel(\"ExtractModel\");\r\n        this.model.on(ExtractEvent.OnUpdateApplyCashList,this,this.InitCashListView);\r\n        Global.UIHelper.addCommonClick(this.node, \"nexPage\", this.OnNextPagePageBtnClick, this);\r\n        Global.UIHelper.addCommonClick(this.node, \"upPage\", this.OnLastPageBtnClick, this);\r\n        this.contentNode = this.getChild(\"scrollview/view/content\");\r\n        this.copyItem = this.getChild(\"scrollview/view/content/Item\");\r\n        this.pageLabel = this.getChild(\"pageLabel\").getComponent(cc.Label);\r\n        //暂无任何信息\r\n        this.nothingNode = this.getChild(\"Nothing\");\r\n        this.nothingNode.active = false;\r\n        this.nextBtn = this.getChild(\"nexPage\");\r\n        this.lastBtn = this.getChild(\"upPage\");\r\n        this.copyItem.active = false;\r\n        this.initItemPool()\r\n        \r\n    }\r\n    onOpenRecharge(isRecharge: boolean = false){\r\n        this.isRecharge = isRecharge;\r\n        this.model.reqApplyCashList();\r\n    }\r\n \r\n    protected onDispose()\r\n    {\r\n        this.itemPool.resetPool()\r\n        this.model.off(ExtractEvent.OnUpdateApplyCashList,this,this.InitCashListView);\r\n    }\r\n    //下一页\r\n    OnNextPagePageBtnClick() {\r\n        Global.Audio.playBtnSound();\r\n        if(this.arrList.length > this.model.cashListPage * this.limit)\r\n        {\r\n            this.model.cashListPage++;\r\n            this.InitCashListView();\r\n        }else{\r\n            this.model.reqApplyCashList(true);\r\n        }\r\n    }\r\n    // 上一页\r\n    OnLastPageBtnClick() {\r\n        Global.Audio.playBtnSound();\r\n        this.model.cashListPage--;\r\n        if(this.model.cashListPage<=0)\r\n        {\r\n            this.model.cashListPage = 1;\r\n            Global.UI.fastTip(\"已经是第一页了\")\r\n            return\r\n        }\r\n        this.InitCashListView();\r\n    }\r\n    private initItemPool(){\r\n       \r\n        this.itemPool = new RecordingItemPool(this.copyItem);\r\n    }\r\n\r\n\r\n    public recycle()\r\n    {\r\n        this.itemPool.recycleAll(this.nodeList);\r\n        this.nodeList = [];\r\n    }\r\n    InitCashListView() {\r\n        this.arrList =  this.model.getCashListData() || [];\r\n        let count = this.arrList.length;\r\n        if(count < 1){\r\n            this.nothingNode.active = true;\r\n            this.pageLabel.node.active = false;\r\n            this.nextBtn.active = false;\r\n            this.lastBtn.active = false;\r\n        }else{\r\n            this.nothingNode.active = false;\r\n            this.pageLabel.node.active = true;\r\n            this.nextBtn.active = true;\r\n            this.lastBtn.active = true;\r\n        }\r\n        if (count ==0)  return;\r\n        let listCount = count - (this.model.cashListPage-1)*this.limit > this.limit?this.limit:count - (this.model.cashListPage-1)*this.limit\r\n        this.recycle();\r\n        for (let j=0; j< listCount; j++){\r\n            let node = this.itemPool.getItem();\r\n            this.nodeList.push(node);\r\n            node.active = true;\r\n            node.setParent(this.contentNode);\r\n            node.getComponent(\"RecordingItem\").Init(this.arrList[(this.model.cashListPage-1)*this.limit+j],j,this.isRecharge)\r\n        }\r\n        let msgFormat = \"共%s条\"\r\n        let str = \"第%s页\"\r\n        this.pageLabel.string = cc.js.formatStr(msgFormat,this.model.cashTotal) + cc.js.formatStr(str,this.model.cashListPage);\r\n    }\r\n\r\n}\r\nclass RecordingItemPool extends PoolBase{\r\n    constructor(private copyNode: cc.Node){\r\n        super();\r\n    }\r\n\r\n    protected createItem(){\r\n        return cc.instantiate(this.copyNode);\r\n    }\r\n\r\n    protected resetItem(node: cc.Node){\r\n        node.active = false;\r\n        node.setParent(null)\r\n    }\r\n    public recycleAll(arr: Array<any>)\r\n    {\r\n        super.recycleAll(arr)\r\n        arr.forEach(ele => {\r\n            this.resetItem(ele);\r\n        });\r\n\r\n    }\r\n    \r\n}"]}