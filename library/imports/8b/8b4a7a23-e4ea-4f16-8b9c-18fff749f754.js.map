{"version":3,"sources":["assets\\ermj\\Ermj\\scripts\\handlers\\ErmjEasyHandler.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ErmjBaseHandler from \"./ErmjBaseHandler\";\r\nimport ErmjDriver from \"../ErmjDriver\";\r\n\r\nexport class ErmjReadyHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        this.context.isWaitMatch = false;\r\n        this.mainUI.matchPlayerView.active = false;\r\n        // let time = msg._timeo *1000 - (Date.now() - msg._receiveTime);\r\n        // // if (time <= 0)\r\n        // //     time = 1000;\r\n        // if (time >= 1000)\r\n        //     this.mainUI.showActionTimer(true, 0, time, null);\r\n    }\r\n\r\n    protected executeSync(msg){\r\n        this.execute(msg);\r\n    }\r\n}\r\n\r\nexport class ErmjStartHandler extends ErmjBaseHandler{\r\n    protected refreshData(msg){\r\n        this.context.set(this.Define.FieldGameStart, true);\r\n    }\r\n\r\n    protected execute(msg){\r\n        // 游戏开始时 显示设定方位盒\r\n        this.mainUI.askNoticeView.active = true;\r\n        this.mainUI.askNoticeView.setChairLook(this.context.selfSrc);\r\n\r\n        this.context.isWaitMatch = false;       // 游戏开始取消匹配状态\r\n        this.mainUI.matchPlayerView.active = false;\r\n        this.mainUI.callAllPlayers(\"setMatched\", true);\r\n        this.mainUI.gameStartView.active = true;\r\n        Game.Event.event(Game.EVENT_ADDTIMELOCK, \"ErmjStartHandler\", 1);\r\n    }\r\n\r\n    protected executeSync(msg){\r\n        // 游戏开始时 显示设定方位盒\r\n        this.mainUI.askNoticeView.active = true;\r\n        this.mainUI.askNoticeView.setChairLook(this.context.selfSrc);\r\n        this.mainUI.callAllPlayers(\"setMatched\", false);\r\n    }\r\n}\r\n\r\nexport class ErmjEndHandler extends ErmjBaseHandler{\r\n    protected refreshData(msg){\r\n        //清理单局数据\r\n        this.context.clearByRound();\r\n    }\r\n\r\n    protected execute(msg){\r\n        Game.Tween.clear();\r\n        Game.Component.unscheduleAllCallbacks();  \r\n    }\r\n}\r\n\r\n//等待下一局\r\nexport class ErmjWaitHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        if (msg._para.status == 1){\r\n            Logger.log(\"结算中\");\r\n        }\r\n        else{\r\n            this.mainUI.matchPlayerView.active = true;\r\n        }\r\n    }\r\n}\r\n\r\n//刷新玩家信息\r\nexport class ErmjRefreshHandler extends ErmjBaseHandler{\r\n    // \"_param\":{\r\n    //     \"_cmd\":\"refresh\",\r\n    //     \"_src\":\"p5\",\r\n    //     \"_para\":{\r\n    //         \"app_id\":12,\r\n    //         \"user_id\":680272,\r\n    //         \"nick_name\":\"贵宾680272\",\r\n    //         \"headimg\":\"5\",\r\n    //         \"point\":475,\r\n    //         \"user_type\":1,\r\n    //         \"register_ip\":\"192.168.1.224\",\r\n    //         \"os_type\":1,\r\n    //         \"itime\":1556027819,\r\n    //         \"last_login_time\":\"2019-04-30 23:55:55\"\r\n    //     }\r\n    // }\r\n    protected refreshData(msg){\r\n        let src = msg._src\r\n        let localSeat = this.SitHelper.serverSToLocalN(src);\r\n        if(this.context.playerList[localSeat] == null)\r\n            return;\r\n        this.context.playerList[localSeat].refresh(msg._para);\r\n        if (localSeat == this.context.selfLocalSeat){\r\n            Global.PlayerData.point = this.context.playerList[localSeat].point;\r\n        }\r\n    }\r\n\r\n    protected execute(msg){\r\n        let src = msg._src\r\n        let localSeat = this.SitHelper.serverSToLocalN(src);\r\n        if(this.context.playerList[localSeat] == null)\r\n            return;\r\n        this.mainUI.callPlayer(localSeat, \"setPlayerPoint\", this.context.playerList[localSeat].point);\r\n    }\r\n}\r\n\r\n\r\nexport class ErmjOfflineHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        let src = msg._src\r\n        let localSeat = this.SitHelper.serverSToLocalN(src);\r\n        Logger.log(localSeat, '------->offline');\r\n        // 重连需要补发状态，暂不处理离线\r\n    }\r\n}\r\n\r\n\r\nexport class ErmjLeaveMatchHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        this.mainUI.matchPlayerView.active = false;\r\n        if (this.context.isWaitMatch){\r\n            this.context.isWaitMatch = false;\r\n            Global.UI.showYesNoBox('匹配超时，是否重新匹配？', ()=>{\r\n                Game.Control.trySendEnter({\"_from\":\"jump\"});    // 断socket则不能用这个\r\n            }, ()=>{\r\n                Game.Server.send(this.Define.CmdLeave, { \"IsClose\": 1 });\r\n                ErmjDriver.instance.leaveGame();\r\n            });\r\n        }\r\n    }\r\n}"]}