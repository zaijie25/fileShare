{"version":3,"sources":["assets\\bbwz\\Bbwz\\scripts\\handler\\BbwzChatHandler.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,iEAA4D;AAC5D,4CAAuC;AACvC,6CAAwC;AACxC,2DAAmD;AAEnD;IAA6C,mCAAqB;IAAlE;;IA4CA,CAAC;IA3CG,oCAAU,GAAV,UAAW,GAAG;QACV,IAAI,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC;QAC5B,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QACrD,IAAI,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC;QAChC,IAAI,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC;QAC5B,IAAI,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;QACjD,IAAI,UAAU,GAAQ,oBAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QACpE,IAAI,QAAQ,GAAQ,oBAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QAChE,IAAI,CAAC,UAAU,IAAI,CAAC,CAAC,UAAU,CAAC,SAAS,IAAI,OAAO,KAAK,KAAK,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAI,YAAY;YAC/G,OAAO;QACX,IAAI,KAAK,IAAI,CAAC,EAAE;YACZ,QAAQ;SACX;aACI,IAAI,KAAK,IAAI,CAAC,EAAE;YACjB,KAAK;YACL,IAAI,KAAK,GAAG,UAAU,CAAC,iBAAiB,EAAE,CAAC;YAC3C,IAAI,KAAK,GAAG,QAAQ,CAAC,iBAAiB,EAAE,CAAC;YACzC,oBAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;SAC1F;IACL,CAAC;IAEO,qCAAW,GAAnB,UAAoB,MAAc;QAC9B,8CAA8C;QAC9C,IAAI,MAAM,GAAa,CAAC,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAA;QAChE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACpC,IAAI,MAAM,KAAK,MAAM,CAAC,CAAC,CAAC,EAAE;gBACtB,IAAI,kBAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,kBAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,kBAAQ,CAAC,QAAQ,CAAC,OAAO,EAAE;oBAChI,OAAO,0BAAQ,CAAC,IAAI,CAAC;iBACxB;aACJ;SACJ;QACD,IAAI,MAAM,IAAI,kBAAQ,CAAC,QAAQ,CAAC,OAAO,EAAE;YACrC,OAAO,0BAAQ,CAAC,IAAI,CAAC;SACxB;aACI,IAAI,MAAM,IAAI,0BAAQ,CAAC,KAAK,IAAI,MAAM,IAAI,0BAAQ,CAAC,OAAO;YAC3D,OAAO,MAAM,CAAC;;YAEd,OAAO,0BAAQ,CAAC,MAAM,CAAC;IAC/B,CAAC;IAEM,sCAAY,GAAnB,UAAoB,QAAQ;QACxB,OAAO,KAAK,CAAC;IACjB,CAAC;IACL,sBAAC;AAAD,CA5CA,AA4CC,CA5C4C,+BAAqB,GA4CjE","file":"","sourceRoot":"/","sourcesContent":["import BbwzSocketBaseHandler from \"./BbwzSocketBaseHandler\";\r\nimport BbwzDriver from \"../BbwzDriver\";\r\nimport BbwzData from \"../data/BbwzData\";\r\nimport { BbwzRole } from \"../data/BbwzConstDefine\";\r\n\r\nexport default class BbwzChatHandler extends BbwzSocketBaseHandler {\r\n    handleData(msg) {\r\n        let cType = msg._para.ctype;\r\n        let fromSit = this.convertSeat(msg._para.from_chair);\r\n        let content = msg._para.content;\r\n        let emoji = msg._para.emoji;\r\n        let toSit = this.convertSeat(msg._para.to_chair);\r\n        let fromPlayer: any = BbwzDriver.instance.gameUI.getPlayer(fromSit);\r\n        let toPlayer: any = BbwzDriver.instance.gameUI.getPlayer(toSit);\r\n        if (!fromPlayer || (!fromPlayer.isSomeOne && fromSit !== 10000) || !toPlayer || !toPlayer.isSomeOne)   // 没人不播放 未处理\r\n            return;\r\n        if (cType == 0) {\r\n            // 文字 暂无\r\n        }\r\n        else if (cType == 1) {\r\n            // 表情\r\n            let fWPos = fromPlayer.getCenterWorldPos();\r\n            let tWPos = toPlayer.getCenterWorldPos();\r\n            BbwzDriver.instance.gameUI.headTipsManager.playAct(String(emoji), fWPos, tWPos, toSit);\r\n        }\r\n    }\r\n\r\n    private convertSeat(sChair: number) {\r\n        //多人机器人是10000,大富豪10001 智多星 9999,其他 10002~10005\r\n        let posAre: number[] = [9999, 10001, 10002, 10003, 10004, 10005]\r\n        for (let i = 0; i < posAre.length; i++) {\r\n            if (sChair === posAre[i]) {\r\n                if (BbwzData.instance.playerDataArr[posAre[i]] && BbwzData.instance.playerDataArr[posAre[i]]._rchair === BbwzData.instance.selfSrc) {\r\n                    return BbwzRole.Self;\r\n                }\r\n            }\r\n        }\r\n        if (sChair == BbwzData.instance.selfSrc) {\r\n            return BbwzRole.Self;\r\n        }\r\n        else if (sChair >= BbwzRole.Wiser && sChair <= BbwzRole.Richer5)\r\n            return sChair;\r\n        else\r\n            return BbwzRole.Online;\r\n    }\r\n\r\n    public checkInQueue(msgParam) {\r\n        return false;\r\n    }\r\n}"]}