{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\CommissionSys\\WndCommision.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import PoolBase from \"../../../core/tool/PoolBase\";\r\nimport WndBase from \"../../../core/ui/WndBase\";\r\nimport CommisionItem from \"./CommisionItem\";\r\nimport CommisionLeftItem from \"./CommisionLeftItem\";\r\nimport CommisionModel from \"../../../hallcommon/model/CommisionModel\";\r\nimport { HallRedSpotType } from \"../../../hallcommon/model/HallModel\";\r\nimport WaitingView from \"../waiting/WaitingView\";\r\n\r\nclass WndCommision extends WndBase{\r\n    \r\n    leftItemPool: CommissionItemPool;\r\n    rightListView:any;\r\n    private rightScrollView:cc.ScrollView;\r\n\r\n    leftItemNodeList = []\r\n    RightItemNodeList = []\r\n\r\n    private leftCopyItem :cc.Node\r\n    private rightCopyItem :cc.Node\r\n\r\n    private model:CommisionModel\r\n\r\n    private lfetContentNode:cc.Node\r\n    private taskType:number = -1;\r\n\r\n    private clickedId = -1\r\n\r\n    private waitingNode :cc.Node;\r\n    protected onOpen(){\r\n        if(this.waitingNode)\r\n        {\r\n            this.waitingNode.active = true;\r\n        }\r\n        this.model.reqGetCommisionAllList()\r\n    }\r\n\r\n    protected initView(){\r\n       this.leftCopyItem = this.getChild(\"leftPanel/missionItem\")\r\n       if(this.leftCopyItem)\r\n       {\r\n           this.leftCopyItem.active = false\r\n       }\r\n\r\n       this.rightCopyItem = this.getChild(\"rightPanel/item\")\r\n       if(this.rightCopyItem)\r\n       {\r\n           this.rightCopyItem.active = false\r\n       }\r\n       this.lfetContentNode = this.getChild(\"leftPanel/scrollview/view/content\")\r\n       this.rightScrollView = this.getComponent(\"rightPanel/scrollview\",cc.ScrollView)\r\n       this.addCommonClick(\"close\",this.close,this)\r\n       this.initItemPool()\r\n       this.initRightListView();\r\n       this.model.on(CommisionModel.UpdateleftView,this,this.RefershLeftPanel)\r\n       this.model.on(CommisionModel.UpdateScrollview,this,this.RefershRightPanel)\r\n       this.model.on(CommisionModel.GetCommisionAward, this,this.onGetAward);\r\n       if(this.waitingNode == null|| this.waitingNode == undefined){\r\n        //view 内的loading\r\n            this.waitingNode = WaitingView.initWaitingView(this.node,cc.v2(0,0));\r\n        }\r\n    }\r\n    onGetAward(data) {\r\n        let flag = this.model.checkIsAnyCommisionCanGet(this.clickedId)\r\n        let node = this.lfetContentNode.getChildByName(this.clickedId.toString())\r\n        if(!flag)\r\n        {\r\n            node.getComponent(CommisionLeftItem).SetUnReadActiveState(false)\r\n            // this.refreshPanel()\r\n        }\r\n        this.ChangeStatus(data)\r\n        this.rightListView.updateView();\r\n        \r\n    }\r\n\r\n\r\n    private initItemPool()\r\n    {\r\n        this.leftItemPool = new CommissionItemPool(this.leftCopyItem);\r\n        \r\n    }\r\n\r\n    protected onInit(){\r\n        this.isNeedDelay = true\r\n        this.name = \"WndCommision\";\r\n        this.layer = \"PopLayer\";\r\n        this.resPath = \"hall/prefabs/ui/Commision/CommisionUI\";\r\n        this.model = <CommisionModel>Global.ModelManager.getModel(\"CommisionModel\");\r\n    }\r\n\r\n    protected initRightListView(){\r\n        let item_setter = (item, index) =>\r\n        {\r\n            let data = this.rightListView.allDatas[index];\r\n            item.getComponent(\"CommisionItem\").UpdateUI(data,this.taskType)\r\n        };\r\n        let [itemPadding,itemOffset] = Global.Setting.SkinConfig.commisionCfg;\r\n        this.rightListView = Global.UIHelper.addScrollViewCarmackComp(this.rightScrollView.node, this.rightCopyItem, itemPadding, itemOffset, this, item_setter);\r\n    }\r\n   \r\n    protected onClose() {\r\n        this.recycleItems()\r\n        let flag = this.model.checkShowHallRedSpot()\r\n        if(flag)\r\n        {\r\n            Global.Event.event(GlobalEvent.ShowRedSpot, [true,HallRedSpotType.Commision]);\r\n        }\r\n        else\r\n        {\r\n            Global.Event.event(GlobalEvent.CloseRedSpot, HallRedSpotType.Commision);\r\n        }\r\n        this.model.resetData()\r\n    }\r\n\r\n\r\n    protected onDispose()\r\n    {\r\n        this.leftItemPool.resetPool()\r\n        this.leftItemNodeList = [];\r\n        this.RightItemNodeList = []\r\n        this.model.off(CommisionModel.UpdateleftView,this,this.RefershLeftPanel)\r\n        this.model.off(CommisionModel.UpdateScrollview,this,this.RefershRightPanel)\r\n        this.model.off(CommisionModel.GetCommisionAward, this,this.onGetAward);\r\n    }\r\n\r\n    RefershRightPanel(data) {\r\n        if(this.waitingNode)\r\n        {\r\n            this.waitingNode.active = false;\r\n        }\r\n        let arr: Array<any> = data.data || [];\r\n        this.taskType = data.global_task_type ? data.global_task_type : -1; \r\n        arr.sort(this.sortData)\r\n        this.rightListView.allDatas = arr;\r\n        this.rightListView.updateView();\r\n    }\r\n\r\n    sortData(a,b)\r\n    {\r\n        if(a.task_status !== 1 && b.task_status !== 1)\r\n        {\r\n            return a - b\r\n        }\r\n        else if(a.task_status === 1 && b.task_status !== 1)\r\n        {\r\n            return - 1\r\n        }\r\n        else if(a.task_status === 1 && b.task_status === 1)\r\n        {\r\n            return a - b \r\n        }\r\n        else\r\n        {\r\n            return 1\r\n        }\r\n        \r\n    }\r\n\r\n    ChangeStatus(data)\r\n    {\r\n        let arr = this.rightListView.allDatas\r\n        if(!arr || arr.length == 0) return\r\n\r\n        for (let index = 0; index < arr.length; index++) {\r\n            let element = arr[index];\r\n            if(element.task_id == data.id && data.global_task_type == this.clickedId)\r\n            {\r\n                element.task_status = 2\r\n            }\r\n            \r\n        }\r\n        arr.sort(this.sortData)\r\n\r\n        \r\n    }\r\n\r\n    SortItem()\r\n    {\r\n\r\n    }\r\n\r\n    UpdataListData(data)\r\n    {\r\n        if(data == null) return\r\n        this.rightListView.allDatas = data\r\n        this.rightListView.UpDateScrollData()\r\n    }\r\n\r\n    RefershLeftPanel(data) {\r\n        if(this.waitingNode)\r\n        {\r\n            this.waitingNode.active = false;\r\n        }\r\n        Global.Event.event(GlobalEvent.HIDE_NET_WAITING,\"WndCommision\")\r\n        if (!data || data.length == 0) {\r\n            Global.UI.fastTip(\"该功能暂未开放，敬请期待哦！\");\r\n            return\r\n        }\r\n        this.OnDataPrepared()\r\n        \r\n        for (let index = 0; index < data.length; index++) {\r\n            // if(data[index].global_task_type == 7){ //屏蔽掉游戏活跃\r\n            //     continue;\r\n            // }\r\n            let leftItem = this.leftItemPool.getItem()\r\n            leftItem.setParent(this.lfetContentNode)\r\n            this.leftItemNodeList.push(leftItem);\r\n            let CommisionItem = leftItem.getComponent(\"CommisionLeftItem\")\r\n            CommisionItem.data = data[index]\r\n            if (index === 0) {\r\n                this.clickedId = data[index].global_task_type\r\n                CommisionItem.SetToggleChecked(true)\r\n                this.model.reqGetCommisionInfo(data[index].global_task_type)\r\n            }\r\n            leftItem.active = true;\r\n            leftItem.name =  data[index].global_task_type.toString()\r\n            leftItem.on(cc.Node.EventType.TOUCH_END, this.leftItemClick, this)\r\n            CommisionItem.onInit(data[index])\r\n        }\r\n    }\r\n    leftItemClick(target) {\r\n        \r\n        let CommisionItem = target.target.getComponent(\"CommisionLeftItem\")\r\n        if(CommisionItem && CommisionItem.data)\r\n        {\r\n            if(this.clickedId == CommisionItem.data.global_task_type)\r\n            {\r\n                return\r\n            }\r\n            this.clickedId = CommisionItem.data.global_task_type\r\n            let data = this.model.GetCommisionInfoByType(CommisionItem.data.global_task_type)\r\n            if(data)\r\n            {\r\n                this.RefershRightPanel(data)\r\n                return\r\n            }\r\n            if(this.waitingNode)\r\n            {\r\n                this.waitingNode.active = true;\r\n            }\r\n            this.model.reqGetCommisionInfo(CommisionItem.data.global_task_type)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param type 1左边 2 右边 0 全部\r\n     */\r\n    public recycleItems()\r\n    {\r\n        this.leftItemPool.recycleAll(this.leftItemNodeList);\r\n        this.leftItemNodeList = [];\r\n        \r\n    }\r\n    \r\n    \r\n}\r\n\r\nexport default WndCommision\r\n\r\nclass CommissionItemPool extends PoolBase{\r\n    constructor(private copyNode: cc.Node){\r\n        super();\r\n    }\r\n    protected createItem(){\r\n        return cc.instantiate(this.copyNode);\r\n    }\r\n\r\n    protected resetItem(node: cc.Node){\r\n        node.active = false;\r\n        node.setParent(null)\r\n    }\r\n    public recycleAll(arr: Array<any>)\r\n    {\r\n        super.recycleAll(arr)\r\n        arr.forEach(ele => {\r\n            this.resetItem(ele);\r\n        });\r\n\r\n    }\r\n}"]}