{"version":3,"sources":["assets\\hall\\scripts\\logic\\core\\loadingMVC\\WndGameMaintainUI.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WndBase, { DestoryType } from \"../ui/WndBase\";\r\n\r\n\r\nexport default class WndGameMaintainUI extends WndBase {\r\n    private onlineCustomBtnNode: cc.Node;\r\n    private officialWebBtnNode: cc.Node;\r\n    private content: cc.Label;\r\n    private countTimeLabel: cc.Label;\r\n    private onlineCustomCallback: Function;\r\n    private officialWebCallback: Function;\r\n    private closeCallback: Function;\r\n    private autoClose = true;\r\n    private autoReleaseFunc = true;\r\n    private endTime = 0;\r\n\r\n\r\n    protected onInit() {\r\n        this.name = \"WndGameMaintainUI\";\r\n        this.layer = \"PopLayer\";\r\n        this.resPath = \"hall/prefabs/ui/LoadingScene/GameMaintainUI\";\r\n        this.destoryType = DestoryType.None;\r\n    }\r\n\r\n    protected initView() {\r\n        this.addCommonClick(\"bg/close\", this.onCloseClick, this);\r\n        this.onlineCustomBtnNode = this.addCommonClick(\"onlineCustomBtn\", this.onlineCustomBtnClick, this);\r\n        this.officialWebBtnNode = this.addCommonClick(\"officialWebBtn\", this.officialWebBtnClick, this);\r\n        this.content = this.getComponent(\"content\", cc.Label);\r\n        this.countTimeLabel = this.getComponent(\"timeLabel\", cc.Label)\r\n        this.content.string = \"\";\r\n        this.countTimeLabel.string = \"\"; // <color=#f08f48><size=24><b><u>剩余维护时间 00:30:00</u></b></size></color>\r\n    }\r\n\r\n\r\n    /**\r\n     * @param {string} content\r\n     * @param {number} type   1 显示 确定取消  2  显示 确定\r\n     * @param {Function} yesCallback\r\n     * @param {Function} noCallback\r\n     * @param {boolean} autoClose  点击按钮后是否自动关闭界面\r\n     * @memberof WndGameMaintainUI\r\n     */\r\n    protected onOpen() {\r\n        if (this.args == null || this.args.length == 0) {\r\n            Logger.error(\"没有设置参数\");\r\n            this.close();\r\n            return;\r\n        }\r\n        let content = this.args[0];\r\n        if (content == null || content == \"\") {\r\n            Logger.error(\"没有设置参数\");\r\n            this.close();\r\n            return;\r\n        }\r\n\r\n        let endTime = this.args[1];\r\n        this.endTime = endTime;\r\n        let startTime = Math.round(new Date().getTime() / 1000); //开始时间\r\n        let t = this.endTime - startTime; //时间差\r\n        this.showLeftTime(t)\r\n        this.countTimeLabel.schedule(this.startCounter.bind(this), 1, cc.macro.REPEAT_FOREVER)\r\n\r\n        this.content.string = content;\r\n        this.onlineCustomCallback = this.args[2];\r\n        this.officialWebCallback = this.args[3];\r\n        this.closeCallback = this.args[4];\r\n        this.autoClose = this.args[5] != false;\r\n        this.autoReleaseFunc = this.args[6] != false;\r\n\r\n        Global.Event.event(GlobalEvent.FORCE_HIDE_WAITING);\r\n    }\r\n\r\n    /**\r\n * \r\n * @desc   格式化现在距${endTime}的剩余时间\r\n * @param  {Date} endTime  \r\n * @return {String}\r\n */\r\n    private formatRemainTime(leftTime) {\r\n        let t = leftTime\r\n        let d = 0,\r\n            h = 0,\r\n            m = 0,\r\n            s = 0;\r\n        if (t >= 0) {\r\n            h = Math.floor(t  / 60 / 60 % 24);\r\n            m = Math.floor(t  / 60 % 60);\r\n            s = Math.floor(t  % 60);\r\n        }\r\n        let h_str = \"\";\r\n        let m_str = \"\";\r\n        let s_str = \"\";\r\n        if (h < 10){\r\n            h_str = \"0\" + h\r\n        }else {\r\n            h_str = h_str + h;\r\n        }\r\n        if (m < 10){\r\n            m_str = \"0\" + m\r\n        }else {\r\n            m_str = m_str + m;\r\n        }\r\n        \r\n        if (s < 10){\r\n            s_str = \"0\" + s\r\n        }else {\r\n            s_str = s_str + s;\r\n        }\r\n        \r\n        return h_str + \":\" + m_str + \":\" + s_str;\r\n    }\r\n\r\n    private showLeftTime(leftTime) {\r\n        let leftTimeStr = this.formatRemainTime(leftTime)\r\n        this.countTimeLabel.string =  \"剩余维护时间\"+ leftTimeStr \r\n    }\r\n\r\n    private stopCounter() {\r\n        this.countTimeLabel.unscheduleAllCallbacks()\r\n    }\r\n\r\n    private startCounter() {\r\n        let startTime = Math.round(new Date().getTime() / 1000); //开始时间\r\n        let t = this.endTime - startTime; //时间差\r\n        this.showLeftTime(t)\r\n        if (t <= 0){\r\n            this.stopCounter();\r\n            this.onCloseClick()\r\n        }\r\n    }\r\n\r\n\r\n    private officialWebBtnClick() {\r\n        if (this.officialWebCallback) {\r\n            this.officialWebCallback();\r\n        }\r\n\r\n    }\r\n\r\n    private onCloseClick() {\r\n        this.close();\r\n    }\r\n\r\n    protected onClose() {\r\n\r\n    }\r\n\r\n    protected onCloseAnimFinish() {\r\n        if (this.closeCallback) {\r\n            this.closeCallback();\r\n            this.closeCallback = null\r\n        }\r\n    }\r\n\r\n    private onlineCustomBtnClick() {\r\n        if (this.onlineCustomCallback) {\r\n            this.onlineCustomCallback();\r\n        }\r\n    }\r\n\r\n\r\n}"]}