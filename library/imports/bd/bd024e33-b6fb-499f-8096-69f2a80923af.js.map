{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\rebate\\WndHallRedEnvelope.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport WndBase, { DestoryType } from \"../../../core/ui/WndBase\";\r\nimport { NetAppface } from \"../../../core/net/hall/NetEvent\";\r\nimport HallModel from \"../../../hallcommon/model/HallModel\";\r\nimport HallPopMsgHelper from \"../../tool/HallPopMsgHelper\";\r\nimport { ActivityType } from \"../Activity/ActivityConstants\";\r\nexport default class WndHallRedEnvelope extends WndBase{\r\n    private openSke: sp.Skeleton;\r\n    private noOpenSp: cc.Node;\r\n    private data;\r\n    private model: HallModel;\r\n    private closeCallback: Function;\r\n    // private goldSke: sp.Skeleton;\r\n    protected onInit() {\r\n        this.name = \"WndHallRedEnvelope\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/Rebate/HallRedEnvelopeUI\";\r\n        this.destoryType = DestoryType.None\r\n    }\r\n\r\n    protected initView(){\r\n        this.model = <HallModel>Global.ModelManager.getModel(\"HallModel\");\r\n        this.addCommonClick(\"openBtn\", this.onSureBtnClick, this);\r\n        this.openSke = <sp.Skeleton>this.getComponent(\"openBtn\", sp.Skeleton);\r\n        this.noOpenSp = this.getChild(\"noopen\");\r\n        // this.goldSke = <sp.Skeleton>this.getComponent(\"skeleton\", sp.Skeleton);\r\n    }\r\n\r\n    private onSureBtnClick(){\r\n        this.openSke.clearTrack(0)\r\n        this.openSke.setAnimation(0, \"idle_NO\", false)\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.DoRechargeRed, {},(retObj) => {\r\n            Global.UI.show(\"WndRebateGet\", retObj.point,null,() => {\r\n                Global.UI.show(\"WndGetRedEnvelope\")\r\n            })\r\n            this.model.recharge_red = null\r\n            this.closeWnd()\r\n        },(error) => {\r\n            Global.UI.fastTip(error._errstr);\r\n            // console.log(error);\r\n        },false);\r\n    }\r\n\r\n    protected onOpen(arr){\r\n        if(this.openSke){\r\n            this.openSke.clearTrack(0)\r\n            this.openSke.setAnimation(0,\"idle_Loop\",true);\r\n        }\r\n        // if(this.goldSke){\r\n        //     this.goldSke.clearTrack(0)\r\n        //     this.goldSke.setAnimation(0,\"animation\",false);\r\n        // }\r\n        this.data = this.model.recharge_red;\r\n        let time = (new Date()).getTime()/1000;\r\n        if(!this.data) {\r\n            this.openSke.node.active = false;\r\n            this.noOpenSp.active = true;\r\n            return;\r\n        }\r\n        if( time > this.data.stime && time < this.data.etime){\r\n            this.openSke.node.active = true;\r\n            this.noOpenSp.active = false\r\n        }else{\r\n            this.openSke.node.active = false;\r\n            this.noOpenSp.active = true;\r\n        }\r\n\r\n    }\r\n\r\n    private closeWnd(){\r\n        if(this.closeCallback){\r\n            this.closeCallback();\r\n        }\r\n        this.close();\r\n    }\r\n\r\n    protected onClose(){\r\n        HallPopMsgHelper.Instance.releaseLock(ActivityType.rechargeGive);\r\n\r\n    }\r\n    onDispose()\r\n    {\r\n    }\r\n}"]}