{"version":3,"sources":["assets\\hall\\scripts\\logic\\hallcommon\\data\\PlayerData.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import HallStorageKey from \"../const/HallStorageKey\";\r\nimport GlobalEvent from \"../../core/GlobalEvent\";\r\nimport { NetAppface } from \"../../core/net/hall/NetEvent\";\r\nimport Toolkit from \"../../core/tool/Toolkit\";\r\n\r\nexport default class PlayerData\r\n{\r\n    public uid:number;\r\n    /**\r\n     * vip等级\r\n     */\r\n    private _vip : number;\r\n    public set vip(newVip:number){\r\n        if(this._vip == newVip) return;\r\n        this._vip = newVip; \r\n        //通知玩家信息发生更新\r\n        Global.Event.event(GlobalEvent.PERSONALINFOUPDATE);\r\n        Global.Event.event(GlobalEvent.CHANGEVIP);\r\n        this.changeVip()\r\n    }\r\n\r\n    changeVip() {\r\n        //请求修改头像框\r\n        let model = Global.ModelManager.getModel(\"PlayerInfoModel\")\r\n        let param: any = {}\r\n        param.head = Global.PlayerData.vip\r\n        model.reqSetSelfCfg(param, () => {\r\n            Global.PlayerData.headkuang = Global.PlayerData.vip.toString();\r\n        });\r\n    }\r\n    public get vip(){\r\n        return this._vip?this._vip:0;\r\n    }\r\n    /**\r\n     * 充值金额\r\n     */\r\n    public vipExp:number;\r\n    public token:string;\r\n    public pack:number;  //渠道id\r\n    public pid:any;  //上级id\r\n    public open_id:string;  \r\n    public accesstoken:string; \r\n    public payChannel:string;\r\n    public urlSign:string;\r\n    public ip:string;\r\n\r\n    /**\r\n     * 玩家标识\r\n     */\r\n    public merge_type:string = \"\";\r\n    /**\r\n     * 捕鱼炮台\r\n     */\r\n    public buyuPaotai:string;\r\n\r\n    private _type : number;\r\n    //玩家类型 1 游客 2 绑定手机\r\n    public set type( newType:number ){\r\n        if(this._type == newType) return;\r\n        this._type = newType; \r\n        //通知玩家信息发生更新\r\n        Global.Event.event(GlobalEvent.PERSONALINFOUPDATE);\r\n    }\r\n    public get type(){\r\n        return this._type;\r\n    }\r\n\r\n    //玩家手机\r\n    private _phone : string;\r\n    public set phone( newPhone:string ){\r\n        if(this._phone == newPhone) return;\r\n        this._phone = newPhone; \r\n        //通知玩家信息发生更新\r\n        Global.Event.event(GlobalEvent.PERSONALINFOUPDATE);\r\n    }\r\n    public get phone(){\r\n        return this._phone;\r\n    }\r\n\r\n    //玩家昵称\r\n    private _nickname : string;\r\n    public set nickname( newNickname:string ){\r\n        if(this._nickname == newNickname) return;\r\n        this._nickname = newNickname; \r\n        //通知玩家信息发生更新\r\n        Global.Event.event(GlobalEvent.PERSONALINFOUPDATE);\r\n    }\r\n    public get nickname(){\r\n        return this._nickname;\r\n    }\r\n\r\n    //玩家头像\r\n    private _headimg : string;\r\n    public set headimg( newHeadimg:string ){\r\n        if(this.headimg == newHeadimg) return;\r\n        this._headimg = newHeadimg; \r\n        //通知玩家信息发生更新\r\n        Global.Event.event(GlobalEvent.PERSONALINFOUPDATE);\r\n    }\r\n    public get headimg(){\r\n        return this._headimg;\r\n    }\r\n    \r\n    //玩家头像框\r\n    private _headkuang : string = \"0\";\r\n    public set headkuang( newHeadkuang:string ){\r\n        if(newHeadkuang == \"\"){\r\n            newHeadkuang = \"0\";\r\n        }\r\n        if(this.headkuang == newHeadkuang) return;\r\n        this._headkuang = newHeadkuang; \r\n        //通知玩家信息发生更新\r\n        Global.Event.event(GlobalEvent.PERSONALINFOUPDATE);\r\n    }\r\n    public get headkuang(){\r\n        return this._headkuang;\r\n    }\r\n\r\n    //金币数量\r\n    private _point : number;\r\n    public set point( newPoint:number ){\r\n        if(this._point == newPoint) return;\r\n        this._point = newPoint; \r\n        //玩家金币发生变化\r\n        Global.Event.event(GlobalEvent.PERSONALINFOUPDATE);\r\n    }\r\n    public get point(){\r\n        return this._point;\r\n    }\r\n\r\n    //银行存款数量\r\n    private _bank_point : number;\r\n    public set bank_point( newPoint:number ){\r\n        if(this._bank_point == newPoint) return;\r\n        this._bank_point = newPoint; \r\n        //玩家金币发生变化\r\n        Global.Event.event(GlobalEvent.PERSONALINFOUPDATE);\r\n    }\r\n    public get bank_point(){\r\n        return this._bank_point;\r\n    }\r\n\r\n    public clear()\r\n    {\r\n        this.uid = 0;\r\n        this._vip = 0;\r\n        this.vipExp = 0;\r\n        this.headkuang = \"0\";\r\n        this.buyuPaotai = \"0\";\r\n        this.token = \"\";\r\n        this.nickname = \"\";\r\n        this.headimg = \"\";\r\n        this.point = 0;\r\n        this.type = 0;\r\n        this.phone = \"\";\r\n        this.pack = 0;\r\n        this.pid = null;\r\n        this.open_id = \"\";\r\n        this.accesstoken = \"\";\r\n    }\r\n\r\n    /**\r\n        Uid         uint64                 `json:\"uid\"`\r\n        Token       string                 `json:\"token\"`\r\n        Nickname    string                 `json:\"nickname\"`\r\n        Headimg     string                 `json:\"headimg\"`\r\n        Point       int64                  `json:\"point\"`     //金币\r\n        UserType    int32                  `json:\"user_type\"` //-----\r\n        Phone       string                 `json:\"phone\"`     //------\r\n        PackNo      int32                  `json:\"pack_no\"`\r\n        Pid         uint64                 `json:\"pid\"`\r\n        SAddr       []string               `json:\"s_addr\"` //----\r\n        OpenId      string                 `json:\"open_id\"`\r\n        Accesstoken string                 `json:\"accesstoken\"`\r\n     */\r\n    public init(msg:any)\r\n    {\r\n        this.clear();\r\n        //玩家系统数据\r\n        this.uid = msg.uid;\r\n        this.token = msg.token;\r\n        this.pack = msg.pack_no? msg.pack_no : 0;\r\n        this.pid = msg.pid? msg.pid : 0;\r\n        this.open_id = msg.open_id;\r\n        this.accesstoken = msg.accesstoken;\r\n        this.ip = msg.list_ip || \"\"\r\n        if(msg && msg.merge_type !== \"\")\r\n        {\r\n            this.merge_type = msg.merge_type.toString() \r\n        }\r\n        \r\n        Global.Setting.ChannelInfo.playerChannel = this.pack;\r\n        if (Global.Toolkit.checkNumValid(this.pid) == false){\r\n            this.pid = 0;\r\n        }\r\n        Global.Setting.ChannelInfo.playerInviteCode = this.pid;\r\n        if(this.pack != null && this.pack != 0)\r\n        {\r\n            Global.Setting.storage.set(HallStorageKey.Channel, this.pack);\r\n        }\r\n        if(this.pid && this.pid != 0)\r\n        {\r\n            Global.Setting.storage.set(HallStorageKey.InviteCode, this.pid.toString());\r\n        }\r\n        Global.Setting.storage.set(HallStorageKey.Token, this.token);\r\n        Global.Setting.storage.set(HallStorageKey.Uid, this.uid.toString());\r\n\r\n        //玩家游戏数据\r\n        this.update(msg);\r\n        //监听后续玩家数据更新\r\n        Global.HallServer.on(NetAppface.GetUserInfo, this, this.update);\r\n        //请求最新金币\r\n        Global.HallServer.on(NetAppface.GetUserPoint,this,this.updateMoney);\r\n\r\n        this.urlSign = Global.UrlUtil.getPlatformSign(this.uid + this.token + Global.Setting.SystemInfo.deviceId,Global.Setting.signKey)\r\n        \r\n    }\r\n\r\n    private updateMoney( msg : any ){\r\n        this.point = msg.point;\r\n        this.bank_point = msg.bank_point;\r\n    }\r\n\r\n    public update(msg: any) \r\n    {\r\n        this.uid = msg.uid;\r\n        if(msg.self_cfg){\r\n            this.vip = msg.vip_level;\r\n            this.vipExp = msg.vip_coin;\r\n            this.headkuang = \"\" + msg.self_cfg[\"head\"];\r\n            this.buyuPaotai = \"\" + msg.self_cfg[\"pao\"];\r\n        }\r\n        let storage_vip = Global.Setting.storage.get(HallStorageKey.VIPLevel)\r\n        if (!storage_vip && this._vip){\r\n            Global.Setting.storage.set(HallStorageKey.VIPLevel, Number(this._vip));\r\n        }else if (storage_vip && storage_vip < this.vip){\r\n            Global.Setting.storage.set(HallStorageKey.VIPLevel, Number(this._vip));\r\n        }\r\n        if(msg && msg.merge_type !== \"\")\r\n        {\r\n            this.merge_type = msg.merge_type.toString() \r\n        }\r\n\r\n        this.nickname = Global.Toolkit.substrEndWithElli(msg.nickname,14,true);\r\n        this.headimg = msg.headimg;\r\n        this.point = msg.point ? msg.point : 0;\r\n        this.bank_point = msg.bank_point ? msg.bank_point : 0;\r\n        this.type = msg.user_type;\r\n        if(!msg.phone)\r\n        {\r\n            this.phone = \"\"\r\n            return\r\n        }\r\n        if(msg.phone.indexOf(\" \") == -1)\r\n        {\r\n            this.phone = Global.AESUtil.decodeMsg(msg.phone)\r\n            this.phone = this.functionSw(this.phone);\r\n        }\r\n        else\r\n        {\r\n            this.phone = msg.phone;\r\n        }\r\n        \r\n    }\r\n    functionSw(str){ //去掉首尾两端的空格(^\\s*)|(\\s*$)\r\n        　　  return str.replace(/(^\\s*)|(\\s*$)/g, \"\");\r\n    }\r\n}"]}