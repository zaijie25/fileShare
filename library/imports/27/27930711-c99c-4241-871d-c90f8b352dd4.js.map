{"version":3,"sources":["assets\\bbwz\\Bbwz\\scripts\\BbwzDriver.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BbwzNetHandler from \"./handler/BbwzNetHandler\";\r\nimport BbwzConstDefine from \"./data/BbwzConstDefine\";\r\nimport BbwzGamePanel from \"./panel/BbwzGamePanel\";\r\nimport BbwzNoticePop from \"./panel/BbwzNoticePop\";\r\nimport BbwzSettingPop from \"./panel/BbwzSettingPop\";\r\nimport BbwzOnlinePlayerPop from \"./panel/BbwzOnlinePlayerPop\";\r\nimport BbwzHistoryPop from \"./panel/BbwzHistoryPop\";\r\nimport BbwzRulePop from \"./panel/BbwzRulePop\";\r\nimport BbwzData from \"./data/BbwzData\";\r\nimport BbwzPathHelper from \"./tool/BbwzPathHelper\";\r\nimport BbwzChipsManager from \"./manager/BbwzChipsManager\";\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n/**\r\n * 场景总驱动组件\r\n */\r\n@ccclass\r\nexport default class BbwzDriver extends cc.Component {\r\n    // 静态全局对象\r\n    static instance: BbwzDriver = null;\r\n\r\n    // 默认头像框资源\r\n    @property(cc.SpriteFrame)\r\n    defaultHeadKuang: cc.SpriteFrame = null;\r\n\r\n    @property(cc.Node)\r\n    loadingNode: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    maskNode: cc.Node = null;\r\n\r\n    public chipManager: BbwzChipsManager = null;\r\n    // 游戏UI\r\n    public gameUI: BbwzGamePanel = null;\r\n    //历史\r\n    public historyPop: BbwzHistoryPop = null;\r\n    //在线玩家\r\n    public onlinePop: BbwzOnlinePlayerPop = null;\r\n    //规则\r\n    public rulePop: BbwzRulePop = null;\r\n    //设置\r\n    public settingPop: BbwzSettingPop = null;\r\n    //提示弹窗\r\n    public noticePop: BbwzNoticePop = null;\r\n\r\n    public inGame = false;     // 处理某些极端场景的报错, 资源预加载时强退到大厅, 场景未来得及销毁时立马又进来\r\n\r\n    private loadingContent: cc.Node;\r\n\r\n    protected onLoad() {\r\n        this.inGame = true;\r\n        BbwzDriver.instance = this;\r\n\r\n        this.loadingContent = cc.find(\"content\", this.loadingNode);\r\n        this.loadingContent.active = false;\r\n\r\n        Global.Component.initDriver();\r\n        Global.UI.initUIRoot();\r\n        Game.Component.initDriver();\r\n\r\n        //强制退出游戏  常用与网络异常\r\n        Game.Event.on(Game.EVENT_FORCE_LEAVE_GAME, this, this.onForceLeave);\r\n        Game.Event.on(Game.EVENT_NOT_IN_TABLE, this, this.reEnter);\r\n        Game.Event.on(Game.EVENT_SOCKET_RECONNECT, this, this.onSocketReconnect);\r\n\r\n        // 开启fps信息调试窗 \r\n        // cc.debug.setDisplayStats(true);\r\n        \r\n        this.init();\r\n    }\r\n\r\n    protected onDestroy() {\r\n        //强制退出游戏  常用与网络异常\r\n        Game.Event.off(Game.EVENT_FORCE_LEAVE_GAME, this, this.onForceLeave);\r\n        Game.Event.off(Game.EVENT_NOT_IN_TABLE, this, this.reEnter);\r\n        Game.Event.off(Game.EVENT_SOCKET_RECONNECT, this, this.onSocketReconnect);\r\n        this.unscheduleAllCallbacks();\r\n\r\n        // 先注销事件, 再销毁控制器, 最后销毁数据\r\n        BbwzDriver.instance = null;\r\n        BbwzData.instance = null;\r\n    }\r\n\r\n    protected start(){\r\n        this.initLoading();\r\n    }\r\n\r\n    private async initLoading(){\r\n        if (Global.GameData.checkHasCustomLoading && !Global.GameData.checkHasCustomLoading(BbwzConstDefine.GAME_ID)){\r\n            let comp = await Global.UIHelper.getGameLoadingComp();\r\n            this.loadingContent.active = false;\r\n            comp.node.setParent(this.loadingNode);\r\n            comp.node.active = true;\r\n        }\r\n        else{\r\n            this.loadingContent.active = true;\r\n        }\r\n    }\r\n\r\n\r\n    private init() {\r\n        BbwzData.getGameInfoData();\r\n        this.preLoadRes();\r\n    }\r\n\r\n    /**\r\n     * 预加载资源\r\n     */\r\n    private async preLoadRes() {\r\n        let atlasArr = [\r\n            BbwzPathHelper.gameTexturePath + \"atlas/poker/atlas_poker\",\r\n            BbwzPathHelper.gameTexturePath + \"atlas/dynamic/atlas_dynamic\",\r\n        ];\r\n        let prefabArr = [\r\n            BbwzPathHelper.gameTexturePath + \"atlas/dynamic/font/\" + BbwzConstDefine.rewardFontStr.Win,       // 塞到prefab一起预加载，不传类型自行推断\r\n            BbwzPathHelper.gameTexturePath + \"atlas/dynamic/font/\" + BbwzConstDefine.rewardFontStr.Lose,\r\n            BbwzPathHelper.gameTexturePath + \"atlas/dynamic/font/\" + BbwzConstDefine.areaRewardFontStr.Win,\r\n            BbwzPathHelper.gameTexturePath + \"atlas/dynamic/font/\" + BbwzConstDefine.areaRewardFontStr.Lose,\r\n\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzHistoryPop\",\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzNoticePop\",\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzOnlinePlayerPop\",\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzRulePop\",\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzSettingPop\",\r\n\r\n            BbwzPathHelper.gamePrefabsPath + \"panel/subView/coinView\",\r\n            BbwzPathHelper.gamePrefabsPath + \"panel/subView/stateView\",\r\n            BbwzPathHelper.gamePrefabsPath + \"panel/subView/bigWinner\",\r\n            BbwzPathHelper.gamePrefabsPath + \"panel/subView/comparePoker\",\r\n            BbwzPathHelper.gamePrefabsPath + \"panel/subView/selectChipsNode\",\r\n            BbwzPathHelper.gamePrefabsPath + \"panel/subView/rewardArea\",\r\n            BbwzPathHelper.gamePrefabsPath + \"panel/subView/betArea\",\r\n\r\n            BbwzPathHelper.gamePrefabsPath + \"panel/BbwzGamePanel\",\r\n        ];\r\n        \r\n        let loadAtlas = ()=>{\r\n            return new Promise((resolve, reject)=>{\r\n                Global.ResourceManager.loadBundleRes(BbwzConstDefine.GAME_ID,atlasArr, (err, res)=>{\r\n                    if (err)\r\n                        reject(err);\r\n                    else\r\n                        resolve(res);\r\n                });\r\n            })\r\n        }\r\n        \r\n        let loadPrefab = ()=>{\r\n            return new Promise((resolve, reject)=>{\r\n                Global.ResourceManager.loadBundleRes(BbwzConstDefine.GAME_ID,prefabArr, (err, res)=>{\r\n                    if (err)\r\n                        reject(err);\r\n                    else\r\n                        resolve(res);\r\n                });\r\n            })\r\n        }\r\n\r\n        \r\n        await HeadTipsManager.preloadRes();\r\n        await TaskManager.preloadRes();\r\n        await loadAtlas();\r\n        await loadPrefab();\r\n        // 防止load过程中强踢到大厅后调用报错\r\n        if (!this.node || !cc.isValid(this.node) || !this.inGame) {\r\n            return;\r\n        }\r\n        BbwzData.init();        // 数据优先于UI\r\n        this.initUI();\r\n        Game.Component.scheduleOnce(()=>{\r\n            this.tryStartGame();    // 连接协议之前把所有大UI都实例好  预留时间保证所有UI实例化好\r\n        }, 0.5);\r\n    }\r\n\r\n    private initUI(){\r\n        let popPrefabArr = [\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzHistoryPop\",\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzOnlinePlayerPop\",\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzRulePop\",\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzSettingPop\",\r\n            BbwzPathHelper.gamePrefabsPath + \"pop/BbwzNoticePop\",\r\n        ];\r\n\r\n        let popLayer = Global.UI.getLayer(\"PopLayer\") || cc.Canvas.instance.node;\r\n        for (let i = 0; i< popPrefabArr.length; i++){\r\n            let prefab = Global.ResourceManager.getBundleRes(BbwzConstDefine.GAME_ID,popPrefabArr[i], cc.Prefab);\r\n            let popNode: cc.Node = cc.instantiate(prefab);\r\n            popNode.setParent(popLayer);\r\n            if (i == 0) {\r\n                popNode.active = true;      // 初始化，优化第一次打开实例化速度\r\n                this.historyPop = Global.UIHelper.safeGetComponent(popNode, '', BbwzHistoryPop);\r\n                popNode.active = false;\r\n            }\r\n            if (i == 1) {\r\n                popNode.active = false;     // 不需要初始化\r\n                this.onlinePop = Global.UIHelper.safeGetComponent(popNode, '', BbwzOnlinePlayerPop);\r\n            }\r\n            if (i == 2) {\r\n                popNode.active = false;        \r\n                this.rulePop = Global.UIHelper.safeGetComponent(popNode, '', BbwzRulePop);\r\n            }\r\n            if (i == 3) {\r\n                popNode.active = false;         \r\n                this.settingPop = Global.UIHelper.safeGetComponent(popNode, '', BbwzSettingPop);\r\n            }\r\n            if (i == 4) {\r\n                popNode.active = false;   \r\n                this.noticePop = Global.UIHelper.safeGetComponent(popNode, '', BbwzNoticePop);\r\n            }\r\n        }\r\n\r\n        let prefab = Global.ResourceManager.getBundleRes(BbwzConstDefine.GAME_ID,BbwzPathHelper.gamePrefabsPath + \"panel/BbwzGamePanel\", cc.Prefab);\r\n        let gamePanel: cc.Node = cc.instantiate(prefab);    //实例化游戏界面\r\n        let mainLayer = Global.UI.getLayer(\"MainLayer\") || cc.Canvas.instance.node;\r\n        gamePanel.setParent(mainLayer);\r\n        gamePanel.active = true;        // 需要走onload初始化\r\n        this.gameUI = Global.UIHelper.safeGetComponent(gamePanel, '', BbwzGamePanel);\r\n        gamePanel.active = false;\r\n    }\r\n\r\n    // 尝试进入游戏\r\n    private tryStartGame() {\r\n        Logger.error(\"Bbwz tryStartGame\");\r\n        Global.Audio.playBundleMusic(BbwzConstDefine.GAME_ID,BbwzConstDefine.SOUND_BGM);\r\n        BbwzNetHandler.registerNetHandler();\r\n        this.enterGame(Game.Control.curLv);\r\n    }\r\n\r\n    /**\r\n     * 加载vip头像框，如果使用的不是vip头像框，则使用子游戏默认头像框\r\n     * @param spriteHeadKuang 头像框Sprite\r\n     * @param headkuang vip头像框字符串\r\n     */\r\n    public loadVipHeadKuang(spriteHeadKuang: cc.Sprite, headkuang: string) {\r\n        // Global.Toolkit.loadLocalHeadFrame(spriteHeadKuang, headkuang);\r\n        var atlasString = \"texture/atlas/headFrame/headFrame\";\r\n        var sfString = \"txkuang_vip\" + headkuang;\r\n        // return Global.ResourceManager.loadAutoAtlas(this.headBox, atlasString, sfString, () => {\r\n        //     this.headBox.sizeMode = cc.Sprite.SizeMode.CUSTOM;\r\n        //     this.headBox.trim = false\r\n        // }, false);\r\n        Global.ResourceManager.loadBundleAutoAtlas(\"1017\", spriteHeadKuang, atlasString, sfString, null, true);\r\n    }\r\n\r\n    /**\r\n     * 请求离开游戏\r\n     */\r\n    public reqLeaveGame() {\r\n        Game.Server.send(BbwzConstDefine.SEND_LEAVE, { \"IsClose\": 1 });\r\n        Game.Tween.clear();\r\n        Game.Component.unscheduleAllCallbacks();\r\n        this.gameUI.clearByRound();\r\n        \r\n        if (this.checkShowChooseLevel()) {\r\n            this.scheduleOnce(()=>{\r\n                this.exitScene();\r\n            }, 0.5);\r\n            return;\r\n        }\r\n        this.scheduleOnce(()=>{\r\n            this.exitScene();\r\n        }, 0.5);\r\n    }\r\n\r\n    //  是否需要显示选场\r\n    public checkShowChooseLevel(): boolean {\r\n        let gameInfo = Global.GameData.getGameInfo(BbwzConstDefine.GAME_ID);\r\n        if (gameInfo != null && gameInfo.levels != null && gameInfo.levels.length <= 1) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 退出游戏层，返回选场层\r\n     * @forceGoToHall 大厅推送时第一个参数\r\n     */\r\n    public onForceLeave(forceGoToHall: boolean = true, explain: string = null) {\r\n        if (forceGoToHall) {\r\n            if (explain)\r\n                Global.Toolkit.transmitHallMsg(explain, null, null, 1);\r\n            //退出游戏\r\n            this.exitScene();\r\n        }\r\n        else{\r\n            // 离开游戏返回选场\r\n            this.exitScene();\r\n        }\r\n    }\r\n\r\n    // 退出游戏场景，返回大厅\r\n    private exitScene() {\r\n        if (!this.inGame)       // 1.加延时退出保证服务器收到leave消息避免shutDown掉  2.加return判断已经退出的无须重复执行\r\n            return;\r\n        //this.gameUI.node.active = false;        // debug 退出场景有概率不会立即销毁, update还是会跑还在add Tween, 导致报错\r\n        this.hideAllPop();\r\n        \r\n        Game.Component.unscheduleAllCallbacks();\r\n        Game.Tween.clear();\r\n        Game.Control.shutDown(true);\r\n        this.inGame = false;\r\n        if (this.checkShowChooseLevel()) {\r\n            Global.Toolkit.transmitHallWindow(\"WndHallChooseRoom\", BbwzConstDefine.GAME_ID);\r\n        }\r\n        Global.SceneManager.goToHall();\r\n    }\r\n\r\n    // 连接游戏服\r\n    private enterGame(levelId: string) {\r\n        Game.Control.connnectAndEnterGameInLevelScene(BbwzConstDefine.GAME_ID, levelId, \"default\", null, null);\r\n    }\r\n\r\n    private reEnter(){\r\n        Game.Control.trySendEnter();\r\n    }\r\n\r\n    private onSocketReconnect() {\r\n        Game.Tween.clear();\r\n        Game.Component.unscheduleAllCallbacks();\r\n        Global.Audio.stopAllEffect();\r\n        this.gameUI.clearByRound();\r\n    }\r\n\r\n    // 进入游戏界面\r\n    public gotoGamePanel() {\r\n        Global.Event.event(GlobalEvent.HIDE_NET_WAITING, \"ConnectGame\");\r\n        if (this.gameUI.node.active)        // 已经在场内\r\n            return;\r\n\r\n        let comp = Global.UIHelper.addIntoGameAnimComp(this.gameUI.node, this.loadingNode, [this.gameUI.selectChipsView.node], [], [], []);\r\n        comp.maskNode = this.maskNode;\r\n        this.maskNode.opacity = 1;\r\n        this.maskNode.active = true;\r\n        this.maskNode.zIndex = 11;      // Global.UI在10\r\n        this.gameUI.node.active = true;\r\n\r\n        let time = 1;\r\n        comp.startAnimtionByMask(time, 0, null, null);\r\n        Game.Event.event(Game.EVENT_ADDTIMELOCK, \"IntoGameAnimation\", time);\r\n    }\r\n\r\n    public gotoChooseLevel(){\r\n\r\n    }\r\n\r\n    // 隐藏所有弹窗\r\n    public hideAllPop() {\r\n        this.historyPop.node.active = false\r\n        this.noticePop.node.active = false;\r\n        this.onlinePop.node.active = false;\r\n        this.rulePop.node.active = false;\r\n        this.settingPop.node.active = false;\r\n    }\r\n};\r\n"]}