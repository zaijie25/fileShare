{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\recharge\\WndWeChatRechange.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WndBase, { DestoryType } from \"../../../core/ui/WndBase\";\r\n\r\nexport default class WndWeChatRechange extends WndBase {\r\n    private codeSprite: cc.Sprite;\r\n    private qrCodeURl;\r\n    protected onInit() {\r\n        this.name = \"WndWeChatRechange\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/Recharge/WeChatRechangeUI\";\r\n        this.destoryType = DestoryType.None;\r\n    }\r\n    protected initView() {\r\n        this.node.width = cc.Canvas.instance.node.width;\r\n        this.node.height = cc.Canvas.instance.node.height;\r\n        this.codeSprite = this.getChild(\"bankNode/qrCodeSprite\").getComponent(cc.Sprite);\r\n        this.addCommonClick(\"headNode/btnBack\", this.goBack, this,cc.Button.Transition.NONE);\r\n        this.addCommonClick(\"headNode/helpNode\", this.goBack, this,cc.Button.Transition.NONE);\r\n        this.addCommonClick(\"bankNode/copyNode\", this.saveQRCode, this,cc.Button.Transition.NONE);//保存二维码\r\n    }\r\n    onOpen(){\r\n        let self = this;\r\n        let data = this.args[0];\r\n        this.qrCodeURl = data.url;\r\n        this.codeSprite.spriteFrame = null;\r\n        if (CC_JSB) {\r\n            Global.Event.event(GlobalEvent.SHOW_NET_WAITING, true)\r\n            Global.Toolkit.LoadPicToNative(Global.Toolkit.DealWithUrl(this.qrCodeURl), Global.Toolkit.DealWithUrl(this.qrCodeURl), (texture:cc.Texture2D) => {\r\n                if(self.node && self.node.isValid)\r\n                {\r\n                    var frame = new cc.SpriteFrame(texture);\r\n                    self.codeSprite.sizeMode =  cc.Sprite.SizeMode.CUSTOM\r\n                    self.codeSprite.spriteFrame = frame\r\n                    Global.Event.event(GlobalEvent.HIDE_NET_WAITING, false)\r\n                }\r\n            })\r\n        }\r\n        else {\r\n            Global.Event.event(GlobalEvent.SHOW_NET_WAITING, true)\r\n            cc.loader.load(this.qrCodeURl, function (err, texture:cc.Texture2D) {\r\n                if(self.node && self.node.isValid)\r\n                {\r\n                    var frame = new cc.SpriteFrame(texture);\r\n                    self.codeSprite.sizeMode =  cc.Sprite.SizeMode.CUSTOM\r\n                    self.codeSprite.spriteFrame = frame\r\n                    Global.Event.event(GlobalEvent.SHOW_NET_WAITING, false)\r\n                }\r\n            })\r\n        }\r\n    }\r\n    private goBack() {\r\n        this.close();\r\n    }\r\n    //保存二维码\r\n    private saveQRCode() {\r\n        if (!CC_JSB) {\r\n            return;\r\n        }\r\n        if(this.qrCodeURl && this.codeSprite.spriteFrame !=null){\r\n            let name = Global.Toolkit.md5(this.qrCodeURl)\r\n            let filePath = jsb.fileUtils.getWritablePath() + name + '.jpg';\r\n            Global.NativeEvent.saveToAlbum(filePath,() => {\r\n            })\r\n            Global.UI.fastTip(\"保存二维码成功\");\r\n        }else{\r\n            Global.UI.fastTip(\"二维码未加载完成\");\r\n        }\r\n            \r\n    }\r\n}"]}