{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\Activity\\WndActivityCenter.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WndBase, { DestoryType } from \"../../../core/ui/WndBase\";\r\nimport PoolBase from \"../../../core/tool/PoolBase\";\r\nimport ActivityRightPanelView from \"./ActivityRightPanelView\";\r\nimport ServicerItem from \"../serviver/ServicerItem\";\r\nimport HallPopMsgHelper, { PopWndName } from \"../../tool/HallPopMsgHelper\";\r\nimport HallModel, { HallRedSpotType } from \"../../../hallcommon/model/HallModel\";\r\nimport AppHelper from \"../../../core/tool/AppHelper\";\r\nimport { ActivityConstants, ActivityType } from \"./ActivityConstants\";\r\nimport HallBtnHelper from \"../hall/views/HallBtnHelper\";\r\n\r\nexport default class WndActivityCenter extends WndBase {\r\n\r\n    contentNode: cc.Node;\r\n    copyItem: any;\r\n    leftPanel: cc.Node;\r\n    activityPanel: cc.Node;\r\n    itemPool: LeftItemPool;\r\n    nodeList: any[] = [];\r\n    activityPanelView: ActivityRightPanelView;\r\n    ziSprite: cc.Node;\r\n    Servicer1: cc.Node;\r\n    Servicer2: cc.Node;\r\n    hallModel: HallModel;\r\n    actMap: Map<number, ActivityEntity> = null;\r\n    sc: cc.ScrollView\r\n    waittingNode: cc.Node = null\r\n\r\n    timer: any = null\r\n\r\n\r\n    protected onInit() {\r\n\r\n        this.name = \"WndActivityCenter\";\r\n        this.layer = \"PopLayer\";\r\n        this.resPath = \"hall/prefabs/ui/ActivityCenter/ActivityCenterUI\";\r\n        this.hallModel = Global.ModelManager.getModel(\"HallModel\");\r\n        this.isNeedDelay = true\r\n        this.destoryType = DestoryType.ChangeScene;\r\n    }\r\n\r\n    protected onOpen() {\r\n        this.initActivityLeft();\r\n        this.activityPanelView.subViewState = true\r\n    }\r\n\r\n    initActivityLeft() {\r\n        // if (this.actMap && this.actMap.size > 0 && cc.isValid(this.node)) {\r\n        //     this.initLeftItem();\r\n        //     return\r\n        // }\r\n        // HallPopMsgHelper.Instance.releaseLock(PopWndName.ActivityCenter);\r\n        this.hallModel.requestMyActivityList((info: Map<number, ActivityEntity>) => {\r\n            this.OnDataPrepared()\r\n            this.actMap = info;\r\n            if (this.actMap.size == 0) {\r\n                this.contentNode.removeAllChildren();\r\n                this.itemPool.resetPool();\r\n                this.nodeList = [];\r\n                this.activityPanelView.changeView(ActivityType.noMsgTips);\r\n                this.showZi();\r\n                return;\r\n            }\r\n\r\n            if (cc.isValid(this.node)) {\r\n                this.initLeftItem();\r\n            }\r\n        });\r\n    }\r\n\r\n    public openAnimFinish() {\r\n\r\n    }\r\n\r\n    initLeftItem() {\r\n        this.recycle();\r\n        this.nodeList = [];\r\n        this.contentNode.removeAllChildren();\r\n        let mapInfo: Map<number, ActivityEntity> = this.actMap;\r\n        let arrGen = this.actMap.keys();\r\n        for (let i = 0; i < mapInfo.size; i++) {\r\n            let key = arrGen.next().value as number;\r\n            let entity: ActivityEntity = mapInfo.get(key);\r\n            if (entity.status == 0) {\r\n                continue\r\n            }\r\n            let item = this.itemPool.getItem();\r\n            item.active = true;\r\n            item.name = entity.atype.toString();\r\n            let itemEntity = item.getComponent(\"FeedbackLeftItem\");\r\n            itemEntity.onInit(entity.name);\r\n            itemEntity.entityData = entity;\r\n            // itemEntity\r\n            item.setParent(this.contentNode);\r\n            this.nodeList.push(item);\r\n            item.on(cc.Node.EventType.TOUCH_END, this.leftItemClick, this);\r\n            let path = \"hall/texture/commonui/common\";\r\n            let typeName = \"\"\r\n            if (entity.flag == 1) {\r\n                typeName = \"bq_huobao\"\r\n            } else if (entity.flag == 2) {\r\n                typeName = \"bq_xingzeng\"\r\n            }\r\n            item.getComponent(\"FeedbackLeftItem\").SetTypeSprite(path, typeName);\r\n            // item.getChildByName(\"typeSprite\").getChildByName(\"la\").getComponent(cc.Label).string=typeName\r\n            item.getChildByName(\"Background\").active = true;\r\n            if (i == 0) {\r\n                item.getComponent(\"FeedbackLeftItem\").SetToggleChecked(true);\r\n                item.getChildByName(\"Background\").active = false;\r\n                if (entity.ptype == 1) {\r\n                    this.activityPanelView.changeView(ActivityType.picture, entity);\r\n                }\r\n                else {\r\n                    this.activityPanelView.changeView(entity.atype, entity);\r\n                }\r\n                this.changeService(entity);\r\n                if (typeName) {\r\n                    this.moveFlag(item)\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n        if (this.sc) {\r\n            this.sc.scrollToTop()\r\n        }\r\n\r\n\r\n    }\r\n    public moveFlag(item, reset?) {\r\n        if (!item || !cc.isValid(item)) return\r\n        let flagNode = cc.find(\"typeSprite\", item);\r\n        if (reset) {\r\n            if (flagNode) {\r\n                // flagNode.setPosition(65, 30);\r\n            }\r\n            return\r\n        }\r\n        if (flagNode) {\r\n            // flagNode.setPosition(65, 30)\r\n        }\r\n    }\r\n\r\n    leftItemClick(event) {\r\n        Global.Audio.playBtnSound();\r\n        let item = event.target;\r\n        if( !item.getChildByName(\"Background\").active){return}\r\n        this.resetItemFlag()\r\n        let itmeParent = event.target.parent\r\n        itmeParent.children.forEach(element => {\r\n            element.getChildByName(\"Background\").active = true;\r\n        });\r\n        item.getChildByName(\"Background\").active = false;\r\n        let leftItem = item.getComponent(\"FeedbackLeftItem\");\r\n        let entityData = leftItem.entityData;\r\n        if (entityData && entityData.ptype == 1) {\r\n            this.activityPanelView.changeView(ActivityType.picture, entityData);\r\n        }\r\n        else {\r\n            this.activityPanelView.changeView(entityData.atype, entityData);\r\n        }\r\n\r\n        this.moveFlag(item)\r\n        this.changeService(entityData);\r\n\r\n    }\r\n\r\n    resetItemFlag() {\r\n        for (let index = 0; index < this.nodeList.length; index++) {\r\n            let element = this.nodeList[index];\r\n            if (element) {\r\n                let leftItem = element.getComponent(\"FeedbackLeftItem\");\r\n                if (leftItem && leftItem.node) {\r\n                    this.moveFlag(leftItem.node, true)\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    changeService(data) {\r\n        let serviceData1: any = {};\r\n        let serviceData2: any = {};\r\n        serviceData1 = data.job1;\r\n        serviceData2 = data.job2;\r\n        if ((serviceData1.type == 0 && serviceData2.type == 0)) {\r\n            this.showZi();\r\n        } else {\r\n            this.ziSprite.active = false;\r\n            if (serviceData1) {\r\n                this.Servicer1.active = true;\r\n                this.Servicer1.getComponent(ServicerItem).setData(serviceData1);\r\n            }\r\n            if (serviceData2) {\r\n                this.Servicer2.active = true;\r\n                this.Servicer2.getComponent(ServicerItem).setData(serviceData2);\r\n            }\r\n        }\r\n    }\r\n\r\n    private showZi() {\r\n        this.Servicer1.active = false;\r\n        this.Servicer2.active = false;\r\n        this.ziSprite.active = true;\r\n    }\r\n\r\n    protected initView() {\r\n        this.waittingNode = this.getChild(\"waittingNode\")\r\n        if (this.waittingNode) {\r\n            this.waittingNode.active = false\r\n        }\r\n        this.sc = this.getComponent<cc.ScrollView>(\"LeftPanel/scrollview\", cc.ScrollView)\r\n        this.leftPanel = this.getChild(\"LeftPanel\");\r\n        this.activityPanel = this.getChild(\"RightPanel\");\r\n        this.copyItem = this.getChild(\"LeftPanel/MsgItem\");\r\n        this.contentNode = this.getChild(\"LeftPanel/scrollview/view/content\");\r\n        this.ziSprite = this.getChild(\"service/ziSprite\");\r\n        this.Servicer1 = this.getChild(\"service/Servicer1\");\r\n        this.Servicer2 = this.getChild(\"service/Servicer2\");\r\n        // this.addCommonClick(\"service/ziSprite/btn_normal_ljlj\", this.onServiceClick, this);\r\n        Global.Event.on(ActivityConstants.SHOW_ACT_WAITTING, this, this.showWaitting)\r\n        Global.Event.on(ActivityConstants.HIDE_ACT_WAITTING, this, this.showWaitting)\r\n        this.addCommonClick(\"close\", this.closeWnd, this);\r\n        this.initItemPool();\r\n        this.activityPanelView = <ActivityRightPanelView>this.addView(\"ActivityRightPanelView\", this.activityPanel, ActivityRightPanelView);\r\n\r\n    }\r\n    private onServiceClick() {\r\n        let kefuModel = <HallModel>Global.ModelManager.getModel(\"HallModel\");\r\n        kefuModel.closeRedSpot(HallRedSpotType.Kefu);\r\n        Global.Audio.playAudioSource(\"hall/sound/Customer_service\")\r\n        HallBtnHelper.WndServiceOpen();\r\n    }\r\n    showWaitting(arg) {\r\n        if (arg) {\r\n            this.startWaittingTimer()\r\n        }\r\n        else {\r\n            this.stopWaittingTimer()\r\n        }\r\n        if (this.waittingNode && this.waittingNode.isValid && this.waittingNode.active != arg)\r\n            this.waittingNode.active = arg\r\n    }\r\n    stopWaittingTimer() {\r\n        if (this.timer) {\r\n            clearTimeout(this.timer)\r\n        }\r\n    }\r\n    startWaittingTimer() {\r\n        this.stopWaittingTimer()\r\n        this.timer = setTimeout(() => {\r\n            this.waittingNode.active = false\r\n        }, 10000);\r\n    }\r\n\r\n    private closeWnd() {\r\n        this.close();\r\n    }\r\n\r\n    private initItemPool() {\r\n        this.itemPool = new LeftItemPool(this.copyItem);\r\n    }\r\n\r\n    protected onClose() {\r\n        this.stopWaittingTimer()\r\n        this.resetItemFlag()\r\n        HallPopMsgHelper.Instance.releaseLock(PopWndName.ActivityCenter);\r\n    }\r\n\r\n\r\n\r\n    protected onDispose() {\r\n        this.itemPool.resetPool();\r\n        this.nodeList = [];\r\n        this.stopWaittingTimer()\r\n        Global.Event.off(ActivityConstants.SHOW_ACT_WAITTING, this, this.showWaitting)\r\n        Global.Event.off(ActivityConstants.HIDE_ACT_WAITTING, this, this.showWaitting)\r\n    }\r\n\r\n    public recycle() {\r\n        this.itemPool.recycleAll(this.nodeList);\r\n        this.nodeList = [];\r\n    }\r\n\r\n}\r\n\r\nclass LeftItemPool extends PoolBase {\r\n    constructor(private copyNode: cc.Node) {\r\n        super();\r\n    }\r\n\r\n    protected createItem() {\r\n        return cc.instantiate(this.copyNode);\r\n    }\r\n\r\n    protected resetItem(node: cc.Node) {\r\n\r\n        node.active = false;\r\n        node.setParent(null);\r\n    }\r\n    public recycleAll(arr: Array<any>) {\r\n        super.recycleAll(arr);\r\n    }\r\n}\r\n/**\r\n * 活动数据实体类\r\n */\r\nexport class ActivityEntity {\r\n    flag: number = 0;\r\n    atype: number = -1;\r\n    ptype: number = 0; //1图片\r\n    name: string = \"\";\r\n    url: string = \"\";\r\n    status: number = -1\r\n    red_status: number = -1  //红点 0 显示 其他不显示\r\n    job1: any = {\r\n        type: 0, //客服类型\r\n        name: \"\", //客服名称\r\n        data: \"\" //客服号码\r\n    }\r\n    job2: any = {\r\n        type: 0, //客服类型\r\n        name: \"\", //客服名称\r\n        data: \"\" //客服号码\r\n    }\r\n}"]}