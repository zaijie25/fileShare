{"version":3,"sources":["assets\\hall\\scripts\\logic\\hallcommon\\model\\PlayerInfoModel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ModelBase from \"../../../framework/model/ModelBase\";\r\nimport { NetAppface } from \"../../core/net/hall/NetEvent\";\r\n\r\nexport default class PlayerInfoModel extends ModelBase {\r\n    /**\r\n     * 全局对象\r\n     */\r\n    static instance: PlayerInfoModel = null;\r\n\r\n    public vipSubsidy = {}\r\n    public vipSubsidyStatus = 0\r\n    public vipSubsidyCount = 0\r\n\r\n    /**\r\n     *  vip是否发送奖励\r\n     */\r\n    public vip_reward = 0;\r\n    /**\r\n     * vip信息\r\n     */\r\n    public vip_cfg = [];\r\n    /**\r\n     * 是否有vip奖励可以领取\r\n     */\r\n    public is_vip_reward = 0;\r\n\r\n    public is_week_reward = 0\r\n    public is_month_reward = 0\r\n    public musicData: Map<string, BgmEntity> = null\r\n\r\n    public static UpdateScrollView = \"UpdateScrollView\"\r\n\r\n    /**\r\n     * 电台歌曲名称和下载地址\r\n     * url：下载地址 surl：存储地址\r\n     */\r\n    diantaiMusicArr = [\r\n        { name: \"默认背景音乐\", singer: \"\", file: \"\", url: \"\", surl: \"\", download: true },\r\n    ];\r\n    \r\n\r\n    /**\r\n     * 当前正在播放的音乐数据对象\r\n     */\r\n    static playingObj = null;\r\n\r\n\r\n    onClear()\r\n    {\r\n        this.is_vip_reward = 0\r\n        this.is_week_reward = 0\r\n        this.is_month_reward = 0\r\n    }\r\n    /**\r\n     * 初始化背景音乐\r\n     */\r\n    InitBgm() {\r\n        // this.initRequestInfo();\r\n        if (this.diantaiMusicArr[0].url == \"\") {\r\n            this.diantaiMusicArr[0].url = Global.Setting.hallBGM;\r\n            this.diantaiMusicArr[0].surl = Global.Setting.hallBGM;\r\n            this.diantaiMusicArr[0].file = Global.Setting.hallBGM;\r\n\r\n        }\r\n\r\n        var bMusic = false;//是否找到了背景音乐\r\n        var bgm = Global.Setting.storage.get(\"bgm\");\r\n        if (!bgm) {\r\n            this.requestBgmList()\r\n            this.playBgm(bMusic, this.getLocalFileName(Global.Setting.hallBGM))\r\n            return\r\n        }\r\n\r\n        if (!this.musicData) {\r\n            this.requestBgmList((data: Map<string, BgmEntity>) => {\r\n                let arrName = data.keys();\r\n                for (let i = 0; i < data.size; i++) {\r\n                    let key = arrName.next().value as string;\r\n                    let entity = data.get(key);\r\n                    let surl = this.getLocalFileName(entity.file)\r\n                    if (surl == bgm) {\r\n                        bMusic = true\r\n                        this.playBgm(bMusic, bgm)\r\n                        return\r\n                    }\r\n\r\n                }\r\n                if (0 == data.size) {\r\n                    this.playBgm(bMusic, this.getLocalFileName(Global.Setting.hallBGM))\r\n                    return\r\n                }\r\n                if (!bMusic) {\r\n                    this.playBgm(bMusic, this.getLocalFileName(Global.Setting.hallBGM))\r\n                }\r\n            })\r\n            return\r\n        }\r\n\r\n        let arrName = this.musicData.keys();\r\n        for (let i = 0; i < this.musicData.size; i++) {\r\n            let key = arrName.next().value as string;\r\n            let entity = this.musicData.get(key);\r\n            let surl = this.getLocalFileName(entity.file)\r\n            if (surl == bgm) {\r\n                bMusic = true\r\n                this.playBgm(bMusic, bgm)\r\n                return\r\n            }\r\n\r\n        }\r\n        if (0 == this.musicData.size) {\r\n            this.playBgm(bMusic, this.getLocalFileName(Global.Setting.hallBGM))\r\n            return\r\n        }\r\n        if (!bMusic) {\r\n            this.playBgm(bMusic, this.getLocalFileName(Global.Setting.hallBGM))\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    public playBgm(exist: boolean, bgm) {\r\n        if (!exist) {\r\n            Global.Setting.storage.set(\"bgm\", bgm)\r\n            Global.Audio.playHallBGM();\r\n            return\r\n        }\r\n        Global.Audio.playMusic(bgm);\r\n\r\n    }\r\n\r\n    public requestBgmList(callback = null) {\r\n        let self = this\r\n        Global.HallServer.send(NetAppface.mod, \"GetBgmList\", {},\r\n            function (data: any) {\r\n\r\n                //成功\r\n                let bgmMap = new Map<string, BgmEntity>();\r\n                if (data.length > 0) {\r\n                    for (let i = 0; i < data.length; i++) {\r\n                        let music = data[i];\r\n                        let entity = new BgmEntity();\r\n                        entity.name = music.name;\r\n                        entity.file = music.file;\r\n                        entity.singer = music.singer;\r\n                        bgmMap.set(entity.name, entity);\r\n                        if (!Global.Setting.resServerUrl) {\r\n                            let urlArray = music.file.split(\"//\");\r\n                            if (urlArray.length > 0) {\r\n                                let scheme = urlArray[0]\r\n                                let hostUrl = urlArray[1]\r\n                                let hostArray = hostUrl.split(\"/\")\r\n                                let host = hostArray[0]\r\n                                Global.Setting.resServerUrl = scheme + \"//\" + host\r\n                                Logger.error(\"Global.Setting.resServerUrl = \" + Global.Setting.resServerUrl)\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                    self.musicData = bgmMap\r\n                }\r\n                if (callback) {\r\n\r\n                    callback(bgmMap);\r\n                }\r\n\r\n            }.bind(this),\r\n\r\n            function (data: any) {\r\n                //失败\r\n                Logger.error(\"PlayerInfoModel requestBgmList failed\");\r\n            }.bind(this),\r\n            false,\r\n            30\r\n        );\r\n    }\r\n    /**\r\n    * url转MD5，并拼接后缀\r\n    * @param url \r\n    */\r\n    public getLocalFileName(url: string): string {\r\n        let name = url;\r\n        let end = name.lastIndexOf('.');\r\n        let namePre = name.slice(0, end);\r\n        let fileSuffix = name.substring(end);\r\n        return jsb.fileUtils.getWritablePath() + Global.Toolkit.md5(namePre) + fileSuffix;\r\n    }\r\n    /**\r\n     * 升级到每个vip等级需要的总经验值，从升到 1 级vip开始\r\n     */\r\n    vipExpArr = [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500];\r\n\r\n    /**\r\n     * 初始化\r\n     */\r\n    onInit() {\r\n        PlayerInfoModel.instance = this;\r\n    }\r\n    /**\r\n     * 销毁\r\n     */\r\n    onDestroy() {\r\n        PlayerInfoModel.instance = null;\r\n    }\r\n\r\n    get Name() {\r\n        return \"PlayerInfoModel\";\r\n    }\r\n\r\n    /**\r\n     * 初始化相关配置数据\r\n     * @param cfg \r\n     */\r\n    InitData(cfg) {\r\n        if (!cfg) {\r\n            return;\r\n        }\r\n        this.vip_cfg = cfg;\r\n        for (var i = 0; i < cfg.length; i++) {\r\n            var obj = cfg[i];\r\n            this.vipExpArr[obj.vip - 1] = obj.vip_coin;\r\n        }\r\n    }\r\n    /**\r\n     * 初始化补助金相关配置\r\n     * @param cfg \r\n     */\r\n    // \"subsidy_point\":{\r\n    //     \"user_vip\":{\r\n    //         \"0\":{\"point\":10000,\"times\":1},   // vip0 补助金金额 1元 次数 1次\r\n    //         \"1\":{\"point\":20000,\"times\":2},   // vip1 补助金金额 2元 次数 2次\r\n    //     },\r\n    //     \"status\":1,                                              // 状态  1 开启补助金\r\n    //     \"self_times\":1                                         // 用户当日剩余次数\r\n    // }\r\n    InitSubsidy(cfg) {\r\n        if (!cfg) {\r\n            return;\r\n        }\r\n        this.vipSubsidy = cfg.user_vip;\r\n        this.vipSubsidyStatus = cfg.status;\r\n        this.vipSubsidyCount = cfg.self_times;\r\n    }\r\n\r\n    /**\r\n     * 请求玩家信息\r\n     */\r\n    reqGetUserInfo(callback, errorback) {\r\n        let param: any = {}\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.GetUserInfo, param, callback, errorback);\r\n    }\r\n\r\n    /**\r\n     * 请求修改昵称/头像\r\n     * @param param \r\n     * @param callback \r\n     */\r\n    reqEditUserInfo(param, callback) {\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.EditUserInfo, param, callback, null, false);\r\n    }\r\n\r\n    /**\r\n     * 请求修改头像框\r\n     * @param param \r\n     * @param callback \r\n     */\r\n    reqSetSelfCfg(param, callback) {\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.SetSelfCfg, param, callback, null, false);\r\n    }\r\n\r\n    /**\r\n     * 得vip升级需要的 \r\n     * @param toVip \r\n     */\r\n    GetVipUpgradeExp(toVip) {\r\n        var exp = 0;\r\n        var index = toVip - 1;\r\n        if (index >= 0 && index < this.vipExpArr.length) {\r\n            exp = this.vipExpArr[index];\r\n        }\r\n        return exp;\r\n    }\r\n}\r\n\r\n//bgm实体类\r\nexport class BgmEntity {\r\n    private _name: string = \"\";\r\n    private _file: string = \"\";//音乐路径\r\n    private _singer: string = \"\";\r\n    // private flag: number = 0;\r\n    public get name(): string {\r\n        return this._name;\r\n    }\r\n\r\n    public set name(name: string) {\r\n        this._name = name;\r\n    }\r\n\r\n    public get file(): string {\r\n        return this._file;\r\n    }\r\n\r\n    public set file(file: string) {\r\n        this._file = file;\r\n    }\r\n\r\n    public get singer(): string {\r\n        return this._singer;\r\n    }\r\n\r\n    public set singer(singer: string) {\r\n        this._singer = singer;\r\n    }\r\n\r\n\r\n}"]}