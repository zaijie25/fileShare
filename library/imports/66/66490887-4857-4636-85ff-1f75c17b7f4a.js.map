{"version":3,"sources":["assets\\hall\\scripts\\logic\\core\\component\\PlayerWallet.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ViewBase from \"../ui/ViewBase\";\r\nimport GlobalEvent from \"../GlobalEvent\";\r\nimport HallBtnHelper from \"../../hall/ui/hall/views/HallBtnHelper\";\r\nimport PlayerInfoModel from \"../../hallcommon/model/PlayerInfoModel\";\r\n\r\n\r\nexport default class PlayerWallet extends ViewBase {\r\n\r\n    private jbLabel: cc.Label = null;\r\n    private SpineNode: sp.Skeleton = null;\r\n    // private yhLabel: cc.Label = null;\r\n    private getTime = 0; //点击时长\r\n    private hearttime: any;\r\n    private img_shuaxin:cc.Node = null;\r\n    protected initView() {\r\n        this.img_shuaxin = this.getChild(\"img_shuaxin\");\r\n        Global.UIHelper.addCommonClick(this.node, \"img_shuaxin\", this.refreshCoinBtnClick, this);\r\n        this.jbLabel = this.getComponent(\"jbLabel\", cc.Label);\r\n        this.SpineNode = this.getComponent(\"refreshSkeleton\", sp.Skeleton);\r\n      //  Global.UIHelper.addCommonClick(this.node, \"icon_yinhang\", this.onBankClick, this);\r\n        // this.yhLabel = this.getComponent(\"yhLabel\",cc.Label);\r\n        // this.addCommonClick(\"jbBox\", this.jbBtnClickFunc, this, null);\r\n        // this.addCommonClick(\"yhBox\",this.yhBtnClickFunc,this, null);\r\n    }\r\n\r\n    private onBankClick() {\r\n        HallBtnHelper.WndBankOpen();\r\n        Global.Audio.playAudioSource(\"hall/sound/bank\")\r\n    }\r\n    //刷新事件\r\n    public refreshAction (){\r\n       // this.addCommonClick(\"jinb_sx\", this.refreshCoinBtnClick, this, null);\r\n    }\r\n    //充值事件\r\n    public rechargeAction (){\r\n        this.addCommonClick(\"jbBox\", this.jbBtnClickFunc, this, null);\r\n    }\r\n\r\n    onSubViewShow() {\r\n        this.playerPointChange();\r\n        //监听玩家金钱变化\r\n        Global.Event.on(GlobalEvent.PERSONALINFOUPDATE, this, this.playerPointChange);\r\n    }\r\n\r\n    onSubViewHide() {\r\n        //注销玩家金钱变化\r\n        Global.Event.off(GlobalEvent.PERSONALINFOUPDATE, this, this.playerPointChange);\r\n    }\r\n\r\n    onDispose() {\r\n        //注销玩家金钱变化\r\n        Global.Event.off(GlobalEvent.PERSONALINFOUPDATE, this, this.playerPointChange);\r\n    }\r\n\r\n    //玩家金币变化\r\n    playerPointChange() {\r\n        // this.jbLabel.string = Global.Toolkit.formatPoint(Global.PlayerData.point, 3).toString();\r\n        // this.yhLabel.string = Global.Toolkit.formatPoint(Global.PlayerData.bank_point, 3).toString();\r\n        this.jbLabel.string = Global.Toolkit.formatPointStr(Global.PlayerData.point, true).toString();\r\n        // this.yhLabel.string = Global.Toolkit.formatPointStr(Global.PlayerData.bank_point, true).toString();\r\n    }\r\n\r\n    //金币充值\r\n    jbBtnClickFunc() {\r\n        HallBtnHelper.WndRechargeOpen();\r\n    }\r\n\r\n    //银货充值\r\n    yhBtnClickFunc() {\r\n        HallBtnHelper.WndBankOpen();\r\n    }\r\n\r\n    public sendLoadingTime() {\r\n        clearTimeout(this.hearttime);\r\n        let self = this;\r\n        this.hearttime = setTimeout(function () {\r\n            self.getTime++;\r\n            if(self.getTime > 3){\r\n                self.getTime = 0\r\n                return;\r\n            }\r\n            self.sendLoadingTime();\r\n        }, 1000 * 1);\r\n    }\r\n    refreshCoinBtnClick() {\r\n\r\n        cc.tween(this.img_shuaxin).to(2,{rotation:720}).call(()=>{\r\n            this.img_shuaxin.rotation = 0;\r\n        }).start();\r\n\r\n\r\n        if(this.getTime == 0){\r\n            this.getTime++;\r\n            this.sendLoadingTime()\r\n    \r\n            PlayerInfoModel.instance.reqGetUserInfo((retObj) => {\r\n                Global.HallServer.event(NetAppface.GetUserInfo,retObj)\r\n\r\n            },(error) => {\r\n               \r\n            });\r\n        }else{\r\n            Logger.error(\"倒计时未结束 ==== \" + this.getTime);\r\n        }\r\n\r\n    }\r\n}\r\n"]}