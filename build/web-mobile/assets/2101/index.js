window.__require=function t(e,i,n){function a(r,s){if(!i[r]){if(!e[r]){var l=r.split("/");if(l=l[l.length-1],!e[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(o)return o(l,!0);throw new Error("Cannot find module '"+r+"'")}r=l}var h=i[r]={exports:{}};e[r][0].call(h.exports,function(t){return a(e[r][1][t]||t)},h,h.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof __require&&__require,r=0;r<n.length;r++)a(n[r]);return a}({ErmjAskActionView:[function(t,e,i){"use strict";cc._RF.push(e,"6ee30NDYW5EGKrwG9+ehP55","ErmjAskActionView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseView"),r=t("../data/ErmjPathHelper"),s=t("./mahjong/ErmjMahjongHandView"),l=t("../data/ErmjGameEvent"),c=t("../data/ErmjGameConst"),h=function(t){function e(e){var i=t.call(this)||this;return i.actData={},i.tingData={},i.operSelectItemList=[],i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.btnLayoutNode=this.getChild("btnLayout"),this.passBtn=this.getChild("btnLayout/btn_pass"),c.default.addCommonClick(this.passBtn,"",this.onPassClick,this),this.tingBtn=this.getChild("btnLayout/btn_ting"),c.default.addCommonClick(this.tingBtn,"",this.onTingClick,this),this.pongBtn=this.getChild("btnLayout/btn_pong"),c.default.addCommonClick(this.pongBtn,"",this.onPongClick,this),this.kongBtn=this.getChild("btnLayout/btn_kong"),c.default.addCommonClick(this.kongBtn,"",this.onKongClick,this),this.chowBtn=this.getChild("btnLayout/btn_chow"),c.default.addCommonClick(this.chowBtn,"",this.onChowClick,this),this.winBtn=this.getChild("btnLayout/btn_win"),c.default.addCommonClick(this.winBtn,"",this.onWinClick,this),this.tingCancelBtn=this.getChild("tingCancelBtn"),c.default.addCommonClick(this.tingCancelBtn,"",this.onTingCancel,this),this.tingCancelBtn.active=!1,this.operViewNode=this.getChild("operSelectView"),this.operViewNode.active=!1,this.operViewBgNode=this.getChild("operSelectView/bgNode"),this.operViewContentLayout=this.getComponent("operSelectView/content",cc.Layout),this.copyNode=this.getChild("operSelectView/content/operItem"),this.copyNode.active=!1},e.prototype.showBtnByConfig=function(t,e){if(void 0===t&&(t={}),void 0===e&&(e={}),t){this.actData=e,this.btnLayoutNode.active=!0,this.tingCancelBtn.active=!1;var i=t.isPong,n=t.isKong,a=t.isChow,o=t.isWin;this.pongBtn.active=!!i,this.kongBtn.active=!!n,this.chowBtn.active=!!a,this.winBtn.active=!!o,this.passBtn.active=!0}},e.prototype.showTingBtn=function(t,e){void 0===e&&(e={}),this.tingData=e,this.tingBtn.active=t,this.btnLayoutNode.active=!0,this.tingCancelBtn.active=!1,this.passBtn.active=!0},e.prototype.isAuto=function(){this.Context.isCmdAuto&&Game.Server.send(this.Define.CmdAuto,{auto_play:0})},e.prototype.onPassClick=function(){this.isAuto(),c.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),Game.Server.send(this.Define.CmdPass,{}),this.active=!1},e.prototype.onPongClick=function(){this.isAuto(),c.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0);var t=this.actData.pong_items;t&&t.length>0&&(Game.Server.send(this.Define.CmdPong,{cards:t[0].all_cards}),this.active=!1)},e.prototype.onKongClick=function(){this.isAuto(),c.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0);var t=this.actData.kong_items||[];if(t&&t.length>0)if(1==t.length)Game.Server.send(this.Define.CmdKong,{cards:t[0].all_cards}),this.active=!1,this.Context.set(this.Define.FieldInPlayTurn,!1);else{this.showOperList(t);var e=this.kongBtn.parent.convertToWorldSpaceAR(this.kongBtn.position),i=this.operViewNode.parent.convertToNodeSpaceAR(e);this.operViewNode.setPosition(i.add(cc.v3(0,108)))}},e.prototype.onChowClick=function(){this.isAuto(),c.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0);var t=this.actData.chow_items||[];if(t&&t.length>0)if(1==t.length)Game.Server.send(this.Define.CmdChow,{cards:t[0].all_cards,chow_card:t[0].card}),this.active=!1;else{this.showOperList(t);var e=this.chowBtn.parent.convertToWorldSpaceAR(this.chowBtn.position),i=this.operViewNode.parent.convertToNodeSpaceAR(e);this.operViewNode.setPosition(i.add(cc.v3(0,108)))}},e.prototype.onWinClick=function(){this.isAuto(),c.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0);var t=this.actData.win_items;Game.Server.send(this.Define.CmdWin,{card:t.card}),this.active=!1},e.prototype.onTingClick=function(){this.isAuto(),c.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),2==this.tingData.ting_type?(Game.Server.send(this.Define.CmdTing,{card:0}),this.active=!1):(Game.Event.event(l.default.doTingCallPlay,!0,this.tingData),this.tingCancelBtn.active=!0,this.btnLayoutNode.active=!1)},e.prototype.onTingCancel=function(){c.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),Game.Event.event(l.default.doTingCallPlay,!1,{}),this.tingCancelBtn.active=!1,this.btnLayoutNode.active=!0},e.prototype.showOperList=function(t){this.operViewNode.active=!0,this.resetOperList();for(var e=t.length,i=0;i<e;i++){var n=this.operSelectItemList[i];n||(n=this.copyOneItem()),n.active=!0,n.setStyle(t[i])}this.operViewBgNode.width=168*e+10},e.prototype.resetOperList=function(){this.operSelectItemList.forEach(function(t){t.active=!1})},e.prototype.copyOneItem=function(){var t=cc.instantiate(this.copyNode);t.setParent(this.operViewContentLayout.node);var e=new u(t,this.onOperItemClick,this);return this.operSelectItemList.push(e),e},e.prototype.onOperItemClick=function(t){this.active=!1,2==t.type&&Game.Server.send(this.Define.CmdChow,{cards:t.all_cards,chow_card:t.card}),6!=t.type&&5!=t.type||(Game.Server.send(this.Define.CmdKong,{cards:t.all_cards}),this.Context.set(this.Define.FieldInPlayTurn,!1))},e.prototype.onClose=function(){this.actData={},this.pongBtn.active=!1,this.kongBtn.active=!1,this.chowBtn.active=!1,this.winBtn.active=!1,this.winBtn.stopAllActions(),this.passBtn.active=!1,this.tingBtn.active=!1,this.tingCancelBtn.active=!1,this.operViewNode.active=!1},e.prototype.clearByRound=function(){this.active=!1},e}(o.default);i.default=h;var u=function(t){function e(e,i,n){var a=t.call(this)||this;return a.callback=i,a.target=n,a.mjItemList=[],a.setNode(e),a}return a(e,t),e.prototype.initView=function(){for(var t=0;t<4;t++){var e=this.getChild("mahjongHandView"+t.toString()),i=new s.default(e);i.active=!0,this.mjItemList.push(i)}c.default.addCommonClick(this.node,"",this.onSelectClick,this,cc.Button.Transition.NONE)},e.prototype.setStyle=function(t){this.curData=t;var e=2==t.type,i=6==t.type;this.mjItemList.forEach(function(n,a){n.active=!e||3!=a,i&&3!=a?n.isFront=!1:(n.isFront=!0,n.mahjongValue=t.all_cards[a],e&&t.all_cards[a]==t.card?n.setSpecialColor(!0):n.setSpecialColor(!1))})},e.prototype.onSelectClick=function(){this.callback.call(this.target,this.curData)},e}(o.default);cc._RF.pop()},{"../data/ErmjGameConst":"ErmjGameConst","../data/ErmjGameEvent":"ErmjGameEvent","../data/ErmjPathHelper":"ErmjPathHelper","./ErmjBaseView":"ErmjBaseView","./mahjong/ErmjMahjongHandView":"ErmjMahjongHandView"}],ErmjAskBtnView:[function(t,e,i){"use strict";cc._RF.push(e,"39e695Jig9BlZDbrUSNqQxv","ErmjAskBtnView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseView"),r=t("../data/ErmjPathHelper"),s=t("../data/ErmjGameConst"),l=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.autoBtn=this.getChild("autoBtn"),this.autoBtn.active=!1,this.autoCloseBtn=this.getChild("autoBtn/autoClose"),this.autoCloseBtn.active=!1,s.default.addCommonClick(this.autoBtn,"",this.onAutoPlayClick,this),this.cancelAuto=this.getChild("cancelAuto"),this.cancelAuto.active=!1,s.default.addCommonClick(this.node,"cancelAuto/btnCancel",this.onCancelAutoClick,this)},e.prototype.onClose=function(){this.clearByRound()},e.prototype.clearByRound=function(){this.autoBtn.active=!1,this.cancelAuto.active=!1,this.autoCloseBtn.active=!1},e.prototype.clearByGame=function(){this.autoBtn.active=!1,this.cancelAuto.active=!1,this.autoCloseBtn.active=!1},e.prototype.onAutoPlayClick=function(){s.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),this.setAutoPlayBtnShow(!1),Game.Server.send(this.Define.CmdAuto,{auto_play:1})},e.prototype.onCancelAutoClick=function(){s.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),this.setAutoPlayBtnShow(!0),Game.Server.send(this.Define.CmdAuto,{auto_play:0})},e.prototype.setAutoPlayBtnShow=function(t){this.autoBtn.active=!0,this.cancelAuto.active=!t,this.autoCloseBtn.active=!t},e}(o.default);i.default=l,cc._RF.pop()},{"../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","./ErmjBaseView":"ErmjBaseView"}],ErmjAskClockView:[function(t,e,i){"use strict";cc._RF.push(e,"58770d1l+lBZpH9dwXcMM+e","ErmjAskClockView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.running=!1,e.isClockAudio=!1,e.checkIntervalFrame=0,e.FrameInterval=2,e}return a(e,t),e.prototype.initView=function(){this.clockPro=this.getNodeComponent("clock",cc.ProgressBar),this.clockLbl=this.getNodeComponent("timeLbl",cc.RichText)},e.prototype.init=function(){this.initView()},Object.defineProperty(e.prototype,"active",{set:function(t){this.node.active=t},enumerable:!1,configurable:!0}),e.prototype.setSecondCall=function(t,e){this.secondCall=t,this.target=e},e.prototype.startTimer=function(t,e){void 0===e&&(e=0),this.stopTimer(),this.timeTotal=e||t,this.updateTimeLbl(Math.round(t/1e3)),this.timeEnd=t+Date.now(),this.checkIntervalFrame=0,this.running=!0},e.prototype.stopTimer=function(){this.timeEnd=0,this.timeLeft=-1,this.timeTotal=0,this.running=!1,this.checkIntervalFrame=0},e.prototype.updateTimeLbl=function(t){this.clockLbl.string="<b>"+String(t)},e.prototype.onUpdateTimer=function(){var t=Math.round((this.timeEnd-Date.now())/1e3);this.clockPro.progress=(this.timeEnd-Date.now())/this.timeTotal,t!=this.timeLeft&&(this.timeLeft=t,this.secondCall&&this.target&&this.isClockAudio&&this.secondCall.call(this.target,this.timeLeft),t>=0?this.updateTimeLbl(t):(this.stopTimer(),this.node.active=!1))},e.prototype.setViewActive=function(t){this.node.active=t},e.prototype.setClockAudioEnable=function(t){this.isClockAudio=t},e.prototype.setClockPosition=function(t){var e=this.node.parent.convertToNodeSpaceAR(t);this.node.setPosition(e)},e.prototype.onDisable=function(){this.clockPro.progress=1,this.stopTimer(),this.setClockAudioEnable(!1)},e.prototype.onDestroy=function(){this.stopTimer()},e.prototype.update=function(){this.running&&(this.checkIntervalFrame++,this.checkIntervalFrame>=this.FrameInterval&&(this.checkIntervalFrame=0,this.onUpdateTimer()))},e}(t("./ErmjBaseComponent").default);i.default=o,cc._RF.pop()},{"./ErmjBaseComponent":"ErmjBaseComponent"}],ErmjAskNoticeView:[function(t,e,i){"use strict";cc._RF.push(e,"889ecNRv1lJUIeShwSHdxvw","ErmjAskNoticeView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseView"),r=t("../data/ErmjGameConst"),s=t("../component/ErmjTimeAutoRun"),l=t("../data/ErmjPathHelper"),c=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.bgSp=this.getComponent("content/bgSp",cc.Sprite),this.oppNoticeSp=this.getComponent("content/oppNoticeSp",cc.Sprite),this.oppNoticeSp.node.active=!1,this.selfNoticeSp=this.getComponent("content/selfNoticeSp",cc.Sprite),this.selfNoticeSp.node.active=!1,this.timeRun=Global.UIHelper.safeGetComponent(this.getChild("content/timeLbl"),"",s.default),this.timeRun.node.active=!1},e.prototype.setChairLook=function(t){var e=r.default.askNoticeStrCfg[t],i=e[0],n=e[1],a=e[2];Global.ResourceManager.loadBundleAutoAtlas(r.default.Gid,this.bgSp,l.default.gameTexturePath+"dynamic/atlas_dynamic",i,null,!0),Global.ResourceManager.loadBundleAutoAtlas(r.default.Gid,this.selfNoticeSp,l.default.gameTexturePath+"dynamic/atlas_dynamic",n,null,!0),Global.ResourceManager.loadBundleAutoAtlas(r.default.Gid,this.oppNoticeSp,l.default.gameTexturePath+"dynamic/atlas_dynamic",a,null,!0),this.oppNoticeSp.node.active=!1,this.selfNoticeSp.node.active=!1},e.prototype.whichLocationTurn=function(t){0==t?(this.selfNoticeSp.node.active=!0,this.oppNoticeSp.node.active=!1,this.selfNoticeSp.node.stopAllActions(),this.selfNoticeSp.node.opacity=255,this.selfNoticeSp.node.runAction(cc.repeatForever(cc.sequence([cc.fadeTo(1,100),cc.fadeTo(1,255)])))):1==t&&(this.oppNoticeSp.node.active=!0,this.selfNoticeSp.node.active=!1,this.oppNoticeSp.node.stopAllActions(),this.oppNoticeSp.node.opacity=255,this.oppNoticeSp.node.runAction(cc.repeatForever(cc.sequence([cc.fadeTo(1,100),cc.fadeTo(1,255)]))))},e.prototype.setTimeRunConfig=function(t,e,i){this.timeRun.node.active=!0,this.timeRun.setTimer(t,e,i)},e.prototype.setTimerShow=function(t){this.timeRun.node.active=t},e.prototype.clearByRound=function(){this.timeRun.node.active=!1,this.selfNoticeSp.node.stopAllActions(),this.oppNoticeSp.node.stopAllActions(),this.selfNoticeSp.node.opacity=255,this.oppNoticeSp.node.opacity=255,this.active=!1},e}(o.default);i.default=c,cc._RF.pop()},{"../component/ErmjTimeAutoRun":"ErmjTimeAutoRun","../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","./ErmjBaseView":"ErmjBaseView"}],ErmjAutoHandler:[function(t,e,i){"use strict";cc._RF.push(e,"0d2ddQyNEdK47qa3o8bHkyR","ErmjAutoHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=this.SitHelper.serverSToLocalN(t._src),i=1==t._para.auto_play;this.mainUI.callPlayer(e,"showAutoSign",i),0==e&&(this.mainUI.askBtnView.setAutoPlayBtnShow(!i),this.mainUI.doResetMj(),this.context.isCmdAuto=i)},e.prototype.executeSync=function(t){this.execute(t)},e}(t("./ErmjBaseHandler").default);i.default=o,cc._RF.pop()},{"./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjBankerHandler:[function(t,e,i){"use strict";cc._RF.push(e,"ce291iJJhVPEaVJr3g2dyZ4","ErmjBankerHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=t._para.banker,i=this.SitHelper.serverSToLocalN(e);this.context.set(this.Define.FieldBankerSeat,i),this.mainUI.onBanker(i,t._para.dice,!0)},e.prototype.executeSync=function(t){var e=t._para.banker,i=this.SitHelper.serverSToLocalN(e);this.context.set(this.Define.FieldBankerSeat,i),this.mainUI.onBanker(i,t._para.dice,!1)},e}(t("./ErmjBaseHandler").default);i.default=o,cc._RF.pop()},{"./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjBaseComponent:[function(t,e,i){"use strict";cc._RF.push(e,"9b1bbskuWRKzYoLBC4/q/La","ErmjBaseComponent");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var a,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,i,r):a(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.getNodeComponent=function(t,e){return Global.UIHelper.getComponent(this.node,t,e)},e.prototype.getChild=function(t){return Global.UIHelper.getChild(this.node,t)},o([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],ErmjBaseHandler:[function(t,e,i){"use strict";cc._RF.push(e,"0278b2iieRKTakXXvSQK16I","ErmjBaseHandler"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../ErmjDriver"),a=function(){function t(){}return t.prototype.checkInQueue=function(){return!0},t.prototype.Handle=function(t){this.mainUI=n.default.instance.mainUI,this.context=n.default.instance.Context,this.Define=n.default.instance.Define,this.SitHelper=n.default.instance.SitHelper,this.Path=n.default.instance.Path,this.refreshData(t),this.context.syncMode?this.executeSync(t):this.execute(t)},t.prototype.refreshData=function(){},t.prototype.execute=function(){},t.prototype.executeSync=function(t){this.execute(t)},t}();i.default=a,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver"}],ErmjBasePool:[function(t,e,i){"use strict";cc._RF.push(e,"1cfe8HY2NRDLpEWhXXiTgKq","ErmjBasePool"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t){this.root=t,this.pool=[],this.preCreate()}return t.prototype.preCreate=function(){var t=this,e=0,i=function(){for(var n=0;n<t.everyCount;n++){var a=t.createItem();if(t.recycleItem(a),++e>=t.preCount){Game.Component.unschedule(i);break}}};Game.Component.schedule(i,.2)},Object.defineProperty(t.prototype,"preCount",{get:function(){return 30},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"everyCount",{get:function(){return 30},enumerable:!1,configurable:!0}),t.prototype.createItem=function(){return null},t.prototype.getItem=function(){return this.size>0?this.pool.pop():this.createItem()},t.prototype.getItemArr=function(t){for(var e=[],i=0;i<t;i++){var n=this.getItem();e.push(n)}return e},t.prototype.resetItem=function(){},t.prototype.recycleItem=function(t){this.resetItem(t),this.pool.push(t)},t.prototype.recycleAll=function(t){var e=this;t.forEach(function(t){e.recycleItem(t)})},t.prototype.resetPool=function(){this.pool=[]},Object.defineProperty(t.prototype,"size",{get:function(){return this.pool.length},enumerable:!1,configurable:!0}),t}();i.default=n,cc._RF.pop()},{}],ErmjBaseView:[function(t,e,i){"use strict";cc._RF.push(e,"e3092rL43NNzaEPgV4iUGfH","ErmjBaseView"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../ErmjDriver"),a=function(){function t(){this._active=!1,this.Path=n.default.instance.Path,this.Define=n.default.instance.Define,this.Context=n.default.instance.Context}return Object.defineProperty(t.prototype,"active",{get:function(){return this._active},set:function(t){t!=this._active&&(this._active=t,this.node.active=t,this._active?this.onOpen():this.onClose())},enumerable:!1,configurable:!0}),t.prototype.setActive=function(t){this._active=!t,this.active=t},t.prototype.setNode=function(t){this.node=t,null!=t&&cc.isValid(t)?(this._active=t,this.initView()):Logger.error("node == null || !cc.isValid(node)")},t.prototype.initView=function(){},t.prototype.onOpen=function(){},t.prototype.onClose=function(){},t.prototype.clearByGame=function(){this.clearByRound()},t.prototype.clearByRound=function(){},t.prototype.getComponent=function(t,e){return Global.UIHelper.getComponent(this.node,t,e)},t.prototype.getChild=function(t){return Global.UIHelper.getChild(this.node,t)},t}();i.default=a,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver"}],ErmjCallBlockHandler:[function(t,e,i){"use strict";cc._RF.push(e,"ae05dmH+UtAU75MJfLLuyye","ErmjCallBlockHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjCallOtherBlockHandler=i.ErmjCallSelfBlockHandler=void 0;var o=t("./ErmjBaseHandler"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){if(this.mainUI.callAllPlayers("showStateSp",!1),0==this.SitHelper.serverSToLocalN(t._src)){var e={isChow:1==t._para.can_chow,isPong:1==t._para.can_pong,isKong:1==t._para.can_kong,isWin:1==t._para.can_win};this.mainUI.askActionView.active=!0,this.mainUI.askActionView.showBtnByConfig(e,t._para)}var i=0,n=t._times;if(n&&Game.Component.correctTime){var a=Game.Component.correctTime(n);i=1e3*t._timeo-a}else i=1e3*t._timeo-(Date.now()-t._receiveTime);(!i||i<=0)&&(i=1e3),this.mainUI.askNoticeView.setTimeRunConfig(Math.round(i/1e3),null,null)},e}(o.default);i.ErmjCallSelfBlockHandler=r;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){if(this.mainUI.callAllPlayers("showStateSp",!1),0==this.SitHelper.serverSToLocalN(t._src)){var e={isChow:1==t._para.can_chow,isPong:1==t._para.can_pong,isKong:1==t._para.can_kong,isWin:1==t._para.can_win};this.mainUI.askActionView.active=!0,this.mainUI.askActionView.showBtnByConfig(e,t._para)}var i=0,n=t._times;if(n&&Game.Component.correctTime){var a=Game.Component.correctTime(n);i=1e3*t._timeo-a}else i=1e3*t._timeo-(Date.now()-t._receiveTime);(!i||i<=0)&&(i=1e3),this.mainUI.askNoticeView.setTimeRunConfig(Math.round(i/1e3),null,null)},e}(o.default);i.ErmjCallOtherBlockHandler=s,cc._RF.pop()},{"./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjChangeFlowerHandler:[function(t,e,i){"use strict";cc._RF.push(e,"2f178wjwJZEaJfWa/I/nHyU","ErmjChangeFlowerHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=this.SitHelper.serverSToLocalN(t._src),i=t._para.flowers||[],n=t._para.new_cards||[];this.mainUI.onChangeFlower(e,i,n,t._para.left_count)},e.prototype.executeSync=function(){},e}(t("./ErmjBaseHandler").default);i.default=o,cc._RF.pop()},{"./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjChatHandler:[function(t,e,i){"use strict";cc._RF.push(e,"0ccc632vx5A5JTGovxaC3iL","ErmjChatHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=t._para.ctype,i=this.SitHelper.serverSToLocalN(t._para.from_chair),n=t._para.emoji,a=this.SitHelper.serverSToLocalN(t._para.to_chair),o=this.mainUI.getPlayer(i),r=this.mainUI.getPlayer(a);if(o&&o.someone&&r&&r.someone)if(0==e);else if(1==e){var s=o.getPlayerHeadCenterPos(),l=r.getPlayerHeadCenterPos();this.mainUI.headTipsManager.playAct(n,s,l,a)}},e.prototype.checkInQueue=function(){return!1},e}(t("./ErmjBaseHandler").default);i.default=o,cc._RF.pop()},{"./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjContext:[function(t,e,i){"use strict";cc._RF.push(e,"479d7sNeS1JT5OzKoexLEuB","ErmjContext"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this.syncMode=!1,this.playerList=[],this.dataMap={},this.selfLocalSeat=0,this._isWaitMatch=!1,this._cmdAuto=!1}return t.prototype.set=function(t,e){this.dataMap[t]=e},t.prototype.get=function(t){return this.dataMap[t]},t.prototype.remove=function(t){this.dataMap[t]=null},t.prototype.getValue=function(t){var e=this.dataMap[t];return null==e?null:e},Object.defineProperty(t.prototype,"isWaitMatch",{get:function(){return this._isWaitMatch},set:function(t){this._isWaitMatch=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCmdAuto",{get:function(){return this._cmdAuto},set:function(t){this._cmdAuto=t},enumerable:!1,configurable:!0}),t.prototype.clearByRound=function(){this.dataMap={},this.syncMode=!1},t.prototype.clearByGame=function(){this.playerList=[],this.dataMap={},this.session=null,this.serverGameCfg=null,this.syncMode=!1,this._isWaitMatch=!1},t}();i.default=n,cc._RF.pop()},{}],ErmjDealHandler:[function(t,e,i){"use strict";cc._RF.push(e,"cab56woA1hLfJhDMwVCcPyr","ErmjDealHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=this,i=this.context.get(this.Define.FieldBankerSeat),n=t._para.user_cards||[],a={};n.forEach(function(t){var i=e.SitHelper.serverSToLocalN(t.chair);a[i]=t}),this.mainUI.onDeal(a,i,t._para.left_count)},e.prototype.executeSync=function(t){var e=this,i=t._para.user_cards||[],n={};i.forEach(function(t){var i=e.SitHelper.serverSToLocalN(t.chair);n[i]=t}),this.mainUI.onDealDirectly(n,t._para.left_count)},e}(t("./ErmjBaseHandler").default);i.default=o,cc._RF.pop()},{"./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjDefine:[function(t,e,i){"use strict";cc._RF.push(e,"f61d9a2fMdM4ICHqRmOpOCI","ErmjDefine"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){this.CmdGameCfg="a",this.CmdEnter="*en1*",this.CmdLeave="*lee*",this.CmdSession="*sss*",this.CmdRefresh="refresh",this.CmdOffline="*fo1*",this.CmdGameStart="*gs1*",this.CmdGameEnd="*gs2*",this.CmdCallReady="*cal_rel*",this.CmdWaitMatch="wait_match",this.CmdLeaveMatch="leave_match",this.CmdWait="wait",this.CmdBanker="banker",this.CmdDeal="deal",this.CmdChangeFlower="change_flower",this.CmdPlayStart="play_start",this.CmdDrawCard="draw_card",this.CmdCallSelfBlock="cal_self_block",this.CmdCallOtherBlock="cal_other_block",this.CmdWin="win",this.CmdKong="kong",this.CmdPong="pong",this.CmdChow="chow",this.CmdPass="pass",this.CmdCallTing="cal_ting",this.CmdTing="ting",this.CmdTingResult="ting_result",this.CmdCallPlay="cal_play",this.CmdPlay="play",this.CmdReward="reward",this.CmdSyncBegin="sync1",this.CmdSyncEnd="sync2",this.CmdSyncTable="table_data",this.CmdChat="chat",this.CmdAuto="*au1*",this.HandMjMaxCount=13,this.ChooseOffsetY=20,this.SelfHandMahjongSpace=cc.v3(77.2,0),this.LastOneDealOffset=[cc.v3(110,0),cc.v3(-50,0)],this.OperViewSpace=[cc.v3(-167,0),cc.v3(167,0)],this.flowerMjPerspArr=[-5,-4,-3,-2,-1,0,0,0],this.OutShowMjMaxCol=10,this.outMjPerspArr=[-4,-3,-2,-1,0,0,1,2,3,4],this.operMjGroupPerspArr=[9,8,7,6,5,4,3,2,1,0,0,0],this.operMjKongOffsetY=22,this.outMjShowTime=.3,this.outMjFlyTime=.2,this.winMjPerspArr=[5,6,7,8,9],this.winMoreOffsetY=22,this.winBrightMjPerspArr=[-5,-4,-3,-2,-1,0,0,0,0,0,1,2,3,4],this.winBrightLastOffsetX=10,this.HeadMoveTime=.2,this.FieldBankerSeat="FieldBankerSeat",this.FieldGameStart="FieldGameStart",this.FieldInSettle="FieldInSettle",this.FieldInPlayTurn="FieldInPlayTurn",this.FieldHandActionEnable="FieldHandActionEnable",this.FieldInTing="FieldInTing",this.FieldTingData="FieldTingData",this.ViewMatchPlayer="ViewMatchPlayer",this.ViewGameStart="ViewGameStart",this.ViewLightning="ViewLightning",this.ViewAskNotice="ViewAskNotice",this.ViewMjHill="ViewMjHill",this.ViewMenu="ViewMenu",this.ViewLeftTips="ViewLeftTips",this.ViewAskAction="ViewAskAction",this.ViewSelfPlay="ViewSelfPlay",this.ViewFlow="ViewFlow",this.ViewSettle="ViewSettle",this.ViewAskBtn="ViewAskBtn",this.ViewInteractAct="ViewInteractAct"},cc._RF.pop()},{}],ErmjDiceAnim:[function(t,e,i){"use strict";cc._RF.push(e,"d2911kDGIdDiJVn3YCIW3RP","ErmjDiceAnim");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var a,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,i,r):a(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dice1Sp=null,e.dice2Sp=null,e.diceSfArr=[],e}return a(e,t),e.prototype.onLoad=function(){this.effectSk=cc.find("effect",this.node).getComponent(sp.Skeleton),this.dice1Sp.node.active=!1,this.dice2Sp.node.active=!1},e.prototype.showDice=function(t,e){this.setDiceStyle(t),e?(this.dice1Sp.node.active=!1,this.dice2Sp.node.active=!1,this.effectSk.setAnimation(0,"idle",!1)):(this.dice1Sp.node.active=!0,this.dice2Sp.node.active=!0)},e.prototype.setDiceStyle=function(t){var e=this,i=t[0],n=t[1];this.dice1Sp.spriteFrame=this.diceSfArr[i-1],this.dice2Sp.spriteFrame=this.diceSfArr[n-1],this.scheduleOnce(function(){e.dice1Sp.node.active=!0,e.dice2Sp.node.active=!0},1)},e.prototype.onDisable=function(){this.unscheduleAllCallbacks(),this.effectSk.clearTracks()},o([l(cc.Sprite)],e.prototype,"dice1Sp",void 0),o([l(cc.Sprite)],e.prototype,"dice2Sp",void 0),o([l([cc.SpriteFrame])],e.prototype,"diceSfArr",void 0),o([s],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],ErmjDrawCardHandler:[function(t,e,i){"use strict";cc._RF.push(e,"fede4rRNTNHSpvnyhcdBO/d","ErmjDrawCardHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseHandler"),r=t("../data/ErmjRuleConst"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){this.mainUI.callAllPlayers("showStateSp",!1),this.mainUI.askActionView.active=!1;var e=this.SitHelper.serverSToLocalN(t._para.chair),i=t._para.cards||[],n=1==t._para.head_draw,a=this.context.get(this.Define.FieldTingData);if(a&&!Global.Toolkit.isEmptyObject(a)&&this.context.get(this.Define.FieldInTing)){var o=Global.Toolkit.getRoundInteger(10),s=r.default.checkAlmostWin(i[0],a)&&(o<=1||o>=9);this.mainUI.onDrawCard(e,i,n,t._para.left_count,s)}else this.mainUI.onDrawCard(e,i,n,t._para.left_count,!1)},e.prototype.executeSync=function(){},e}(o.default);i.default=s,cc._RF.pop()},{"../data/ErmjRuleConst":"ErmjRuleConst","./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjDriver:[function(t,e,i){"use strict";cc._RF.push(e,"ec04fn7llpIlbEZWG7OZVha","ErmjDriver");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var a,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,i,r):a(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(a,o){function r(t){try{l(n.next(t))}catch(e){o(e)}}function s(t){try{l(n.throw(t))}catch(e){o(e)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,s)}l((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var i,n,a,o,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return l([t,e])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){r.label=o[1];break}if(6===o[0]&&r.label<a[1]){r.label=a[1],a=o;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(o);break}a[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(s){o=[6,s],n=0}finally{i=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var l=t("./data/ErmjContext"),c=t("./data/ErmjDefine"),h=t("./data/ErmjPathHelper"),u=t("./data/ErmjGameConst"),p=t("./handlers/ErmjGameCfgHandler"),d=t("./handlers/ErmjEnterHandler"),f=t("./handlers/ErmjLeaveHandler"),m=t("./handlers/ErmjEasyHandler"),g=t("./handlers/ErmjSyncHandler"),j=t("./handlers/ErmjDealHandler"),y=t("./handlers/ErmjRewardHandler"),v=t("./handlers/ErmjDrawCardHandler"),w=t("./handlers/ErmjBankerHandler"),_=t("./handlers/ErmjChangeFlowerHandler"),S=t("./handlers/ErmjCallBlockHandler"),C=t("./handlers/ErmjPlayHandler"),E=t("./handlers/ErmjWinHandler"),P=t("./handlers/ErmjTingHandler"),b=t("./handlers/ErmjChatHandler"),M=t("./handlers/ErmjAutoHandler"),V=t("./component/ErmjLoadingUI"),L=cc._decorator,O=L.ccclass,H=L.property,A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defaultHeadKuang=null,e.inGame=!1,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){i.instance=this,this.inGame=!0,this.maskNode=cc.find("mask",this.node),this.maskNode.zIndex=9,this.loadingUI=Global.UIHelper.safeGetComponent(this.node,"loading",V.default),this.loadingUI.node.zIndex=8,this.setupGlobal(),this.setup(),u.default.playMusic(h.ErmjAudioConst.bgm,!0)},e.prototype.setupGlobal=function(){Global.Component.initDriver(),Game.Component.initDriver(),Global.UI.initUIRoot()},e.prototype.setup=function(){Game.Context=new l.default,this.Context=Game.Context,this.Define=new c.default,this.Path=new h.default,this.SitHelper=new PVPSitHelper,this.registHandler(this.Define)},e.prototype.start=function(){Game.Event.on(Game.EVENT_FORCE_LEAVE_GAME,this,this.onForceLeave),Game.Event.on(Game.EVENT_NOT_IN_TABLE,this,this.onForceLeave),Game.Event.on(Game.EVENT_SOCKET_RECONNECT,this,this.onSocketReconnect),Game.Event.on(Game.EVENT_SOCKET_RESUME,this,this.onResume),Game.Event.on(Game.EVENT_MATCH_PLAYER,this,this.onMatchPlayer)},e.prototype.onDestroy=function(){Game.Event.off(Game.EVENT_FORCE_LEAVE_GAME,this,this.onForceLeave),Game.Event.off(Game.EVENT_NOT_IN_TABLE,this,this.onForceLeave),Game.Event.off(Game.EVENT_SOCKET_RECONNECT,this,this.onSocketReconnect),Game.Event.off(Game.EVENT_SOCKET_RESUME,this,this.onResume),Game.Event.off(Game.EVENT_MATCH_PLAYER,this,this.onMatchPlayer),this.unscheduleAllCallbacks(),i.instance=null},e.prototype.LoadVipHeadKuang=function(t,e){var i="txkuang_vip"+e;Global.ResourceManager.loadBundleAutoAtlas("2101",t,"texture/headFrame/headFrame",i,null,!0)},e.prototype.registHandler=function(t){Game.Control.registDefaultHandler(),Game.Control.registHandler(t.CmdGameCfg,new p.default),Game.Control.registHandler(t.CmdEnter,new d.default),Game.Control.registHandler(t.CmdLeave,new f.default),Game.Control.registHandler(t.CmdLeaveMatch,new m.ErmjLeaveMatchHandler),Game.Control.registHandler(t.CmdRefresh,new m.ErmjRefreshHandler),Game.Control.registHandler(t.CmdOffline,new m.ErmjOfflineHandler),Game.Control.registHandler(t.CmdSyncEnd,new g.ErmjSyncEndHandler),Game.Control.registHandler(t.CmdSyncBegin,new g.ErmjSyncBeginHandler),Game.Control.registHandler(t.CmdSyncTable,new g.ErmjSyncRefreshHandler),Game.Control.registHandler(t.CmdCallReady,new m.ErmjReadyHandler),Game.Control.registHandler(t.CmdGameStart,new m.ErmjStartHandler),Game.Control.registHandler(t.CmdBanker,new w.default),Game.Control.registHandler(t.CmdDeal,new j.default),Game.Control.registHandler(t.CmdChangeFlower,new _.default),Game.Control.registHandler(t.CmdPlayStart,new C.ErmjPlayStartHandler),Game.Control.registHandler(t.CmdDrawCard,new v.default),Game.Control.registHandler(t.CmdCallPlay,new C.ErmjCallPlayHandler),Game.Control.registHandler(t.CmdPlay,new C.ErmjPlayHandler),Game.Control.registHandler(t.CmdChow,new C.ErmjChowHandler),Game.Control.registHandler(t.CmdPong,new C.ErmjPongHandler),Game.Control.registHandler(t.CmdKong,new C.ErmjKongHandler),Game.Control.registHandler(t.CmdCallTing,new P.ErmjCallTingHandler),Game.Control.registHandler(t.CmdTing,new P.ErmjTingHandler),Game.Control.registHandler(t.CmdTingResult,new P.ErmjTingResultHandler),Game.Control.registHandler(t.CmdCallSelfBlock,new S.ErmjCallSelfBlockHandler),Game.Control.registHandler(t.CmdCallOtherBlock,new S.ErmjCallOtherBlockHandler),Game.Control.registHandler(t.CmdWin,new E.default),Game.Control.registHandler(t.CmdReward,new y.default),Game.Control.registHandler(t.CmdGameEnd,new m.ErmjEndHandler),Game.Control.registHandler(t.CmdWait,new m.ErmjWaitHandler),Game.Control.registHandler(t.CmdChat,new b.default),Game.Control.registHandler(t.CmdAuto,new M.default)},e.prototype.onSocketReconnect=function(){this.mainUI&&(Global.Audio.stopAllEffect(),Game.Tween.clear(),Game.Component.unscheduleAllCallbacks(),this.mainUI.clearWnd(),this.Context.clearByGame())},e.prototype.onForceLeave=function(t){t?this.exitScene():this.leaveGame()},e.prototype.onResume=function(){},e.prototype.startScene=function(){this.mainUI.node.active=!1,this.reqEnterGame(u.default.Gid,Game.Control.curLv)},e.prototype.reqEnterGame=function(t,e,i){void 0===i&&(i="default"),Game.Control.connnectAndEnterGameInLevelScene(t,e,i,null)},e.prototype.enterGame=function(){if(this.mainUI.callAllPlayers("hide"),this.mainUI.clearByRound(),this.mainUI.clearByGame(),this.Context.clearByRound(),!this.mainUI.node.active){u.default.playMusic(h.ErmjAudioConst.bgm,!0);var t=Global.UIHelper.addIntoGameAnimComp(this.mainUI.node,this.loadingUI.node,[],[],[],[]);t.maskNode=this.maskNode,this.maskNode.opacity=1,this.maskNode.active=!0,this.mainUI.node.active=!0,t.startAnimtionByMask(1,0,null,null)}},e.prototype.leaveGame=function(){var t=this;Game.Tween.clear(),Game.Component.unscheduleAllCallbacks(),this.scheduleOnce(function(){t.exitScene()},.5)},e.prototype.exitScene=function(){this.inGame&&(this.inGame=!1,Game.Tween.clear(),Game.Component.unscheduleAllCallbacks(),this.mainUI&&(this.mainUI.clearWnd(),this.rulePop&&(this.rulePop.active=!1),this.settingPop&&(this.settingPop.active=!1)),this.Context.clearByGame(),Game.Control.shutDown(),Global.Toolkit.transmitHallWindow("WndGameLobbyShell",u.default.Gid),Game.GamePreloadTool.releaseKeepAsset(u.default.Gid,!0),Global.SceneManager.goToHall())},e.prototype.beginSync=function(){Game.Tween.clear(),Game.Component.unscheduleAllCallbacks(),this.mainUI.clearByGame()},e.prototype.reMatchPlayer=function(){if(this.Context.session&&this.Context.session._glv){this.stopGameConnect();var t=this.Context.session._glv;this.reqEnterGame(u.default.Gid,t)}else Game.Server.send(this.Define.CmdLeave,{IsClose:1}),this.leaveGame()},e.prototype.stopGameConnect=function(){Game.Server.stop(),Game.Server.clearDst(),Game.Server.clearData()},e.prototype.onMatchPlayer=function(t){if(this.inGame){this.enterGame(),this.Context.isWaitMatch=!0;for(var e=Global.GameData.getGameInfo(u.default.Gid),i=t._para._glv,n=e.levels,a=0;a<n.length;a++)if(n[a].level==i){this.mainUI.updateLevelBase(n[a].PointRate,i);break}var o=Math.ceil((1e3*t._timeo-Date.now()+t._receiveTime)/1e3);this.mainUI.showMatch(o)}},e.prototype.openSettingPop=function(){return r(this,void 0,void 0,function(){var t,e;return s(this,function(i){switch(i.label){case 0:return this.settingPop&&cc.isValid(this.settingPop)?(this.settingPop.active=!0,[3,3]):[3,1];case 1:return[4,Game.GamePreloadTool.preloadPrefab(Game.GamePreloadTool.settingPop,!0)];case 2:t=i.sent(),this.mainUI.node&&cc.isValid(this.mainUI.node)&&t&&cc.isValid(t)&&((e=cc.instantiate(t)).setParent(Global.UI.getLayer("PopLayer")),e.active=!0,this.settingPop=e),i.label=3;case 3:return[2]}})})},e.prototype.openRulePop=function(){return r(this,void 0,void 0,function(){var t,e;return s(this,function(i){switch(i.label){case 0:return this.rulePop&&cc.isValid(this.rulePop)?(this.rulePop.active=!0,[3,3]):[3,1];case 1:return[4,Game.GamePreloadTool.preloadPrefab(Game.GamePreloadTool.rulePop,!0)];case 2:t=i.sent(),this.mainUI.node&&cc.isValid(this.mainUI.node)&&t&&cc.isValid(t)&&((e=cc.instantiate(t)).setParent(Global.UI.getLayer("PopLayer")),e.active=!0,this.rulePop=e),i.label=3;case 3:return[2]}})})},e.instance=null,o([H(cc.SpriteFrame)],e.prototype,"defaultHeadKuang",void 0),i=o([O],e)}(cc.Component);i.default=A,cc._RF.pop()},{"./component/ErmjLoadingUI":"ErmjLoadingUI","./data/ErmjContext":"ErmjContext","./data/ErmjDefine":"ErmjDefine","./data/ErmjGameConst":"ErmjGameConst","./data/ErmjPathHelper":"ErmjPathHelper","./handlers/ErmjAutoHandler":"ErmjAutoHandler","./handlers/ErmjBankerHandler":"ErmjBankerHandler","./handlers/ErmjCallBlockHandler":"ErmjCallBlockHandler","./handlers/ErmjChangeFlowerHandler":"ErmjChangeFlowerHandler","./handlers/ErmjChatHandler":"ErmjChatHandler","./handlers/ErmjDealHandler":"ErmjDealHandler","./handlers/ErmjDrawCardHandler":"ErmjDrawCardHandler","./handlers/ErmjEasyHandler":"ErmjEasyHandler","./handlers/ErmjEnterHandler":"ErmjEnterHandler","./handlers/ErmjGameCfgHandler":"ErmjGameCfgHandler","./handlers/ErmjLeaveHandler":"ErmjLeaveHandler","./handlers/ErmjPlayHandler":"ErmjPlayHandler","./handlers/ErmjRewardHandler":"ErmjRewardHandler","./handlers/ErmjSyncHandler":"ErmjSyncHandler","./handlers/ErmjTingHandler":"ErmjTingHandler","./handlers/ErmjWinHandler":"ErmjWinHandler"}],ErmjEasyHandler:[function(t,e,i){"use strict";cc._RF.push(e,"8b4a7oj5OpPFoucGP/3SfdU","ErmjEasyHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjLeaveMatchHandler=i.ErmjOfflineHandler=i.ErmjRefreshHandler=i.ErmjWaitHandler=i.ErmjEndHandler=i.ErmjStartHandler=i.ErmjReadyHandler=void 0;var o=t("./ErmjBaseHandler"),r=t("../ErmjDriver"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(){this.context.isWaitMatch=!1,this.mainUI.matchPlayerView.active=!1},e.prototype.executeSync=function(t){this.execute(t)},e}(o.default);i.ErmjReadyHandler=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.refreshData=function(){this.context.set(this.Define.FieldGameStart,!0)},e.prototype.execute=function(){this.mainUI.askNoticeView.active=!0,this.mainUI.askNoticeView.setChairLook(this.context.selfSrc),this.context.isWaitMatch=!1,this.mainUI.matchPlayerView.active=!1,this.mainUI.callAllPlayers("setMatched",!0),this.mainUI.gameStartView.active=!0,Game.Event.event(Game.EVENT_ADDTIMELOCK,"ErmjStartHandler",1)},e.prototype.executeSync=function(){this.mainUI.askNoticeView.active=!0,this.mainUI.askNoticeView.setChairLook(this.context.selfSrc),this.mainUI.callAllPlayers("setMatched",!1)},e}(o.default);i.ErmjStartHandler=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.refreshData=function(){this.context.clearByRound()},e.prototype.execute=function(){Game.Tween.clear(),Game.Component.unscheduleAllCallbacks()},e}(o.default);i.ErmjEndHandler=c;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){1==t._para.status?Logger.log("\u7ed3\u7b97\u4e2d"):this.mainUI.matchPlayerView.active=!0},e}(o.default);i.ErmjWaitHandler=h;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.refreshData=function(t){var e=t._src,i=this.SitHelper.serverSToLocalN(e);null!=this.context.playerList[i]&&(this.context.playerList[i].refresh(t._para),i==this.context.selfLocalSeat&&(Global.PlayerData.point=this.context.playerList[i].point))},e.prototype.execute=function(t){var e=t._src,i=this.SitHelper.serverSToLocalN(e);null!=this.context.playerList[i]&&this.mainUI.callPlayer(i,"setPlayerPoint",this.context.playerList[i].point)},e}(o.default);i.ErmjRefreshHandler=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=t._src,i=this.SitHelper.serverSToLocalN(e);Logger.log(i,"-------\x3eoffline")},e}(o.default);i.ErmjOfflineHandler=p;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(){var t=this;this.mainUI.matchPlayerView.active=!1,this.context.isWaitMatch&&(this.context.isWaitMatch=!1,Global.UI.showYesNoBox("\u5339\u914d\u8d85\u65f6\uff0c\u662f\u5426\u91cd\u65b0\u5339\u914d\uff1f",function(){Game.Control.trySendEnter({_from:"jump"})},function(){Game.Server.send(t.Define.CmdLeave,{IsClose:1}),r.default.instance.leaveGame()}))},e}(o.default);i.ErmjLeaveMatchHandler=d,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjEnterHandler:[function(t,e,i){"use strict";cc._RF.push(e,"1b79bOXzlVN/oM2HTWvIlua","ErmjEnterHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseHandler"),r=t("../data/ErmjGameConst"),s=t("../data/ErmjPathHelper"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.refreshData=function(t){var e=t._src;if(this.context.selfSrc==e){var i=this.SitHelper.serverSeatStrToNum(e);this.SitHelper.init(i,r.default.maxPlayerCount,r.default.localToViewMap),this.context.set(this.Define.FieldInSettle,!1)}var n=this.SitHelper.serverSToLocalN(e);null!=this.context.playerList[n]?this.context.playerList[n].setInfo(t._para):Logger.error("\u670d\u52a1\u5668\u5f02\u5e38",n)},e.prototype.execute=function(t){var e=t._src,i=this.SitHelper.serverSToLocalN(e);this.mainUI.callPlayer(i,"show",this.context.playerList[i]),r.default.playSound(s.ErmjAudioConst.commonAudio.SeatDown,!0),Game.Event.event(Game.EVENT_ADDTIMELOCK,"ErmjEnterHandler",.1)},e}(o.default);i.default=l,cc._RF.pop()},{"../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjFlowView:[function(t,e,i){"use strict";cc._RF.push(e,"e3bd6L+N2NDsZ3qtpdd961g","ErmjFlowView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseView"),r=t("../data/ErmjPathHelper"),s=t("../data/ErmjGameConst"),l=t("../ErmjDriver"),c=function(t){function e(e){var i=t.call(this)||this;return i.clickLimit=!1,i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.actionNode=this.getChild("action"),s.default.addCommonClick(this.node,"action/continueBtn",this.onContinueClick,this),s.default.addCommonClick(this.node,"action/leaveBtn",this.onLeaveClick,this),this.effectSk=this.getComponent("content/effect",sp.Skeleton)},e.prototype.onOpen=function(){this.clickLimit=!1,this.effectSk.node.active=!0,this.effectSk.setAnimation(0,"idle",!1),this.actionNode.active=!1,s.default.playSound(r.ErmjAudioConst.commonAudio.RewardLose,!0),this.delayShowActionBtn(8e3)},e.prototype.delayShowActionBtn=function(t){var e=this;this.timer=setTimeout(function(){e.showActionBtn(!0)},t)},e.prototype.showActionBtn=function(t){this.actionNode.active=t,clearTimeout(this.timer)},e.prototype.onClose=function(){this.effectSk.node.active=!1,this.effectSk.clearTracks(),clearTimeout(this.timer)},e.prototype.onContinueClick=function(){var t=this;s.default.playSound(r.ErmjAudioConst.commonAudio.ContinueGame,!0),this.clickLimit||(l.default.instance.reMatchPlayer(),this.clickLimit=!0,Game.Component.scheduleOnce(function(){t.clickLimit=!1},3))},e.prototype.onLeaveClick=function(){s.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),Game.Server.send(this.Define.CmdLeave,{IsClose:1}),l.default.instance.leaveGame()},e.prototype.clearByRound=function(){this.active=!1},e}(o.default);i.default=c,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","./ErmjBaseView":"ErmjBaseView"}],ErmjGameCfgHandler:[function(t,e,i){"use strict";cc._RF.push(e,"c7278pIYONEXbTuQUXLILQ1","ErmjGameCfgHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseHandler"),r=t("../data/ErmjGameConst"),s=t("../ErmjDriver"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.refreshData=function(t){if(this.context.serverGameCfg=t._para,this.context.playerList=[],r.default.maxPlayerCount<t._para.seat_count)Logger.error("\u5ba2\u6237\u7aef\u4e0d\u652f\u6301\u670d\u52a1\u5668\u914d\u7f6e\u7684\u6700\u5927\u4eba\u6570",r.default.maxPlayerCount,String(t._para.seat_count));else for(var e=0;e<r.default.maxPlayerCount;e++)this.context.playerList.push(new PVPPlayerData(e))},e.prototype.execute=function(t){var e="l0";this.context.session&&this.context.session._glv&&(e=this.context.session._glv),this.mainUI.updateLevelBase(t._para.base_point,e),s.default.instance.enterGame(),s.default.instance.mainUI.taskManager.reqGetCommisionInfo()},e.prototype.executeSync=function(t){this.execute(t)},e}(o.default);i.default=l,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","../data/ErmjGameConst":"ErmjGameConst","./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjGameConst:[function(t,e,i){"use strict";var n,a;cc._RF.push(e,"c68b2HAEVRKJpoJ4uW7L9mq","ErmjGameConst"),Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjMjActState=i.ErmjLocation=void 0,function(t){t[t.South=1]="South",t[t.North=2]="North"}(a=i.ErmjLocation||(i.ErmjLocation={})),function(t){t[t.Disable=0]="Disable",t[t.Deal=1]="Deal",t[t.Change=2]="Change",t[t.Play=3]="Play"}(i.ErmjMjActState||(i.ErmjMjActState={}));var o=function(){function t(){}return t.playMusic=function(e){Global.Audio.playBundleMusic(t.Gid,e)},t.playSound=function(e){Global.Audio.playBundleSound(t.Gid,e)},t.addCommonClick=function(t,e,i,n,a,o){return void 0===a&&(a=cc.Button.Transition.SCALE),void 0===o&&(o=!1),Global.UIHelper.addCommonClick(t,e,i,n,a,null,o)},t.Gid=2101,t.mahjongTotal=72,t.mahjongWall=2,t.maxPlayerCount=2,t.localToViewMap={},t.LevelSpCfg={l0:"changci_01",l1:"changci_02",l2:"changci_03"},t.StateSpStrCfg={Chow:"chi",Pong:"peng",Win:"dianpao",Kong:"gang",WinAll:"zimo",Ting:"ting",RobWin:"qianggang"},t.askNoticeStrCfg=((n={})[a.South]=["daojishi","xuanzhong_hong","xuanzhong_lan"],n[a.North]=["daojishi_01","xuanzhong_lan_01","xuanzhong_hong_01"],n),t}();i.default=o,cc._RF.pop()},{}],ErmjGameEvent:[function(t,e,i){"use strict";cc._RF.push(e,"041f63UB6lAV7zizMVrG4iP","ErmjGameEvent"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.doPatchwork="ErmjGameEvent.doPatchwork",t.doTingCallPlay="ErmjGameEvent.doTingCallPlay",t.onUserInfoTouch="ErmjGameEvent.onUserInfoTouch",t}();i.default=n,cc._RF.pop()},{}],ErmjGameStartView:[function(t,e,i){"use strict";cc._RF.push(e,"6d7f0Ydm1FDv6YFqz31QRpq","ErmjGameStartView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.effectSk=this.getComponent("content/effect",sp.Skeleton)},e.prototype.showAnim=function(){var t=this;this.effectSk.node.active=!0,this.effectSk.setAnimation(0,"idle",!1),Game.Component.scheduleOnce(function(){t.active=!1},1)},e.prototype.onOpen=function(){this.showAnim()},e.prototype.onClose=function(){this.effectSk.node.active=!1,this.effectSk.clearTracks()},e.prototype.clearByRound=function(){this.active=!1},e}(t("./ErmjBaseView").default);i.default=o,cc._RF.pop()},{"./ErmjBaseView":"ErmjBaseView"}],ErmjLeaveHandler:[function(t,e,i){"use strict";cc._RF.push(e,"bc4f4WulkVAgr4dE8rAWFj7","ErmjLeaveHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseHandler"),r=t("../ErmjDriver"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.refreshData=function(t){var e=this.SitHelper.serverSToLocalN(t._src);this.context.playerList[e]?(Logger.error("leave",e,t._src),this.context.playerList[e].clear()):Logger.error("leave error")},e.prototype.execute=function(t){var e=this.SitHelper.serverSToLocalN(t._src);if(Game.Event.event(Game.EVENT_ADDTIMELOCK,"ErmjLeaveHandler",this.Define.HeadMoveTime+.1),t._src==this.context.selfSrc)t._para&&t._para.Reason&&103==t._para.Reason._reason?(Game.Server.clearData(),Game.Tween.clear(),Global.HallServer.setSession(null),(t._para&&t._para.GameTimes||0)>0?(Game.Server.stopGame(),this.mainUI.settleView.showActionBtn(!0),this.mainUI.flowView.showActionBtn(!0)):(this.mainUI.flowView.showActionBtn(!1),this.mainUI.settleView.showActionBtn(!1),this.mainUI.matchPlayerView.active=!1,Game.Server.clearDst(),Game.Control.trySendEnter({_from:"jump"}))):(this.mainUI.callPlayer(e,"hide"),t._para&&t._para.Reason&&102==t._para.Reason._reason?Global.Toolkit.transmitHallMsg("\u91d1\u5e01\u4e0d\u591f\u5566\uff0c\u662f\u5426\u524d\u5f80\u5145\u503c\uff1f",function(){Global.UI.show("WndRecharge")}):t._para&&t._para.Reason&&t._para.Reason._explain&&Global.Toolkit.transmitHallMsg(t._para.Reason._explain,null,null,1),r.default.instance.leaveGame());else{if(this.context.get(this.Define.FieldInSettle))return;t._para&&t._para.Reason&&(103==t._para.Reason._reason||105==t._para.Reason._reason)||this.mainUI.callPlayer(e,"hide")}},e.prototype.checkInQueue=function(t){return t._src!=Game.Context.selfSrc||!(!t._para||!t._para.Reason||102!=t._para.Reason._reason&&103!=t._para.Reason._reason&&20!=t._para.Reason._reason)&&(103==t._para.Reason._reason&&Game.Server.stopHeartBeat&&Game.Server.stopHeartBeat(),!0)},e}(o.default);i.default=s,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjLeftTipsView:[function(t,e,i){"use strict";cc._RF.push(e,"b3f42vHoyxJz5S3PDx6ulxZ","ErmjLeftTipsView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(e){var i=t.call(this)||this;return i.nLeftCount=0,i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.leftLbl=this.getComponent("leftLbl",cc.Label),this.leftLbl.string=""},e.prototype.updateLeftLbl=function(t){this.nLeftCount=t,this.leftLbl.string=String(t)},e.prototype.reduceLeftLbl=function(t){this.updateLeftLbl(this.nLeftCount-t)},e.prototype.clearByRound=function(){this.leftLbl.string="0",this.active=!1},e}(t("./ErmjBaseView").default);i.default=o,cc._RF.pop()},{"./ErmjBaseView":"ErmjBaseView"}],ErmjLoadingUI:[function(t,e,i){"use strict";cc._RF.push(e,"5ec727toKJOdpfjhG6pnMNS","ErmjLoadingUI");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var a,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,i,r):a(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(a,o){function r(t){try{l(n.next(t))}catch(e){o(e)}}function s(t){try{l(n.throw(t))}catch(e){o(e)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,s)}l((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var i,n,a,o,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return l([t,e])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){r.label=o[1];break}if(6===o[0]&&r.label<a[1]){r.label=a[1],a=o;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(o);break}a[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(s){o=[6,s],n=0}finally{i=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var l=t("../panel/ErmjMainUI"),c=t("../data/ErmjPathHelper"),h=t("../data/ErmjGameConst"),u=t("../ErmjDriver"),p=cc._decorator,d=p.ccclass,f=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dependAtlas=[c.default.gameTexturePath+"dynamic/atlas_dynamic",c.default.gameTexturePath+"mahjong/atlas_mahjong",c.default.gameTexturePath+"type/atlas_type"],e.dependceArr=[c.default.gamePrefabsPath+"panel/ErmjMainUI",c.default.gamePrefabsPath+"panel/mahjong/mahjongHillView",c.default.gamePrefabsPath+"panel/mahjong/mahjongOutView",c.default.gamePrefabsPath+"panel/mahjong/mahjongOperView",c.default.gamePrefabsPath+"panel/subView/matchPlayerView",c.default.gamePrefabsPath+"panel/subView/gameStartView"],e.dependceArr2=[c.default.gamePrefabsPath+"panel/subView/diceAnim",c.default.gamePrefabsPath+"panel/subView/rubMjAnim",c.default.gamePrefabsPath+"panel/subView/askActionView",c.default.gamePrefabsPath+"panel/subView/askNoticeView",c.default.gamePrefabsPath+"panel/subView/selfPlayView",c.default.gamePrefabsPath+"panel/subView/flowView",c.default.gamePrefabsPath+"panel/subView/settleView",c.default.gamePrefabsPath+"panel/subView/winLightningView",c.default.gamePrefabsPath+"panel/subView/autoBtnVIew"],e}return a(e,t),e.prototype.onLoad=function(){this.loadingContent=cc.find("content",this.node),this.loadingContent.active=!1},e.prototype.start=function(){this.initLoading(),this.preloadRes()},e.prototype.initLoading=function(){return r(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return!Global.GameData.checkHasCustomLoading||Global.GameData.checkHasCustomLoading(h.default.Gid)?[3,2]:[4,Global.UIHelper.getGameLoadingComp()];case 1:return t=e.sent(),this.loadingContent.active=!1,t.node.setParent(this.node),t.node.active=!0,[3,3];case 2:this.loadingContent.active=!0,e.label=3;case 3:return[2]}})})},e.prototype.preloadRes=function(){return r(this,void 0,void 0,function(){var t,e,i,n=this;return s(this,function(a){switch(a.label){case 0:return t=function(){return new Promise(function(t,e){Global.ResourceManager.loadBundleRes(h.default.Gid,n.dependAtlas,function(i,n){i?e(i):t(n)},cc.SpriteAtlas)})},e=function(){return new Promise(function(t,e){Global.ResourceManager.loadBundleRes(h.default.Gid,n.dependceArr,function(i,n){i?e(i):t(n)},null)})},i=function(){return new Promise(function(t,e){Global.ResourceManager.loadBundleRes(h.default.Gid,n.dependceArr2,function(i,n){i?e(i):t(n)},null)})},[4,HeadTipsManager.preloadRes()];case 1:return a.sent(),[4,TaskManager.preloadRes()];case 2:return a.sent(),[4,t()];case 3:return a.sent(),[4,e()];case 4:return a.sent(),[4,i()];case 5:return a.sent(),this.node&&cc.isValid(this.node)&&u.default.instance.inGame?(this.initUI(),Game.Component.scheduleOnce(function(){u.default.instance.startScene()},.5),[2]):[2]}})})},e.prototype.initUI=function(){var t=cc.Canvas.instance.node,e=Global.UI.getLayer("FullScreenLayer")||t,i=(Global.UI.getLayer("PopLayer"),this.getUINode(c.default.gamePrefabsPath+"panel/ErmjMainUI"));u.default.instance.mainUI=i.getComponent(l.default),e.addChild(i),i.active=!1},e.prototype.getUINode=function(t){var e=Global.ResourceManager.getBundleRes(h.default.Gid,t,cc.Prefab);return null==e?(Logger.error("\u83b7\u53d6\u9884\u8bbe\u5931\u8d25",t),null):cc.instantiate(e)},o([d],e)}(cc.Component));i.default=f,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","../panel/ErmjMainUI":"ErmjMainUI"}],ErmjMahjongHandView:[function(t,e,i){"use strict";cc._RF.push(e,"62a9bH/0rVJVrT796u68hfc","ErmjMahjongHandView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../ErmjBaseView"),r=t("../../data/ErmjPathHelper"),s=t("../../tool/ErmjMjStyleHelper"),l=t("../../data/ErmjGameConst"),c=function(t){function e(e){var i=t.call(this)||this;return i._isSelect=!1,i.rawPos=cc.Vec3.ZERO,i._isOut=!1,i._sortIndex=0,i.isTouchEnable=!0,i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.frontBg=this.getChild("bg"),this.frontSp=this.getComponent("front",cc.Sprite),this.backBg=this.getChild("back"),this.selectSign=this.getChild("selectSign"),this.selectSign.active=!1},Object.defineProperty(e.prototype,"isSelect",{get:function(){return this._isSelect},set:function(t){this._isSelect=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOut",{get:function(){return this._isOut},set:function(t){this._isOut=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortIndex",{get:function(){return this._sortIndex},set:function(t){this._sortIndex=t,this.node.setSiblingIndex(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mahjongValue",{get:function(){return this._value},set:function(t){this._value!=t&&(this._value=t,Global.ResourceManager.loadBundleAutoAtlas(l.default.Gid,this.frontSp,r.default.gameTexturePath+"mahjong/atlas_mahjong",s.default.mjHandMap[t],null,!0),cc.sys.isBrowser&&(this.node.name=String(t)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFront",{set:function(t){this.frontBg.active=t,this.frontSp.node.active=t,this.backBg.active=!t},enumerable:!1,configurable:!0}),e.prototype.setTouchEnable=function(t){Global.UIHelper.setNodeGray(this.node,!t),this.isTouchEnable=t},e.prototype.setSpecialColor=function(t){this.frontBg.color=t&&s.default.SpecialBgColor||s.default.NormalBgColor},e.prototype.rememberRawPos=function(){this.rawPos=this.node.position},e.prototype.onSelect=function(t){void 0===t&&(t=!1),this.isSelect=!this.isSelect,this.isSelect?(this.rememberRawPos(),this.node.setPosition(cc.v2(this.rawPos.x,this.rawPos.y+this.Define.ChooseOffsetY))):this.node.setPosition(this.rawPos)},e.prototype.resetSelect=function(){this.node.setPosition(this.rawPos),this.isSelect=!1},e.prototype.doMove=function(t,e,i,n,a,o){void 0===e&&(e=1),void 0===i&&(i=0),void 0===a&&(a=!1),void 0===o&&(o=cc.easeIn(1)),Game.Tween.get(this.node).delay(i).call(function(){}).to(e,{position:t},o).call(n).start()},e.prototype.doChangeFlower=function(t,e,i){var n=this;void 0===i&&(i=0);var a=this.getRealSize(),o=(a[0],a[1]),r=Game.Tween.get(this.node);this.node.opacity=255,r.by(e,{position:cc.v3(0,o),opacity:-254},cc.easeIn(1)).call(function(){t>0&&(n.mahjongValue=t)}).delay(i).by(e,{position:cc.v3(0,-o),opacity:254},cc.easeOut(1)).start()},e.prototype.doDraw=function(t,e){var i=Game.Tween.get(this.node);this.node.setPosition(t.add(cc.v3(0,60))),this.node.opacity=50,this.node.angle=30,i.to(e,{position:t,opacity:255,angle:0},cc.easeIn(1)).start()},e.prototype.getRawPos=function(){return this.rawPos},e.prototype.getWorldPos=function(){return this.node.parent.convertToWorldSpaceAR(this.node.position)},e.prototype.checkIsTouch=function(t){return this.node.getBoundingBoxToWorld().contains(t)},e.prototype.getRealSize=function(){return[this.node.width*this.node.scaleX,this.node.height*this.node.scaleY]},e.prototype.checkMjValid=function(){return this.isTouchEnable&&this.node.activeInHierarchy&&this.node.active},e.prototype.getSelectSignWorldPos=function(){return this.selectSign.parent.convertToWorldSpaceAR(this.selectSign.position)},e.prototype.reset=function(){this.node.opacity=255,this.node.angle=0,this.isSelect=!1,this.isFront=!1,this.isOut=!1,this.setTouchEnable(!0)},e}(o.default);i.default=c,cc._RF.pop()},{"../../data/ErmjGameConst":"ErmjGameConst","../../data/ErmjPathHelper":"ErmjPathHelper","../../tool/ErmjMjStyleHelper":"ErmjMjStyleHelper","../ErmjBaseView":"ErmjBaseView"}],ErmjMahjongHillView:[function(t,e,i){"use strict";cc._RF.push(e,"8d0a9wLRs5Ffo2ZxXca/SL6","ErmjMahjongHillView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../ErmjBaseView"),r=t("../../data/ErmjGameConst"),s=function(t){function e(e){var i=t.call(this)||this;return i.wallList=[],i.forwardOffset=0,i.startIndex=0,i.backOffset=0,i.backJump=-1,i.isFinish=!1,i.setNode(e),i}return a(e,t),e.prototype.initView=function(){for(var t=0;t<r.default.mahjongWall;t++){var e=this.getChild("wall_"+t.toString()),i=new l(e,1==t);i.active=!0,this.wallList.push(i)}},e.prototype.initWallDeal=function(t,e){var i=e+(r.default.mahjongWall-t)%r.default.mahjongWall*(r.default.mahjongTotal/r.default.mahjongWall);this.startIndex=i,this.forwardOffset=0,this.backOffset=0,this.backJump=-1,this.isFinish=!1,this.wallList.forEach(function(t){t.showAll(!0)})},e.prototype.doDeal=function(t){var e;if(void 0===t&&(t=1),this.isFinish)return console.error("doDeal error, \u9ebb\u5c06\u5df2\u7ecf\u53d1\u5b8c\u5566",this.forwardOffset,this.backOffset);for(var i=this.getForwardCurIndex(this.forwardOffset+1),n=0;n<t;n++){var a=this.getForwardCurIndex(this.forwardOffset),o=this.calculateIndex(a),r=o[0],s=o[1];if(this.backJump==i&&(this.forwardOffset++,a=this.getForwardCurIndex(this.forwardOffset),r=(e=this.calculateIndex(a))[0],s=e[1]),this.wallList[r].dealNextCount(s),this.forwardOffset++,this.getFinishLeft()<=0){this.isFinish=!0;break}}},e.prototype.doPatchwork=function(t){var e;if(void 0===t&&(t=1),this.isFinish)return console.error("doPatchwork error, \u9ebb\u5c06\u5df2\u7ecf\u53d1\u5b8c\u5566",this.forwardOffset,this.backOffset);for(var i=this.getForwardCurIndex(this.forwardOffset),n=0;n<t;n++){this.backOffset--;var a=this.getBackCurIndex(this.backOffset),o=a[0],r=a[1];this.backJump=r,r==i&&(this.backOffset--,o=(e=this.getBackCurIndex(this.backOffset))[0],r=e[1],this.backJump=r);var s=this.calculateIndex(o),l=s[0],c=s[1];if(this.wallList[l].dealNextCount(c),this.getFinishLeft()<=0){this.isFinish=!0;break}}},e.prototype.calculateIndex=function(t){var e=r.default.mahjongTotal/r.default.mahjongWall;return[Math.floor(t/e),t%e]},e.prototype.getForwardCurIndex=function(t){return(this.startIndex+t+r.default.mahjongTotal)%r.default.mahjongTotal},e.prototype.getBackCurIndex=function(t){var e=(this.startIndex+t+r.default.mahjongTotal)%r.default.mahjongTotal,i=-1;return e%2==0?(i=-1,e+=1):(i=e,e-=1),[(e+r.default.mahjongTotal)%r.default.mahjongTotal,i]},e.prototype.getFinishLeft=function(){return r.default.mahjongTotal-this.forwardOffset+this.backOffset},e.prototype.clearByRound=function(){this.active=!1},e}(o.default);i.default=s;var l=function(t){function e(e,i){var n=t.call(this)||this;return n.isInverse=i,n.mahjongNodeList=[],n.mjCount=r.default.mahjongTotal/r.default.mahjongWall,n.setNode(e),n}return a(e,t),e.prototype.initView=function(){for(var t=0;t<this.mjCount;t++){var e=this.getChild("majiang"+t.toString());this.mahjongNodeList.push(e)}},e.prototype.dealNextCount=function(t,e){void 0===e&&(e=1);for(var i=t;i<t+e;i++){var n=this.getLocalIndex(i);this.mahjongNodeList[n]&&(this.mahjongNodeList[n].active=!1)}},e.prototype.showAll=function(t){this.mahjongNodeList.forEach(function(e){e.active=t})},e.prototype.getLocalIndex=function(t){return this.isInverse?t%2==0?this.mjCount-t-2:this.mjCount-t:t},e}(o.default);cc._RF.pop()},{"../../data/ErmjGameConst":"ErmjGameConst","../ErmjBaseView":"ErmjBaseView"}],ErmjMahjongOperView:[function(t,e,i){"use strict";cc._RF.push(e,"c34fcKtG3JOZ5PKnaGXum2y","ErmjMahjongOperView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.OperState=void 0;var o,r=t("../ErmjBaseView"),s=t("./ErmjMahjongOutView"),l=t("../../tool/ErmjMjStyleHelper");(function(t){t[t.Chow=1]="Chow",t[t.Pong=2]="Pong",t[t.Kong=3]="Kong",t[t.DarkKong=4]="DarkKong"})(o=i.OperState||(i.OperState={}));var c=function(t){function e(e,i){var n=t.call(this)||this;return n.nRelative=i,n.mjOutItemList=[],n.setNode(e),n}return a(e,t),e.prototype.initView=function(){for(var t=0;t<4;t++){var e=this.getChild("mahjongOutView"+t.toString()),i=new s.default(e);i.active=!1,this.mjOutItemList.push(i)}},e.prototype.setChowStyle=function(t,e,i){this.state=o.Chow;for(var n=t[0],a=cc.Vec3.ZERO,r=i.length,s=0;s<this.mjOutItemList.length;s++){var c=t[s],h=this.mjOutItemList[s];if(c){h.active=!0,h.mahjongValue=c,h.isFront=!0,h.setSpecialColor(e==c);var u=i[r-s-1]||0,p=l.default.getPerspectiveCfg(u),d=p.cfg,f=p.dir;h.setPerspStyle(u,this.nRelative),h.node.setPosition(a);var m=f>0?d.devSpaceX:d.negDevSpaceX,g=0==this.nRelative?m:-m;a=a.add(cc.v3(g,0))}else h.active=!1;c<n&&(n=c)}this.value=n},e.prototype.setPongStyle=function(t,e){this.state=o.Pong;for(var i=cc.Vec3.ZERO,n=e.length,a=0;a<this.mjOutItemList.length;a++){var r=t[a],s=this.mjOutItemList[a];if(r){s.active=!0,s.mahjongValue=r,s.isFront=!0,s.setSpecialColor(1==a);var c=e[n-a-1]||0,h=l.default.getPerspectiveCfg(c),u=h.cfg,p=h.dir;s.setPerspStyle(c,this.nRelative),s.node.setPosition(i);var d=p>0?u.devSpaceX:u.negDevSpaceX,f=0==this.nRelative?d:-d;i=i.add(cc.v3(f,0))}else s.active=!1}this.value=t[0]},e.prototype.setKongStyle=function(t,e,i,n){e?(this.state=o.Kong,this.value=t[0]):this.state=o.DarkKong;for(var a=cc.Vec3.ZERO,r=cc.Vec3.ZERO,s=n.length,c=0;c<this.mjOutItemList.length;c++){var h=t[c],u=this.mjOutItemList[c];if(e&&h?(u.active=!0,u.mahjongValue=h,u.isFront=!0,u.setSpecialColor(c==this.mjOutItemList.length-1)):(u.active=!0,i&&c==this.mjOutItemList.length-1?(u.isFront=!0,u.mahjongValue=h,u.setSpecialColor(!1)):u.isFront=!1),c==this.mjOutItemList.length-1){var p=n[1]||0;u.setPerspStyle(p,this.nRelative),u.node.setPosition(r)}else{p=n[s-c-1]||0;var d=l.default.getPerspectiveCfg(p),f=d.cfg,m=d.dir;u.setPerspStyle(p,this.nRelative),u.node.setPosition(a),1==c&&(r=cc.v3(a.x,a.y+this.Define.operMjKongOffsetY));var g=m>0?f.devSpaceX:f.negDevSpaceX,j=0==this.nRelative?g:-g;a=a.add(cc.v3(j,0))}}},e.prototype.beKongRobbed=function(){this.mjOutItemList[this.mjOutItemList.length-1].active=!1,this.mjOutItemList[this.mjOutItemList.length-3].setSpecialColor(!0),this.state=o.Pong},e.prototype.checkPongValid=function(){return this.state==o.Pong&&this.value>0},e.prototype.checkKongValid=function(){return this.state==o.Kong&&this.value>0},e.prototype.checkDarkKongValid=function(){return this.state==o.DarkKong},e.prototype.onClose=function(){this.state=-1,this.value=0,this.mjOutItemList.forEach(function(t){t.active=!1})},e}(r.default);i.default=c,cc._RF.pop()},{"../../tool/ErmjMjStyleHelper":"ErmjMjStyleHelper","../ErmjBaseView":"ErmjBaseView","./ErmjMahjongOutView":"ErmjMahjongOutView"}],ErmjMahjongOutView:[function(t,e,i){"use strict";cc._RF.push(e,"59d2azgb0xMYa3FSsSURgaY","ErmjMahjongOutView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../ErmjBaseView"),r=t("../../data/ErmjPathHelper"),s=t("../../tool/ErmjMjStyleHelper"),l=t("../../data/ErmjGameConst"),c=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.frontBg=this.getComponent("bg",cc.Sprite),this.frontSp=this.getComponent("front",cc.Sprite),this.backBg=this.getComponent("back",cc.Sprite),this.attentionPoint=this.getChild("attention")},Object.defineProperty(e.prototype,"mahjongValue",{get:function(){return this._value},set:function(t){this._value!=t&&(this._value=t,Global.ResourceManager.loadBundleAutoAtlas(l.default.Gid,this.frontSp,r.default.gameTexturePath+"mahjong/atlas_mahjong",s.default.mjOutMap[t],null,!0),cc.sys.isBrowser&&(this.node.name=String(t)))},enumerable:!1,configurable:!0}),e.prototype.setPerspStyle=function(t,e){this.node.angle=0,this.node.skewX=0;var i=s.default.getPerspectiveCfg(t),n=i.cfg,a=i.dir,o=s.default.mjOutStyle[e];this.frontSp.node.angle=-o.frontAngle,this.frontSp.node.skewX=n.frontSkewX*a*o.perspScale,this.frontBg.node.scaleX=a*o.perspScale,this.backBg.node.scaleX=a*o.perspScale,Global.ResourceManager.loadBundleAutoAtlas(l.default.Gid,this.frontBg,r.default.gameTexturePath+"mahjong/atlas_mahjong",n.bgSp,null,!0),Global.ResourceManager.loadBundleAutoAtlas(l.default.Gid,this.backBg,r.default.gameTexturePath+"mahjong/atlas_mahjong",n.backSp,null,!0)},Object.defineProperty(e.prototype,"isFront",{set:function(t){this.frontBg.node.active=t,this.frontSp.node.active=t,this.backBg.node.active=!t},enumerable:!1,configurable:!0}),e.prototype.setSpecialColor=function(t){this.frontBg.node.color=t&&s.default.SpecialBgColor||s.default.NormalBgColor},e.prototype.doOutAnim=function(t,e,i,n){var a=this;this.setPerspStyle(0,s.ErmjRelativeDefine.Self);var o=s.default.getPerspectiveCfg(i),r=o.cfg,l=o.dir,c=s.default.mjOutStyle[n];this.node.scale=1.5,this.node.setPosition(t),this.frontBg.node.scaleX=l*c.perspScale,this.backBg.node.scaleX=l*c.perspScale,Game.Tween.get(this.node).delay(this.Define.outMjShowTime).to(this.Define.outMjFlyTime,{position:e,scale:1,angle:-c.frontAngle,skewX:l*r.frontSkewX*c.perspScale},cc.easeIn(1)).call(function(){a.setPerspStyle(i,n)}).start()},e.prototype.doMove=function(t,e,i,n,a,o){void 0===e&&(e=1),void 0===i&&(i=0),void 0===a&&(a=!1),void 0===o&&(o=cc.easeIn(1)),Game.Tween.get(this.node).delay(i).call(function(){}).to(e,{position:t},o).call(n).start()},e.prototype.getRealSize=function(){return[this.node.width*this.node.scaleX,this.node.height*this.node.scaleY]},e.prototype.getAttentionWorldPos=function(){return this.attentionPoint.parent.convertToWorldSpaceAR(this.attentionPoint.position)},e.prototype.reset=function(){this.isFront=!1,this.frontBg.node.color=s.default.NormalBgColor,this.frontSp.node.angle=0,this.node.angle=0,this.node.scale=1,this.node.skewX=0},e}(o.default);i.default=c,cc._RF.pop()},{"../../data/ErmjGameConst":"ErmjGameConst","../../data/ErmjPathHelper":"ErmjPathHelper","../../tool/ErmjMjStyleHelper":"ErmjMjStyleHelper","../ErmjBaseView":"ErmjBaseView"}],ErmjMahjongSelfPlayView:[function(t,e,i){"use strict";cc._RF.push(e,"a74fd9oBRRCiI5sNpg/sORc","ErmjMahjongSelfPlayView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<i;e++)for(var o=arguments[e],r=0,s=o.length;r<s;r++,a++)n[a]=o[r];return n};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./ErmjBaseView"),s=t("./mahjong/ErmjMahjongHandView"),l=t("../data/ErmjPathHelper"),c=t("./ErmjWinListTipsView"),h=t("../data/ErmjGameConst"),u=function(t){function e(e){var i=t.call(this)||this;return i.mjHandList=[],i.unusedMjList=[],i.lastDealMjItem=null,i.rawMjPosList=[],i.touchEnable=!1,i.isReadyTing=!1,i.tingData={},i.setNode(e),i}return a(e,t),e.prototype.initView=function(){var t=this;this.touchLayer=this.getChild("touchLayer"),this.touchLayer.width=cc.Canvas.instance.node.width,h.default.addCommonClick(this.touchLayer,"",function(){t.cancelReadyTing(),t.resetSelectMj()},this,cc.Button.Transition.NONE),this.getChild("selectLayer").on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.playTips=this.getChild("callPlayTips"),this.playTips.active=!1,this.selfSelectSign=this.getChild("selfSelectSign"),this.selfSelectSign.active=!1,this.tingLayer=this.getChild("tingLayer"),this.tingLayer.active=!1,this.winTipsView=new c.default(this.getChild("winListTipsView")),this.winTipsView.active=!1,this.initMjList()},e.prototype.initMjList=function(){var t=this.getChild("hand"),e=this.getChild("hand/mahjongHandView");e.active=!0;var i=e.position,n=new s.default(e);n.active=!1,this.unusedMjList.push(n),this.rawMjPosList.push(i);for(var a=0;a<this.Define.HandMjMaxCount;a++){var o=cc.instantiate(e);o.setParent(t),o.active=!0;var r=i.add(this.Define.SelfHandMahjongSpace.mul(a+1));this.rawMjPosList.push(r);var l=new s.default(o);l.active=!1,this.unusedMjList.push(l)}},e.prototype.dealHandMj=function(t,e){void 0===t&&(t=1),void 0===e&&(e=[]);for(var i=0;i<t;i++){var n=this.unusedMjList.pop();if(!n){console.error("dealHandMj this.unusedMjList.pop() == null");break}n.active=!0;var a=this.mjHandList.length;n.sortIndex=a,n.isOut=!1,e[a]?(n.mahjongValue=e[a],n.isFront=!0):n.isFront=!1,this.mjHandList.push(n),n.node.setPosition(this.rawMjPosList[a])}this.tingLayer.active=!1,this.touchEnable=!0},e.prototype.readyForOut=function(t){if(this.touchEnable=!0,!this.lastDealMjItem){var e;this.touchEnable=!1,this.resetSelectMj(),t?(e=this.findMjItemByValue(t),this.mjHandList.splice(e.sortIndex,1),this.sortCardDirectly(!1)):e=this.mjHandList.pop(),this.lastDealMjItem=e;var i=this.mjHandList.length;this.lastDealMjItem.sortIndex=i;var n=this.rawMjPosList[i-1];e.node.setPosition(n.add(this.Define.LastOneDealOffset[0])),this.touchEnable=!0}},e.prototype.drawHandMj=function(t){var e=this,i=this.unusedMjList.pop();if(i){this.touchEnable=!1,i.active=!0,i.isOut=!1,t?(i.isFront=!0,i.mahjongValue=t):i.isFront=!1,this.lastDealMjItem&&(console.error("error drawHandMj this.recycleLastDealMj"),this.recycleLastDealMj()),this.lastDealMjItem=i;var n=this.mjHandList.length;this.lastDealMjItem.sortIndex=n;var a=(this.rawMjPosList[n-1]||cc.Vec3.ZERO).add(this.Define.LastOneDealOffset[0]);i.doDraw(a,.2),Game.Component.scheduleOnce(function(){e.touchEnable=!0},.2)}else console.error("error drawHandMj this.unusedMjList.pop() == null")},e.prototype.changeFlower=function(t,e){var i=this;this.resetSelectMj(),this.touchEnable=!1;var n=0,a=e.length,o=t.length;if(this.lastDealMjItem)a>0?(s=t.indexOf(this.lastDealMjItem.mahjongValue))>-1&&this.lastDealMjItem.doChangeFlower(e[s],.2,.2):this.lastDealMjItem.doChangeFlower(0,.2,.2),n+=1;else if(a>0)for(var r=0;r<this.mjHandList.length;r++){var s,l=this.mjHandList[r];if((s=t.indexOf(l.mahjongValue))>-1&&(n++,l.doChangeFlower(e[s],.2,.2)),n==o)break}else for(r=this.mjHandList.length-o;r<this.mjHandList.length;r++)(l=this.mjHandList[r]).doChangeFlower(0,.2,.2);Game.Component.scheduleOnce(function(){i.lastDealMjItem||(i.sortCardDirectly(),i.touchEnable=!0)},.71)},e.prototype.onTing=function(){this.enableAllMjTouch(),this.tingLayer.active=!0,this.isReadyTing=!1,this.resetSelectMj()},e.prototype.enableAllMjTouch=function(){this.lastDealMjItem&&this.lastDealMjItem.setTouchEnable(!0),this.mjHandList.forEach(function(t){t.setTouchEnable(!0)})},e.prototype.onTingChooseSwitch=function(t,e){if(this.resetSelectMj(),this.isReadyTing=t,this.tingData=e,this.isReadyTing&&this.tingData.ting_items){var i=this.tingData.ting_items;this.lastDealMjItem&&(i[this.lastDealMjItem.mahjongValue]?this.lastDealMjItem.setTouchEnable(!0):this.lastDealMjItem.setTouchEnable(!1)),this.mjHandList.forEach(function(t){i[t.mahjongValue]?t.setTouchEnable(!0):t.setTouchEnable(!1)})}else this.cancelReadyTing()},e.prototype.touchStart=function(t){if(this.Context.get(this.Define.FieldHandActionEnable)&&this.touchEnable){var e=t.getLocation(),i=this.getHandMjItemByPos(e);i?(Logger.warn("startMj touch sortIndex: ",i.sortIndex),this.selectMj?i==this.selectMj?this.Context.get(this.Define.FieldInPlayTurn)?this.onPlay():(this.cancelReadyTing(),this.resetSelectMj()):(this.selectMj.onSelect(),i.onSelect(),this.selectMj=i,this.selfSelectSign.active=!0,this.selfSelectSign.setPosition(this.selfSelectSign.parent.convertToNodeSpaceAR(i.getSelectSignWorldPos())),this.isReadyTing&&this.tingData.ting_items&&(this.winTipsView.active=!0,this.winTipsView.updateWinList(this.tingData.ting_items[this.selectMj.mahjongValue]||[]))):(this.selectMj=i,this.selectMj.onSelect(),this.selfSelectSign.active=!0,this.selfSelectSign.setPosition(this.selfSelectSign.parent.convertToNodeSpaceAR(i.getSelectSignWorldPos())),this.isReadyTing&&this.tingData.ting_items&&(this.winTipsView.active=!0,this.winTipsView.updateWinList(this.tingData.ting_items[this.selectMj.mahjongValue]||[])))):(this.cancelReadyTing(),this.resetSelectMj())}},e.prototype.getHandMjItemByPos=function(t){if(this.lastDealMjItem&&this.lastDealMjItem.checkMjValid()&&this.lastDealMjItem.checkIsTouch(t))return this.lastDealMjItem;for(var e=0;e<this.mjHandList.length;e++){var i=this.mjHandList[e];if(i.checkMjValid()&&i.checkIsTouch(t))return i}},e.prototype.showPlayTips=function(t){this.playTips.active=t},e.prototype.resetSelectMj=function(){this.selfSelectSign.active=!1,this.selectMj&&(this.selectMj.isSelect&&this.selectMj.onSelect(),this.selectMj=null)},e.prototype.cancelReadyTing=function(){this.isReadyTing||this.enableAllMjTouch(),this.Context.get(this.Define.FieldInTing)||(this.winTipsView.active=!1)},e.prototype.hideOperCard=function(t){this.isReadyTing=!1,this.cancelReadyTing(),this.resetSelectMj();var e=0,i=o(t);this.lastDealMjItem&&(a=i.indexOf(this.lastDealMjItem.mahjongValue))>-1&&(e++,i.splice(a,1),this.recycleLastDealMj());for(var n=0;n<this.mjHandList.length&&e!=t.length;n++){var a,r=this.mjHandList[n];(a=i.indexOf(r.mahjongValue))>-1&&(e++,i.splice(a,1),r.active=!1,r.isOut=!0)}this.recycleUsedOutMjItem(),this.sortCardDirectly(!1),this.touchEnable=!1},e.prototype.onPlay=function(){h.default.playSound(l.ErmjAudioConst.commonAudio.OutCard,!0),this.playMj=this.selectMj,this.isReadyTing?Game.Server.send(this.Define.CmdTing,{card:this.playMj.mahjongValue}):Game.Server.send(this.Define.CmdPlay,{card:this.playMj.mahjongValue}),this.playMj.active=!1,this.showPlayTips(!1),this.Context.set(this.Define.FieldInPlayTurn,!1)},e.prototype.outCard=function(t,e,i){var n;if(void 0===i&&(i=!1),this.isReadyTing=!1,this.cancelReadyTing(),this.resetSelectMj(),i){var a=!1;this.playMj&&!this.playMj.isOut&&(Logger.error("outCard \u4e34\u754c\u72b6\u6001"),this.playMj.mahjongValue!==t?(this.playMj.active=!0,a=!1):(n=this.playMj,a=!0)),a||(n=this.lastDealMjItem&&!this.lastDealMjItem.isOut&&this.lastDealMjItem.mahjongValue==t?this.lastDealMjItem:this.findMjItemByValue(t))}else n=this.playMj&&!this.playMj.isOut&&this.playMj.mahjongValue==t?this.playMj:this.lastDealMjItem&&!this.lastDealMjItem.isOut&&this.lastDealMjItem.mahjongValue==t?this.lastDealMjItem:this.findMjItemByValue(t);n&&!n.isOut?(n.active=!1,n.isOut=!0,this.touchEnable=!1,e&&this.lastDealMjItem?n!==this.lastDealMjItem?this.sortDrawCardAmin(n):(this.recycleLastDealMj(),this.touchEnable=!0):(this.recycleUsedOutMjItem(),this.sortCardDirectly(!1),this.touchEnable=!0)):console.error("error outCard outIndex == -1",this.playMj,this.lastDealMjItem),this.playMj=null},e.prototype.findMjItemByValue=function(t){for(var e=0;e<this.mjHandList.length;e++){var i=this.mjHandList[e];if(!i.isOut&&i.mahjongValue==t)return i}},e.prototype.sortDrawCardAmin=function(t){if(t&&this.lastDealMjItem){var e=t.sortIndex,i=0;if(t.mahjongValue==this.lastDealMjItem.mahjongValue)i=e;else for(var n=0;n<this.mjHandList.length&&!(n>=this.Define.HandMjMaxCount)&&this.mjHandList[n].mahjongValue<=this.lastDealMjItem.mahjongValue;n++)i=n+1;if(Logger.error("sortDrawCardAmin",e,i,this.mjHandList.length),i==e){var a=i==this.mjHandList.length-1;this.doSortLastDealMove(e,!a,0)}else i==this.mjHandList.length?(this.doSortPanMove(e+1,this.mjHandList.length-1,!1,.2),this.doSortLastDealMove(this.mjHandList.length-1,!1,0)):i>e?(this.doSortPanMove(e+1,i-1,!1,.2),this.doSortLastDealMove(i-1,!0,.2)):(this.doSortPanMove(i,e-1,!0,.2),this.doSortLastDealMove(i,!0,.2))}},e.prototype.doSortPanMove=function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=.5);for(var a=i?1:-1,o=t;o<=e;o++){var r=this.mjHandList[o];r&&this.rawMjPosList[o+a]?(r.doMove(this.rawMjPosList[o+a],n),r.sortIndex+=a):console.error("doSortPanMove error",o,a)}},e.prototype.doSortLastDealMove=function(t,e,i){var n=this;if(void 0===i&&(i=0),this.lastDealMjItem&&this.rawMjPosList[t]){var a=this.lastDealMjItem.node.position,o=this.rawMjPosList[t],r=this.lastDealMjItem.getRealSize(),s=(r[0],r[1]);if(this.lastDealMjItem.sortIndex=t,e){var l=Global.Toolkit.getVec2Distance(a,o),c=Math.max(l/2e3,.2);this.lastDealMjItem.doMove(a.add(cc.v3(0,s+5)),.1,i),this.lastDealMjItem.doMove(o.add(cc.v3(0,s+5)),c,.1+i),this.lastDealMjItem.doMove(o,.1,c+.1+i,function(){n.recycleUsedOutMjItem(),n.pushLastIntoHandList(t),n.sortMjHandList(),n.touchEnable=!0})}else this.lastDealMjItem.doMove(o,.2,i,function(){n.recycleUsedOutMjItem(),n.pushLastIntoHandList(t),n.sortMjHandList(),n.touchEnable=!0})}else console.error("doSortLastDealMove error",t)},e.prototype.doWin=function(){this.isReadyTing=!1,this.cancelReadyTing(),this.resetSelectMj()},e.prototype.winHideLastDraw=function(t){this.lastDealMjItem&&this.lastDealMjItem.mahjongValue==t&&this.recycleLastDealMj()},e.prototype.sortCardDirectly=function(t){var e=this;void 0===t&&(t=!1),this.pushLastIntoHandList(),this.sortMjHandList(),t||this.mjHandList.forEach(function(t,i){t.active=!0,t.isOut=!1,t.sortIndex=i,t.node.setPosition(e.rawMjPosList[i])})},e.prototype.pushLastIntoHandList=function(t){if(void 0===t&&(t=-1),this.lastDealMjItem){var e=t>=0&&t<this.mjHandList.length?t:this.mjHandList.length;this.mjHandList.splice(e,0,this.lastDealMjItem),this.lastDealMjItem=null}},e.prototype.sortMjHandList=function(){this.mjHandList.sort(function(t,e){return t.mahjongValue&&e.mahjongValue?t.mahjongValue-e.mahjongValue:0})},e.prototype.recycleUsedOutMjItem=function(){var t=this;this.sortMjHandList();for(var e=[],i=[],n=0;n<this.mjHandList.length;n++){var a=this.mjHandList[n];!a.active||a.isOut?e.push(a):i.push(a)}this.mjHandList=i,e.forEach(function(e){e.active=!1,e.reset(),t.unusedMjList.push(e)})},e.prototype.recycleAllUsedMjItems=function(){this.recycleLastDealMj();for(var t=0;t<this.mjHandList.length;t++){var e=this.mjHandList[t];e.active=!1,e.reset(),this.unusedMjList.push(e)}this.mjHandList=[]},e.prototype.recycleLastDealMj=function(){this.lastDealMjItem&&(this.lastDealMjItem.active=!1,this.lastDealMjItem.reset(),this.unusedMjList.push(this.lastDealMjItem),this.lastDealMjItem=null)},e.prototype.clearByRound=function(){this.playMj=null,this.playTips.active=!1,this.touchEnable=!1,this.resetSelectMj(),this.recycleAllUsedMjItems(),this.winTipsView.active=!1,this.isReadyTing=!1,this.tingData={},this.tingLayer.active=!1},e}(r.default);i.default=u,cc._RF.pop()},{"../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","./ErmjBaseView":"ErmjBaseView","./ErmjWinListTipsView":"ErmjWinListTipsView","./mahjong/ErmjMahjongHandView":"ErmjMahjongHandView"}],ErmjMainUI:[function(t,e,i){"use strict";cc._RF.push(e,"cbcf7x2hxNITLLuuvCsxkLM","ErmjMainUI");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var a,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,i,r):a(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},r=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<i;e++)for(var o=arguments[e],r=0,s=o.length;r<s;r++,a++)n[a]=o[r];return n};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../component/ErmjBaseComponent"),l=t("../data/ErmjPathHelper"),c=t("../subView/ErmjMatchPlayerView"),h=t("../subView/ErmjGameStartView"),u=t("../subView/ErmjAskNoticeView"),p=t("../subView/ErmjLeftTipsView"),d=t("../subView/ErmjFlowView"),f=t("../subView/ErmjSettleView"),m=t("../manager/ErmjOutMjViewManager"),g=t("../subView/player/ErmjPlayerView"),j=t("../subView/mahjong/ErmjMjPlayerView"),y=t("../subView/mahjong/ErmjMahjongHillView"),v=t("../data/ErmjRuleConst"),w=t("../data/ErmjGameConst"),_=t("../subView/ErmjMenuView"),S=t("../data/ErmjGameEvent"),C=t("../subView/ErmjAskActionView"),E=t("../subView/ErmjMahjongSelfPlayView"),P=t("../component/ErmjDiceAnim"),b=t("../component/ErmjRubMjAnim"),M=t("../subView/ErmjWinLightningView"),V=t("../tool/ErmjMjStyleHelper"),L=t("../subView/ErmjAskBtnView"),O=t("../ErmjDriver"),H=cc._decorator,A=H.ccclass,I=(H.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerViewList=[],e.mjPlayerViewList=[],e}return a(e,t),e.prototype.onLoad=function(){this.viewSet=new ViewSet,this.Define=O.default.instance.Define,this.initView()},e.prototype.onEnable=function(){Game.Event.on(S.default.doPatchwork,this,this.doHillPatchwork),Game.Event.on(S.default.doTingCallPlay,this,this.doTingSwitch),Game.Event.on(S.default.onUserInfoTouch,this,this.onUserInfoShow),Global.Event.on(GlobalEvent.TYPE_VIP_ENTER_GAME,this,this.vipEnterGame)},e.prototype.onDisable=function(){Game.Event.off(S.default.doPatchwork,this,this.doHillPatchwork),Game.Event.off(S.default.doTingCallPlay,this,this.doTingSwitch),Game.Event.off(S.default.onUserInfoTouch,this,this.onUserInfoShow),Global.Event.off(GlobalEvent.TYPE_VIP_ENTER_GAME,this,this.vipEnterGame)},e.prototype.vipEnterGame=function(t){t.data._gid==w.default.Gid&&t.data._glv===Game.Control.curLv&&Global.Event.event(GlobalEvent.VIPADMISSION,t.data)},e.prototype.onDestroy=function(){this.taskManager.onDispose()},e.prototype.initView=function(){this.node.width=cc.Canvas.instance.node.width,this.node.height=cc.Canvas.instance.node.height,this.initManager(),this.initCenterView(),this.initBottomView(),this.initTopView(),this.initFloatView(),this.initHeadTipsManager(),this.initTaskManager(),this.levelSp=cc.find("bottomNode/levelSp",this.node).getComponent(cc.Sprite),this.baseLbl=cc.find("bottomNode/baseScore/baseLbl",this.node).getComponent(cc.Label),this.lastOutSign=cc.find("centerNode/outSign",this.node),this.lastOutSign.active=!1;var t=cc.find("menuNode",this.node);Global.Toolkit.freeAdjustIphoneX([t]);var e=new _.default(t);e.active=!0,this.registView(this.Define.ViewMenu,e);var i=cc.find("topNode/paomadeng",this.node),n=cc.find("MsgBox",i);Global.UIHelper.addPaoMaDengComp(n,!1,i),Global.UIHelper.addWifiComp(this.getChild("rightAttach/wifiNode"),2),Global.UIHelper.addAdmissionComp(cc.find("topNode/admissionBox",this.node)),w.default.addCommonClick(this.node,"testBtn",function(){Game.Event.event(Game.EVENT_CALL_RECONNECT)},this)},e.prototype.initManager=function(){var t=this.getChild("centerNode/mahjong/outMjPool");this.outMjManager=new m.default(t),O.default.instance.outMjManager=this.outMjManager},e.prototype.initCenterView=function(){for(var t=this.getChild("centerNode"),e=0;e<w.default.maxPlayerCount;e++){var i=this.getChild("centerNode/player/player"+e),n=new g.default(i,e);n.clientSit=e,n.hide(),this.playerViewList.push(n)}for(e=0;e<w.default.maxPlayerCount;e++){i=this.getChild("centerNode/mahjong/mahjong"+e);var a=new j.default(i,e);a.active=!1,this.mjPlayerViewList.push(a)}var o=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/selfPlayView",cc.Prefab),r=cc.instantiate(o);r.setParent(t.getChildByName("selfRoot")),r.setPosition(cc.Vec2.ZERO),this.selfPlayView=new E.default(r),this.selfPlayView.active=!1,this.registView(this.Define.ViewSelfPlay,this.selfPlayView);var s=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/askActionView",cc.Prefab),c=cc.instantiate(s);c.setParent(t),c.setPosition(cc.Vec2.ZERO),this.askActionView=new C.default(c),this.askActionView.active=!1,this.registView(this.Define.ViewAskAction,this.askActionView);var h=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/autoBtnVIew",cc.Prefab),u=cc.instantiate(h);u.setParent(t),u.setPosition(cc.Vec2.ZERO),this.askBtnView=new L.default(u),this.askBtnView.active=!0,this.registView(this.Define.ViewAskBtn,this.askBtnView)},e.prototype.initBottomView=function(){var t=this.getChild("bottomNode"),e=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/askNoticeView",cc.Prefab),i=cc.instantiate(e);i.setParent(t),i.setPosition(cc.Vec2.ZERO),this.askNoticeView=new u.default(i),this.askNoticeView.active=!0,this.registView(this.Define.ViewAskNotice,this.askNoticeView);var n=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/mahjong/mahjongHillView",cc.Prefab),a=cc.instantiate(n);a.setParent(t),a.setPosition(cc.Vec2.ZERO),this.mjHillView=new y.default(a),this.mjHillView.active=!1,this.registView(this.Define.ViewMjHill,this.mjHillView);var o=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/diceAnim",cc.Prefab),r=cc.instantiate(o);r.setParent(t),r.setPosition(cc.Vec2.ZERO),this.diceAnimComp=r.getComponent(P.default),this.diceAnimComp.node.active=!1},e.prototype.initTopView=function(){var t=this.getChild("topNode"),e=cc.find("leftTipsView",t);this.leftTipsView=new p.default(e),this.leftTipsView.active=!1,this.registView(this.Define.ViewLeftTips,this.leftTipsView);var i=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/rubMjAnim",cc.Prefab),n=cc.instantiate(i);n.setParent(t),n.setPosition(cc.Vec2.ZERO),this.rubMjAnimComp=n.getComponent(b.default),this.rubMjAnimComp.node.active=!1},e.prototype.initFloatView=function(){var t=this.getChild("floatNode"),e=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/matchPlayerView",cc.Prefab),i=cc.instantiate(e);i.setParent(t),i.setPosition(cc.Vec2.ZERO),this.matchPlayerView=new c.default(i),this.matchPlayerView.active=!1,this.registView(this.Define.ViewMatchPlayer,this.matchPlayerView);var n=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/gameStartView",cc.Prefab),a=cc.instantiate(n);a.setParent(t),a.setPosition(cc.Vec2.ZERO),this.gameStartView=new h.default(a),this.gameStartView.active=!1,this.registView(this.Define.ViewGameStart,this.gameStartView);var o=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/winLightningView",cc.Prefab),r=cc.instantiate(o);r.setParent(t),r.setPosition(cc.Vec2.ZERO),this.lightningView=new M.default(r),this.lightningView.active=!1,this.registView(this.Define.ViewLightning,this.lightningView);var s=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/flowView",cc.Prefab),u=cc.instantiate(s);u.setParent(t),u.setPosition(cc.Vec2.ZERO),this.flowView=new d.default(u),this.flowView.active=!1,this.registView(this.Define.ViewFlow,this.flowView);var p=Global.ResourceManager.getBundleRes(w.default.Gid,l.default.gamePrefabsPath+"panel/subView/settleView",cc.Prefab),m=cc.instantiate(p);m.setParent(t),m.setPosition(cc.Vec2.ZERO),this.settleView=new f.default(m),this.settleView.active=!1,this.registView(this.Define.ViewSettle,this.settleView)},e.prototype.initHeadTipsManager=function(){this.headTipsManager=new HeadTipsManager,this.headTipsManager.init(cc.find("floatNode",this.node),cc.find("interactView",this.node),!1)},e.prototype.initTaskManager=function(){this.taskManager=new TaskManager,this.taskManager.init(cc.find("rightAttach/taskRoot",this.node),w.default.Gid,-1),this.taskManager.reqGetGameTaskList()},e.prototype.doResetMj=function(){this.selfPlayView.resetSelectMj()},e.prototype.updateLevelBase=function(t,e){Global.ResourceManager.loadBundleAutoAtlas(w.default.Gid,this.levelSp,l.default.gameTexturePath+"dynamic/atlas_dynamic",w.default.LevelSpCfg[e],null,!0),this.baseLbl.string=Global.Toolkit.formatPointStr(t)},e.prototype.showMatch=function(t){var e=this;this.matchPlayerView.active=!0,this.playerViewList[0].show(Global.PlayerData),t&&t>0&&this.matchPlayerView.setTimeRunConfig(t,function(){O.default.instance.Context.isWaitMatch=!1,e.matchPlayerView.active=!1,Global.UI.showYesNoBox("\u5339\u914d\u8d85\u65f6\uff0c\u662f\u5426\u91cd\u65b0\u5339\u914d\uff1f",function(){Game.Control.trySendEnter({_from:"jump"})},function(){Game.Server.send(e.Define.CmdLeave,{IsClose:1}),O.default.instance.leaveGame()})},this)},e.prototype.onBanker=function(t,e,i){var n=this.playerViewList[t];n&&n.showBanker(!0);var a=v.default.calculateDealBeigin(t,e),o=a[0],r=a[1];this.mjHillView.active=!1,this.mjHillView.initWallDeal(o,r),this.leftTipsView.active=!0,this.leftTipsView.updateLeftLbl(w.default.mahjongTotal),this.diceAnimComp.node.active=!0,this.diceAnimComp.showDice(e,i),i&&(w.default.playSound(l.ErmjAudioConst.commonAudio.Dice,!0),Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onBanker",2))},e.prototype.onDeal=function(t,e,i){var n=this;if(t&&!Global.Toolkit.isEmptyObject(t)){for(var a=0,o=v.default.getDealOrderArr(e),r=0;r<v.default.dealConfig.length;r++)for(var s=v.default.dealConfig[r],c=function(e){var i=o[e],r=s[e],c=h.mjPlayerViewList[i];if(c&&r>0&&t[i]){var u=t[i].cards||[];Game.Component.scheduleOnce(function(){w.default.playSound(l.ErmjAudioConst.commonAudio.DealCard,!0),n.mjHillView.doDeal(r),c.active=!0,c.setHandMjShow(!0),c.dealHandMj(r,u),0==i&&(c.setDarkHandMjOutScreen(),n.selfPlayView.active=!0,n.selfPlayView.dealHandMj(r,u)),n.leftTipsView.reduceLeftLbl(r)},a),a+=.35}},h=this,u=0;u<s.length;u++)c(u);Game.Component.scheduleOnce(function(){n.leftTipsView.active=!0,n.leftTipsView.updateLeftLbl(i),n.selfPlayView.sortCardDirectly(!1)},a),Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onDeal",a+.5)}},e.prototype.onDealDirectly=function(t,e){var i=this;t&&!Global.Toolkit.isEmptyObject(t)&&(this.mjPlayerViewList.forEach(function(e,n){var a=t[n];e.active=!0,e.setHandMjShow(!0),e.dealHandMj(a.hand_count,[]),0==n&&(e.setDarkHandMjOutScreen(),i.selfPlayView.active=!0,i.selfPlayView.dealHandMj(a.hand_count,a.cards))}),this.leftTipsView.updateLeftLbl(e),this.selfPlayView.sortCardDirectly(!1))},e.prototype.onChangeFlower=function(t,e,i,n){w.default.playSound(l.ErmjAudioConst.genderSoundPath("buhua",0==t?0:1),!0),this.mjPlayerViewList[t].changeFlower(e,i||[]),0==t&&this.selfPlayView.changeFlower(e,i||[]),Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onChangeFlower",1),this.leftTipsView.updateLeftLbl(n)},e.prototype.onDrawCard=function(t,e,i,n,a){var o=this;i?this.mjHillView.doDeal(1):this.mjHillView.doPatchwork(1),this.leftTipsView.updateLeftLbl(n),this.mjPlayerViewList[t].drawHandMj(e[0]),0==t&&(a?(this.rubMjAnimComp.node.active=!0,this.rubMjAnimComp.doRubAnim(e[0]),Game.Component.scheduleOnce(function(){o.rubMjAnimComp.node.active=!1,o.selfPlayView.drawHandMj(e[0]),w.default.playSound(l.ErmjAudioConst.commonAudio.DrawCard,!0)},1.5),Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onDrawCard.isRub",2)):(this.selfPlayView.drawHandMj(e[0]),w.default.playSound(l.ErmjAudioConst.commonAudio.DrawCard,!0))),Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onDrawCard",.31)},e.prototype.onPlay=function(t,e,i){var n=this;void 0===i&&(i=!1),w.default.playSound(l.ErmjAudioConst.genderSoundPath(V.default.mjOutSoundMap[e],0==t?0:1),!0),this.mjPlayerViewList[t].outCard(e),0==t&&this.selfPlayView.outCard(e,!0,i);var a=this.Define.outMjShowTime+this.Define.outMjFlyTime;Game.Component.scheduleOnce(function(){n.showLastOutSign(!0)},a+.1),Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onPlay",a+.15)},e.prototype.onChow=function(t,e,i,n){if(w.default.playSound(l.ErmjAudioConst.genderSoundPath("chi",0==t?0:1),!0),0==t){var a=e.indexOf(i),o=r(e);o.splice(a,1),this.selfPlayView.hideOperCard(o),this.mjPlayerViewList[t].chowCard(e,i)}else this.mjPlayerViewList[t].chowCard(e,i);this.showLastOutSign(!1),this.mjPlayerViewList[n].reduceOneOutMj(),this.outMjManager.recycleLastOutMj(),this.playerViewList[t].showStateSp(!0,w.default.StateSpStrCfg.Chow),Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onChow",.8)},e.prototype.onPong=function(t,e,i){w.default.playSound(l.ErmjAudioConst.genderSoundPath("peng",0==t?0:1),!0),0==t?(this.selfPlayView.hideOperCard(e.slice(0,2)),this.mjPlayerViewList[t].pongCard(e)):this.mjPlayerViewList[t].pongCard(e),this.showLastOutSign(!1),this.mjPlayerViewList[i].reduceOneOutMj(),this.outMjManager.recycleLastOutMj(),this.playerViewList[t].showStateSp(!0,w.default.StateSpStrCfg.Pong),Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onPong",.8)},e.prototype.onKong=function(t,e,i,n){if(6==i?w.default.playSound(l.ErmjAudioConst.genderSoundPath("angang",0==t?0:1),!0):w.default.playSound(l.ErmjAudioConst.genderSoundPath("gang",0==t?0:1),!0),0==t){var a=6==i?4:5==i?1:3;this.selfPlayView.hideOperCard(e.slice(0,a)),this.mjPlayerViewList[t].kongCard(i,e),this.selfPlayView.showPlayTips(!1)}else this.mjPlayerViewList[t].kongCard(i,e);4==i&&(this.showLastOutSign(!1),this.mjPlayerViewList[n].reduceOneOutMj(),this.outMjManager.recycleLastOutMj()),this.playerViewList[t].showStateSp(!0,w.default.StateSpStrCfg.Kong),Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onKong",.8)},e.prototype.onWin=function(t,e,i,n,a){var o=1==n?w.default.StateSpStrCfg.WinAll:3==n?w.default.StateSpStrCfg.RobWin:w.default.StateSpStrCfg.Win;this.playerViewList[t].showStateSp(!0,o),this.selfPlayView.doWin(),this.mjPlayerViewList[t].addWinMjShow(i),w.default.playSound(l.ErmjAudioConst.commonAudio.Hu,!0),a&&(3==n?(w.default.playSound(l.ErmjAudioConst.genderSoundPath("hu",0==t?0:1),!0),this.mjPlayerViewList[e].robbedKongLose(i)):2==n?(w.default.playSound(l.ErmjAudioConst.genderSoundPath("hu",0==t?0:1),!0),this.showLastOutSign(!1),this.outMjManager.recycleLastOutMj()):(w.default.playSound(l.ErmjAudioConst.genderSoundPath("zimo",0==t?0:1),!0),this.mjPlayerViewList[t].winHideLastDraw(i),0==t&&this.selfPlayView.winHideLastDraw(i)),this.lightningView.setLightPoint(this.mjPlayerViewList[t].getLightningWorldPos()),this.lightningView.active=!0,Game.Event.event(Game.EVENT_ADDTIMELOCK,"Ermj.onWin",1))},e.prototype.showLastOutSign=function(t){if(this.lastOutSign.stopAllActions(),this.lastOutSign.active=t,t){var e=this.outMjManager.getLastOutMj();this.lastOutSign.setPosition(this.lastOutSign.parent.convertToNodeSpaceAR(e.getAttentionWorldPos())),this.lastOutSign.runAction(cc.repeatForever(cc.sequence([cc.moveBy(.4,cc.v2(0,15)),cc.moveBy(.4,cc.v2(0,-15))])))}},e.prototype.doHillPatchwork=function(t){this.mjHillView.doPatchwork(t)},e.prototype.doTingSwitch=function(t,e){this.selfPlayView.active&&this.selfPlayView.onTingChooseSwitch(t,e)},e.prototype.onUserInfoShow=function(t,e){var i=O.default.instance.Context.playerList[t];i&&this.headTipsManager.showHeadView(!0,t,e,i)},e.prototype.clearWnd=function(){this.clearPlayers(),this.clearByGame()},e.prototype.clearPlayers=function(){for(var t=0;t<this.playerViewList.length;t++)this.playerViewList[t].hide();for(t=0;t<this.mjPlayerViewList.length;t++)this.mjPlayerViewList[t].active=!1;this.selfPlayView.active=!1},e.prototype.clearByRound=function(){this.diceAnimComp.node.active=!1,this.rubMjAnimComp.node.active=!1,this.showLastOutSign(!1),this.outMjManager.clear(),this.viewSet.callAll("clearByRound"),this.callAllPlayers("clearByRound"),this.callAllMjPlayers("clearByRound")},e.prototype.clearByGame=function(){this.outMjManager.clear(),this.viewSet.callAll("clearByGame"),this.callAllPlayers("clearByGame"),this.callAllMjPlayers("clearByGame")},e.prototype.registView=function(t,e){this.viewSet.registView(t,e)},e.prototype.getView=function(t){return this.viewSet.getViewEx(t)},e.prototype.callPlayer=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var a=this.getPlayer(t);null!=a?a[e]&&a[e].apply&&a[e].apply(a,i):Logger.error("\u627e\u4e0d\u5230player!!!",t)},e.prototype.callAllPlayers=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=0;n<w.default.maxPlayerCount;n++){var a=this.getPlayer(n);if(null==a)return;a[t]&&a[t].apply&&a[t].apply(a,e)}},e.prototype.getPlayer=function(t){return this.playerViewList[t]},e.prototype.getMjPlayer=function(t){return this.mjPlayerViewList[t]},e.prototype.callMjPlayer=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var a=this.getMjPlayer(t);null!=a?a[e]&&a[e].apply&&a[e].apply(a,i):Logger.error("\u627e\u4e0d\u5230player!!!",t)},e.prototype.callAllMjPlayers=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=0;n<w.default.maxPlayerCount;n++){var a=this.getMjPlayer(n);if(null==a)return;a[t]&&a[t].apply&&a[t].apply(a,e)}},o([A],e)}(s.default));i.default=I,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","../component/ErmjBaseComponent":"ErmjBaseComponent","../component/ErmjDiceAnim":"ErmjDiceAnim","../component/ErmjRubMjAnim":"ErmjRubMjAnim","../data/ErmjGameConst":"ErmjGameConst","../data/ErmjGameEvent":"ErmjGameEvent","../data/ErmjPathHelper":"ErmjPathHelper","../data/ErmjRuleConst":"ErmjRuleConst","../manager/ErmjOutMjViewManager":"ErmjOutMjViewManager","../subView/ErmjAskActionView":"ErmjAskActionView","../subView/ErmjAskBtnView":"ErmjAskBtnView","../subView/ErmjAskNoticeView":"ErmjAskNoticeView","../subView/ErmjFlowView":"ErmjFlowView","../subView/ErmjGameStartView":"ErmjGameStartView","../subView/ErmjLeftTipsView":"ErmjLeftTipsView","../subView/ErmjMahjongSelfPlayView":"ErmjMahjongSelfPlayView","../subView/ErmjMatchPlayerView":"ErmjMatchPlayerView","../subView/ErmjMenuView":"ErmjMenuView","../subView/ErmjSettleView":"ErmjSettleView","../subView/ErmjWinLightningView":"ErmjWinLightningView","../subView/mahjong/ErmjMahjongHillView":"ErmjMahjongHillView","../subView/mahjong/ErmjMjPlayerView":"ErmjMjPlayerView","../subView/player/ErmjPlayerView":"ErmjPlayerView","../tool/ErmjMjStyleHelper":"ErmjMjStyleHelper"}],ErmjMatchPlayerView:[function(t,e,i){"use strict";cc._RF.push(e,"1d7c93ReARGp4aMgfBbVANb","ErmjMatchPlayerView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseView"),r=t("../component/ErmjTimeAutoRun"),s=function(t){function e(e){var i=t.call(this)||this;return i.dotList=[],i.curDotIndex=0,i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.timeRun=Global.UIHelper.safeGetComponent(this.getChild("content/timeLbl"),"",r.default),this.timeRun.node.active=!1,this.dotList=[];for(var t=0;t<3;t++){var e=this.getChild("content/action/dot"+t.toString());this.dotList.push(e),e.active=!1}},e.prototype.onOpen=function(){var t=this;this.interval=setInterval(function(){t.startAnim()},400),this.resetAnim(),this.startAnim()},e.prototype.startAnim=function(){this.curDotIndex>=this.dotList.length?this.resetAnim():(this.dotList[this.curDotIndex].active=!0,this.curDotIndex++)},e.prototype.resetAnim=function(){this.curDotIndex=0,this.dotList.forEach(function(t){t.active=!1})},e.prototype.setTimeRunConfig=function(t,e,i){this.timeRun.node.active=!0,this.timeRun.setTimer(t,e,i)},e.prototype.clearByRound=function(){this.active=!1},e.prototype.onClose=function(){clearInterval(this.interval),this.resetAnim(),this.timeRun.node.active=!1},e}(o.default);i.default=s,cc._RF.pop()},{"../component/ErmjTimeAutoRun":"ErmjTimeAutoRun","./ErmjBaseView":"ErmjBaseView"}],ErmjMenuView:[function(t,e,i){"use strict";cc._RF.push(e,"50eeaih/QpGRqCR1FOSWiZ0","ErmjMenuView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseView"),r=t("../data/ErmjPathHelper"),s=t("../data/ErmjGameConst"),l=t("../ErmjDriver"),c=function(t){function e(e){var i=t.call(this)||this;return i.isPressed=!1,i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.bgNode=this.getChild("maskBg"),this.bgNode.active=!1,s.default.addCommonClick(this.bgNode,"",this.onBgTouch,this,cc.Button.Transition.NONE),this.pressDownBtn=this.getChild("menuBtn/sprite_down"),this.pressUpBtn=this.getChild("menuBtn/sprite_up"),s.default.addCommonClick(this.node,"menuBtn",this.onMenuBtnClick,this),this.menuContainer=this.getChild("maskNode/menuContainer"),this.menuRawPos=this.menuContainer.position,this.menuContainer.active=!1,this.menuContainer.setPosition(0,this.menuContainer.height),s.default.addCommonClick(this.node,"maskNode/menuContainer/settingBtn",this.onSettingBtnClick,this),s.default.addCommonClick(this.node,"maskNode/menuContainer/ruleBtn",this.onRuleBtnClick,this),s.default.addCommonClick(this.node,"maskNode/menuContainer/exitBtn",this.onExitBtnClick,this)},e.prototype.onBgTouch=function(){this.bgNode.active=!1,this.menuBtnClick()},e.prototype.menuBtnClick=function(t){if(void 0===t&&(t=!0),this.isPressed){this.isPressed=!1,this.pressUpBtn.active=!1,this.pressDownBtn.active=!0,this.bgNode.active=!1,this.menuContainer.stopAllActions();var e=cc.v2(this.menuRawPos.x,this.menuRawPos.y+this.menuContainer.height);t?this.menuContainer.runAction(cc.moveTo(.2,e).easing(cc.easeBackIn())):this.menuContainer.setPosition(e)}else this.isPressed=!0,this.pressUpBtn.active=!0,this.pressDownBtn.active=!1,this.menuContainer.active=!0,this.bgNode.active=!0,this.menuContainer.stopAllActions(),t?this.menuContainer.runAction(cc.moveTo(.2,cc.v2(this.menuRawPos.x,this.menuRawPos.y)).easing(cc.easeBackOut())):this.menuContainer.setPosition(cc.v2(this.menuRawPos.x,this.menuRawPos.y))},e.prototype.onMenuBtnClick=function(){s.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),this.menuBtnClick()},e.prototype.onSettingBtnClick=function(){this.menuBtnClick(),s.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),l.default.instance.openSettingPop()},e.prototype.onRuleBtnClick=function(){this.menuBtnClick(),s.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),l.default.instance.openRulePop()},e.prototype.onExitBtnClick=function(){var t=this;s.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),this.menuBtnClick(!1),this.Context.get(this.Define.FieldGameStart)?Global.UI.showYesNoBox("\u9000\u51fa\u540e\u5c06\u81ea\u52a8\u53d8\u4e3a\u6258\u7ba1\u51fa\u724c\uff0c\u4e14\u5728\u724c\u5c40\u7ed3\u675f\u524d\u65e0\u6cd5\u8fdb\u5165\u5176\u4ed6\u6e38\u620f\u3002\u786e\u5b9a\u9000\u51fa\u5417\uff1f",function(){Game.Server.send(t.Define.CmdLeave,{IsClose:1}),l.default.instance.leaveGame()}):(Game.Server.send(this.Define.CmdLeave,{IsClose:1}),l.default.instance.leaveGame(),Global.UI.close("WndMessageBox"))},e.prototype.clearByGame=function(){this.isPressed&&this.menuBtnClick(!1)},e}(o.default);i.default=c,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","./ErmjBaseView":"ErmjBaseView"}],ErmjMjPlayerView:[function(t,e,i){"use strict";cc._RF.push(e,"7abc0cnL7NIcJpQd2ijUKiU","ErmjMjPlayerView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../ErmjBaseView"),r=t("./ErmjMahjongOperView"),s=t("../../data/ErmjPathHelper"),l=t("../../tool/ErmjMjStyleHelper"),c=t("./ErmjPlayerHandView"),h=t("../../data/ErmjGameConst"),u=t("../../ErmjDriver"),p=function(t){function e(e,i){var n=t.call(this)||this;return n.nSeat=i,n.outShowCount=0,n.nextOutMjPos=cc.Vec3.ZERO,n.nextflowerMjPos=cc.Vec3.ZERO,n.operViewList=[],n.operCurIndex=0,n.isBright=!1,n.inBeTinged=!1,n.setNode(e),n}return a(e,t),e.prototype.initView=function(){this.outMjMgr=u.default.instance.outMjManager,this.darkHandView=new c.ErmjPlayerDarkHandView(this.getChild("darkView"),this.nSeat),this.darkHandView.active=!1,this.brightHandView=new c.ErmjPlayerBrightHandView(this.getChild("brightView"),this.nSeat),this.brightHandView.active=!1,this.outShowStartWorldPos=this.node.convertToWorldSpaceAR(this.getChild("outStartPoint").position),this.outShowRoot0=this.getChild("outShowRoot0"),this.outShowRoot1=this.getChild("outShowRoot1"),this.outShowRoot2=this.getChild("outShowRoot2"),this.flowerRoot=this.getChild("flowerRoot"),this.operRoot=this.getChild("operRoot"),this.winShowView=new d(this.getChild("winShowRoot"),this.nSeat),this.winShowView.active=!1},e.prototype.setHandMjShow=function(){this.darkHandView.active=!0},e.prototype.setDarkHandMjOutScreen=function(){this.darkHandView.setHandMjOutScreen()},e.prototype.dealHandMj=function(t,e){void 0===t&&(t=1),void 0===e&&(e=[]),this.darkHandView.dealHandMj(t,e)},e.prototype.drawHandMj=function(t){this.inBeTinged?this.brightHandView.drawHandMj(t):this.darkHandView.drawHandMj()},e.prototype.changeFlower=function(t,e){var i=this;this.inBeTinged?this.brightHandView.changeFlower(t,e,function(){i.flowerCardAdd(t)}):this.darkHandView.changeFlower(t,function(){i.flowerCardAdd(t)})},e.prototype.flowerCardAdd=function(t){for(var e=this.nSeat-this.Context.selfLocalSeat,i=0;i<t.length;i++){var n=this.outMjMgr.getOneFlowerMj();n.mahjongValue=t[i],n.isFront=!0,n.node.setParent(this.flowerRoot);var a=this.Define.flowerMjPerspArr[this.flowerCount]||0;n.setPerspStyle(a,e);var o=l.default.getPerspectiveCfg(a),r=o.cfg,s=o.dir;if(n.node.setSiblingIndex(10-this.flowerCount),0==this.flowerCount){n.node.setPosition(cc.Vec3.ZERO);var c=s>0?r.devSpaceX:r.negDevSpaceX,h=0==e?c:-c;this.nextflowerMjPos=cc.v3(h,0)}else n.node.setPosition(this.nextflowerMjPos),c=s>0?r.devSpaceX:r.negDevSpaceX,h=0==e?c:-c,this.nextflowerMjPos=cc.v3(this.nextflowerMjPos.x+h,0);this.flowerCount++,n.active=!0}},e.prototype.readyForOut=function(t){this.inBeTinged?this.brightHandView.readyForOut(t):this.darkHandView.readyForOut()},e.prototype.outCard=function(t){var e=this;this.inBeTinged?this.brightHandView.outCard(t,function(){e.doOutFlyAnim(t)}):this.darkHandView.outCard(t,function(){e.doOutFlyAnim(t)})},e.prototype.doOutFlyAnim=function(t){var e=this,i=this.nSeat-this.Context.selfLocalSeat,n=this.outMjMgr.getOneOutMj();this.outShowCount+=1;var a=[Math.ceil(this.outShowCount/this.Define.OutShowMjMaxCol)-1,(this.outShowCount-1)%this.Define.OutShowMjMaxCol],o=a[0],r=a[1];0==o?n.node.setParent(this.outShowRoot0):1==o?n.node.setParent(this.outShowRoot1):n.node.setParent(this.outShowRoot2),n.mahjongValue=t,n.active=!0,n.isFront=!0;var s=n.node.parent.convertToNodeSpaceAR(this.outShowStartWorldPos),c=this.Define.outMjPerspArr[r],h=l.default.getPerspectiveCfg(c);if(0==r){var u=cc.v3(0,0),p=h.dir>0?h.cfg.devSpaceX:h.cfg.negDevSpaceX,d=0==i?p:-p;this.nextOutMjPos=cc.v3(d,0),n.doOutAnim(s,u,c,i)}else u=this.nextOutMjPos,p=h.dir>0?h.cfg.devSpaceX:h.cfg.negDevSpaceX,d=0==i?p:-p,this.nextOutMjPos=cc.v3(u.x+d,0),n.doOutAnim(s,u,c,i);Game.Component.scheduleOnce(function(){n.node.setSiblingIndex(e.Define.OutShowMjMaxCol-r)},this.Define.outMjShowTime+this.Define.outMjFlyTime+.1)},e.prototype.showOutCardDirectly=function(t){var e=this;void 0===t&&(t=[]);var i=this.nSeat-this.Context.selfLocalSeat;t.forEach(function(t){var n=e.outMjMgr.getOneOutMj();e.outShowCount+=1;var a=[Math.ceil(e.outShowCount/e.Define.OutShowMjMaxCol)-1,(e.outShowCount-1)%e.Define.OutShowMjMaxCol],o=a[0],r=a[1];0==o?n.node.setParent(e.outShowRoot0):1==o?n.node.setParent(e.outShowRoot1):n.node.setParent(e.outShowRoot2),n.mahjongValue=t,n.active=!0,n.isFront=!0;var s=e.Define.outMjPerspArr[r];n.node.setSiblingIndex(e.Define.OutShowMjMaxCol-r);var c=l.default.getPerspectiveCfg(s);if(0==r){var h=cc.v3(0,0),u=c.dir>0?c.cfg.devSpaceX:c.cfg.negDevSpaceX,p=0==i?u:-u;e.nextOutMjPos=cc.v3(p,0),n.node.setPosition(h),n.setPerspStyle(s,i)}else h=e.nextOutMjPos,u=c.dir>0?c.cfg.devSpaceX:c.cfg.negDevSpaceX,p=0==i?u:-u,e.nextOutMjPos=cc.v3(h.x+p,0),n.node.setPosition(h),n.setPerspStyle(s,i)})},e.prototype.reduceOneOutMj=function(){var t=this.nSeat-this.Context.selfLocalSeat,e=[Math.ceil(this.outShowCount/this.Define.OutShowMjMaxCol)-1,(this.outShowCount-1)%this.Define.OutShowMjMaxCol][1],i=this.Define.outMjPerspArr[e],n=l.default.getPerspectiveCfg(i),a=n.dir>0?n.cfg.devSpaceX:n.cfg.negDevSpaceX,o=0==t?a:-a;this.nextOutMjPos=cc.v3(this.nextOutMjPos.x-o,0),this.outShowCount-=1},e.prototype.pongCard=function(t){this.inBeTinged?this.brightHandView.pongCard(t):this.darkHandView.pongCard(t);var e=this.getOneOperView();e.active=!0;var i=this.Define.operMjGroupPerspArr.slice(3*(this.operCurIndex-1),3*this.operCurIndex);e.setPongStyle(t,i)},e.prototype.chowCard=function(t,e){this.inBeTinged?this.brightHandView.chowCard(t,e):this.darkHandView.chowCard(t,e);var i=this.getOneOperView();i.active=!0;var n=this.Define.operMjGroupPerspArr.slice(3*(this.operCurIndex-1),3*this.operCurIndex);i.setChowStyle(t,e,n)},e.prototype.kongCard=function(t,e){if(this.inBeTinged?this.brightHandView.kongCard(t,e):this.darkHandView.kongCard(t,e),5==t){var i=this.findPongKongOper(e[0]),n=i[0],a=i[1];if(n){var o=this.Define.operMjGroupPerspArr.slice(3*(a-1),3*a);n.setKongStyle(e,!0,!1,o)}}else(n=this.getOneOperView()).active=!0,o=this.Define.operMjGroupPerspArr.slice(3*(this.operCurIndex-1),3*this.operCurIndex),n.setKongStyle(e,6!==t,this.nSeat==this.Context.selfLocalSeat||this.inBeTinged,o)},e.prototype.getOneOperView=function(){if(!this.operViewList[this.operCurIndex]){var t=this.nSeat-this.Context.selfLocalSeat,e=Global.ResourceManager.getBundleRes(h.default.Gid,s.default.gamePrefabsPath+"panel/mahjong/mahjongOperView",cc.Prefab),i=cc.instantiate(e);i.setParent(this.operRoot),i.setPosition(this.Define.OperViewSpace[this.nSeat].mul(this.operCurIndex));var n=new r.default(i,t);n.active=!1,this.operViewList[this.operCurIndex]=n}var a=this.operViewList[this.operCurIndex];return this.operCurIndex+=1,a},e.prototype.findPongKongOper=function(t){for(var e=0;e<this.operViewList.length;e++){var i=this.operViewList[e];if(i.value==t&&(i.checkPongValid()||i.checkKongValid()))return[i,e+1]}},e.prototype.robbedKongLose=function(t){var e=this.findPongKongOper(t)[0];e&&e.beKongRobbed()},e.prototype.showDarkKongSeen=function(t){void 0===t&&(t=[]);for(var e=0,i=0;i<this.operViewList.length&&e!=t.length;i++){var n=this.operViewList[i];if(n.checkDarkKongValid()){var a=this.Define.operMjGroupPerspArr.slice(3*i,3*(i+1));n.setKongStyle(t[e],!1,!0,a),e++}}},e.prototype.syncAllOperView=function(t){var e=this;void 0===t&&(t=[]),t.forEach(function(t){var i=e.getOneOperView();i.active=!0;var n=e.Define.operMjGroupPerspArr.slice(3*(e.operCurIndex-1),3*e.operCurIndex),a=t.type,o=t.all_cards||[],r=t.card;2==a?i.setChowStyle(o,r,n):3==a?i.setPongStyle(o,n):i.setKongStyle(o,6!==a,e.nSeat==e.Context.selfLocalSeat,n)})},e.prototype.addWinMjShow=function(t){this.winShowView.active=!0,this.winShowView.addOneHuMjItem(t)},e.prototype.winHideLastDraw=function(t){this.inBeTinged?this.brightHandView.winHideLastDraw(t):this.darkHandView.winHideLastDraw()},e.prototype.setBeInTing=function(){this.inBeTinged=!0},e.prototype.showDownHand=function(t,e,i,n){this.darkHandView.active=!1,this.brightHandView.active=t,this.brightHandView.showDown(e,i,n)},e.prototype.recycleAllOperView=function(){this.operViewList.forEach(function(t){t.active=!1}),this.operCurIndex=0},e.prototype.getLightningWorldPos=function(){return this.winShowView.getWinItemWorldPos()},e.prototype.reset=function(){this.darkHandView.reset(),this.darkHandView.active=!1,this.brightHandView.reset(),this.brightHandView.active=!1,this.flowerCount=0,this.recycleAllOperView(),this.outShowCount=0,this.winShowView.active=!1,this.inBeTinged=!1},e.prototype.clearByRound=function(){this.reset()},e}(o.default);i.default=p;var d=function(t){function e(e,i){var n=t.call(this)||this;return n.nRelative=i,n.winCount=0,n.nextWinMjPos=cc.Vec3.ZERO,n.maxCol=5,n.bgWidthLimit=28,n.bgWidthStep=40,n.mjParentList=[],n.setNode(e),n}return a(e,t),e.prototype.initView=function(){this.outMjMgr=u.default.instance.outMjManager,this.bgSp=this.getComponent("bgSp",cc.Sprite),this.mjRoot=this.getChild("mjRoot")},e.prototype.getMjRoot=function(){var t=Math.ceil(this.winCount/this.maxCol)-1;if(!this.mjParentList[t]){var e=cc.instantiate(this.mjRoot);e.setParent(this.node),e.scale=this.mjRoot.scale,e.position=this.mjRoot.position,this.mjParentList[t]=e}return this.mjParentList[t]},e.prototype.addOneHuMjItem=function(t){this.winCount++;var e=[Math.ceil(this.winCount/this.maxCol)-1,(this.winCount-1)%this.maxCol],i=e[0],n=e[1],a=this.outMjMgr.getOneWinMj();a.mahjongValue=t,a.active=!0,a.isFront=!0;var o=this.getMjRoot();a.node.setParent(o);var r=this.Define.winMjPerspArr[n]||0;a.setPerspStyle(r,this.nRelative);var s=l.default.getPerspectiveCfg(r),c=s.cfg,h=s.dir;if(a.node.setSiblingIndex(0),0==n){a.node.setPosition(cc.v3(0,i*this.Define.winMoreOffsetY));var u=h>0?c.devSpaceX:c.negDevSpaceX,p=0==this.nRelative?u:-u;this.nextWinMjPos=cc.v3(p,i*this.Define.winMoreOffsetY)}else a.node.setPosition(this.nextWinMjPos),u=h>0?c.devSpaceX:c.negDevSpaceX,p=0==this.nRelative?u:-u,this.nextWinMjPos=cc.v3(this.nextWinMjPos.x+p,i*this.Define.winMoreOffsetY);this.updateBgWidth()},e.prototype.updateBgWidth=function(){if(this.winCount>=this.maxCol)this.bgSp.node.width=this.bgWidthLimit+this.maxCol*this.bgWidthStep;else{var t=this.winCount%this.maxCol;this.bgSp.node.width=this.bgWidthLimit+t*this.bgWidthStep}},e.prototype.getWinItemWorldPos=function(){var t=this.outMjMgr.getLastWinMj();return t&&t.active?t.node.parent.convertToWorldSpaceAR(t.node.position):this.node.convertToWorldSpaceAR(cc.Vec3.ZERO)},e.prototype.onClose=function(){this.winCount=0},e}(o.default);cc._RF.pop()},{"../../ErmjDriver":"ErmjDriver","../../data/ErmjGameConst":"ErmjGameConst","../../data/ErmjPathHelper":"ErmjPathHelper","../../tool/ErmjMjStyleHelper":"ErmjMjStyleHelper","../ErmjBaseView":"ErmjBaseView","./ErmjMahjongOperView":"ErmjMahjongOperView","./ErmjPlayerHandView":"ErmjPlayerHandView"}],ErmjMjStyleHelper:[function(t,e,i){"use strict";var n,a;cc._RF.push(e,"af5d4XUi8VAs73D6HdQiC9E","ErmjMjStyleHelper"),Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjRelativeDefine=void 0,function(t){t[t.Self=0]="Self",t[t.Opposite=1]="Opposite"}(a=i.ErmjRelativeDefine||(i.ErmjRelativeDefine={}));var o=function(){function t(){}return t.getPerspectiveCfg=function(t){var e=Math.abs(t);if(!this.perspectiveCfgArr[e])return console.error("error \u627e\u4e0d\u5230\u5bf9\u5e94\u900f\u89c6\u7b49\u7ea7\u914d\u7f6e",t),{cfg:this.perspectiveCfgArr[0],dir:1};var i=t>=0?1:-1;return{cfg:this.perspectiveCfgArr[e],dir:i}},t.mjHandMap={1:"majiang1_wan_1",2:"majiang1_wan_2",3:"majiang1_wan_3",4:"majiang1_wan_4",5:"majiang1_wan_5",6:"majiang1_wan_6",7:"majiang1_wan_7",8:"majiang1_wan_8",9:"majiang1_wan_9",11:"",12:"",13:"",14:"",15:"",16:"",17:"",18:"",19:"",21:"",22:"",23:"",24:"",25:"",26:"",27:"",28:"",29:"",31:"majiang1_dong",32:"majiang1_nan",33:"majiang1_xi",34:"majiang1_bei",35:"majiang1_zhong",36:"majiang1_fa",37:"majiang1_baiban",41:"majiang1_chun",42:"majiang1_xia",43:"majiang1_qiu",44:"majiang1_dong-1",45:"majiang1_mei",46:"majiang1_lanhua",47:"majiang1_zhu",48:"majiang1_ju"},t.mjOutMap={1:"majiang2_wan_1",2:"majiang2_wan_2",3:"majiang2_wan_3",4:"majiang2_wan_4",5:"majiang2_wan_5",6:"majiang2_wan_6",7:"majiang2_wan_7",8:"majiang2_wan_8",9:"majiang2_wan_9",11:"",12:"",13:"",14:"",15:"",16:"",17:"",18:"",19:"",21:"",22:"",23:"",24:"",25:"",26:"",27:"",28:"",29:"",31:"majiang2_dong",32:"majiang2_nan",33:"majiang2_xi",34:"majiang2_bei",35:"majiang2_zhong",36:"majiang2_fa",37:"majiang2_baiban",41:"majiang2_chun",42:"majiang2_xia",43:"majiang2_qiu",44:"majiang2_dong-1",45:"majiang2_mei",46:"majiang2_lanhua",47:"majiang2_zhu",48:"majiang2_ju"},t.mjOutSoundMap={1:"mj1wan",2:"mj2wan",3:"mj3wan",4:"mj4wan",5:"mj5wan",6:"mj6wan",7:"mj7wan",8:"mj8wan",9:"mj9wan",11:"",12:"",13:"",14:"",15:"",16:"",17:"",18:"",19:"",21:"",22:"",23:"",24:"",25:"",26:"",27:"",28:"",29:"",31:"mj31",32:"mj32",33:"mj33",34:"mj34",35:"mj35",36:"mj36",37:"mj37",41:"",42:"",43:"",44:"",45:"",46:"",47:"",48:""},t.SpecialBgColor=cc.color(144,251,251,255),t.NormalBgColor=cc.Color.WHITE,t.mjOutStyle=((n={})[a.Self]={frontAngle:0,perspScale:1},n[a.Opposite]={frontAngle:180,perspScale:-1},n),t.perspectiveCfgArr=[{bgSp:"majiang6_1",backSp:"majiang6_11",frontSkewX:0,devSpaceX:48,negDevSpaceX:46},{bgSp:"majiang6_2",backSp:"majiang6_12",frontSkewX:0,devSpaceX:46,negDevSpaceX:48},{bgSp:"majiang6_3",backSp:"majiang6_13",frontSkewX:-4,devSpaceX:47.5,negDevSpaceX:46},{bgSp:"majiang6_4",backSp:"majiang6_14",frontSkewX:-8,devSpaceX:49.5,negDevSpaceX:47.5},{bgSp:"majiang6_5",backSp:"majiang6_15",frontSkewX:-12,devSpaceX:46,negDevSpaceX:49.5},{bgSp:"majiang6_6",backSp:"majiang6_16",frontSkewX:-16,devSpaceX:47,negDevSpaceX:46},{bgSp:"majiang6_7",backSp:"majiang6_17",frontSkewX:-20,devSpaceX:46,negDevSpaceX:47},{bgSp:"majiang6_8",backSp:"majiang6_18",frontSkewX:-22,devSpaceX:47.5,negDevSpaceX:46},{bgSp:"majiang6_9",backSp:"majiang6_19",frontSkewX:-24,devSpaceX:48,negDevSpaceX:47.5},{bgSp:"majiang6_10",backSp:"majiang6_20",frontSkewX:-26,devSpaceX:46,negDevSpaceX:48}],t}();i.default=o,cc._RF.pop()},{}],ErmjOutMjViewManager:[function(t,e,i){"use strict";cc._RF.push(e,"e57b7F1ZTdNuYoYooL4qPxK","ErmjOutMjViewManager");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../tool/ErmjBasePool"),r=t("../subView/mahjong/ErmjMahjongOutView"),s=t("../data/ErmjPathHelper"),l=t("../data/ErmjGameConst"),c=function(){function t(t){this.rootNode=t,this.inUsedOutMjList=[],this.inUsedFlowerMjList=[],this.inUsedBrightMjList=[],this.inUsedWinMjList=[],this.rootNode.active=!1,this.poolHelper=new h(this.rootNode)}return t.prototype.getOneBrightMj=function(){var t=this.poolHelper.getItem();return this.inUsedBrightMjList.push(t),t},t.prototype.getOneFlowerMj=function(){var t=this.poolHelper.getItem();return this.inUsedFlowerMjList.push(t),t},t.prototype.getOneOutMj=function(){var t=this.poolHelper.getItem();return this.inUsedOutMjList.push(t),t},t.prototype.getOneWinMj=function(){var t=this.poolHelper.getItem();return this.inUsedWinMjList.push(t),t},t.prototype.getLastOutMj=function(){var t=this.inUsedOutMjList.length;return this.inUsedOutMjList[t-1]},t.prototype.getLastWinMj=function(){var t=this.inUsedWinMjList.length;return this.inUsedWinMjList[t-1]},t.prototype.recycleLastOutMj=function(){var t=this.inUsedOutMjList.pop();this.poolHelper.recycleItem(t)},t.prototype.recycleOneOutMj=function(){},t.prototype.clear=function(){this.poolHelper.recycleAll(this.inUsedOutMjList),this.inUsedOutMjList=[],this.poolHelper.recycleAll(this.inUsedFlowerMjList),this.inUsedFlowerMjList=[],this.poolHelper.recycleAll(this.inUsedBrightMjList),this.inUsedBrightMjList=[],this.poolHelper.recycleAll(this.inUsedWinMjList),this.inUsedWinMjList=[]},t}();i.default=c;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),Object.defineProperty(e.prototype,"preCount",{get:function(){return 30},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"everyCount",{get:function(){return 30},enumerable:!1,configurable:!0}),e.prototype.createItem=function(){var t=Global.ResourceManager.getBundleRes(l.default.Gid,s.default.gamePrefabsPath+"panel/mahjong/mahjongOutView",cc.Prefab),e=cc.instantiate(t);return new r.default(e)},e.prototype.resetItem=function(t){t.reset(),t.node.setParent(this.root),t.active=!1},e}(o.default);cc._RF.pop()},{"../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","../subView/mahjong/ErmjMahjongOutView":"ErmjMahjongOutView","../tool/ErmjBasePool":"ErmjBasePool"}],ErmjPathHelper:[function(t,e,i){"use strict";cc._RF.push(e,"fce612sZEJEFrITBsOMMytS","ErmjPathHelper"),Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjAudioConst=void 0;var n=function(){function t(){}return t.prototype.atlasPath=function(e){return t.gameTexturePath+e},t.basePath="",t.gameAudioPath=t.basePath+"sound/",t.gamePrefabsPath=t.basePath+"prefabs/",t.gameTexturePath=t.basePath+"texture/",t.gameEffectPath=t.basePath+"effect/",t}();i.default=n;var a=function(){function t(){}return t.genderSoundPath=function(t,e){void 0===e&&(e=0);var i=this.audioHumanPath+"man/";return 1==e&&(i=this.audioHumanPath+"woman/"),i+t},t.audioHumanPath=n.gameAudioPath+"human/",t.bgm=n.gameAudioPath+"bgm",t.commonAudio={ButtonClick:n.gameAudioPath+"ButtonClick",Dice:n.gameAudioPath+"Dice",DrawCard:n.gameAudioPath+"DrawCard",Hu:n.gameAudioPath+"Hu",RewardLose:n.gameAudioPath+"Lose",OutCard:n.gameAudioPath+"OutCard",SeatDown:n.gameAudioPath+"Seat",RewardWin:n.gameAudioPath+"Win",ContinueGame:n.gameAudioPath+"ContinueGame",DealCard:n.gameAudioPath+"DealCard"},t}();i.ErmjAudioConst=a,cc._RF.pop()},{}],ErmjPlayHandler:[function(t,e,i){"use strict";cc._RF.push(e,"c17c5jOd05MlKPbp9uWj2qF","ErmjPlayHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjKongHandler=i.ErmjPongHandler=i.ErmjChowHandler=i.ErmjPlayHandler=i.ErmjCallPlayHandler=i.ErmjPlayStartHandler=void 0;var o=t("./ErmjBaseHandler"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(){this.context.set(this.Define.FieldHandActionEnable,!0),this.mainUI.diceAnimComp.node.active=!1,this.mainUI.askBtnView.setAutoPlayBtnShow(!0)},e}(o.default);i.ErmjPlayStartHandler=r;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=this;this.mainUI.callAllPlayers("showStateSp",!1),this.mainUI.askActionView.active=!1;var i=0,n=t._times;if(n&&Game.Component.correctTime){var a=Game.Component.correctTime(n);i=1e3*t._timeo-a}else i=1e3*t._timeo-(Date.now()-t._receiveTime);(!i||i<=0)&&(i=1e3);var o=this.SitHelper.serverSToLocalN(t._src);this.mainUI.askNoticeView.whichLocationTurn(o),this.mainUI.askNoticeView.setTimeRunConfig(Math.round(i/1e3),null,null),Game.Component.scheduleOnce(function(){e.mainUI.callMjPlayer(o,"readyForOut",t._para.draw_card)},0),0==o&&(this.context.set(this.Define.FieldInPlayTurn,!0),this.mainUI.selfPlayView.showPlayTips(!0),this.mainUI.selfPlayView.readyForOut(t._para.draw_card))},e}(o.default);i.ErmjCallPlayHandler=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=this.SitHelper.serverSToLocalN(t._src);0==e&&(this.context.set(this.Define.FieldInPlayTurn,!1),this.mainUI.selfPlayView.showPlayTips(!1),this.mainUI.askActionView.active=!1),this.mainUI.onPlay(e,t._para.card,1==t._para.flag)},e.prototype.executeSync=function(){},e}(o.default);i.ErmjPlayHandler=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=this.SitHelper.serverSToLocalN(t._src),i=this.SitHelper.serverSToLocalN(t._para.who);this.mainUI.onChow(e,t._para.cards,t._para.chow_card,i)},e}(o.default);i.ErmjChowHandler=c;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=this.SitHelper.serverSToLocalN(t._src),i=this.SitHelper.serverSToLocalN(t._para.who);this.mainUI.onPong(e,t._para.cards,i)},e}(o.default);i.ErmjPongHandler=h;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=this.SitHelper.serverSToLocalN(t._src),i=this.SitHelper.serverSToLocalN(t._para.who);this.mainUI.onKong(e,t._para.cards||[],t._para.type,i)},e}(o.default);i.ErmjKongHandler=u,cc._RF.pop()},{"./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjPlayerHandView:[function(t,e,i){"use strict";cc._RF.push(e,"5ccf71/UrlPs6/wFY2S9eaR","ErmjPlayerHandView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjPlayerBrightHandView=i.ErmjPlayerDarkHandView=void 0;var o=t("../ErmjBaseView"),r=t("./ErmjMahjongHandView"),s=t("../../data/ErmjGameEvent"),l=t("../../tool/ErmjMjStyleHelper"),c=t("../../ErmjDriver"),h=function(t){function e(e,i){var n=t.call(this)||this;return n.nSeat=i,n.mjHandList=[],n.validMjList=[],n.validCount=0,n.inRoundDeal=!1,n.setNode(e),n}return a(e,t),e.prototype.initView=function(){this.handLayout=this.getComponent("handLayout",cc.Layout);var t=this.getChild("mahjongHandView");t.active=!1,this.lastDealMjItem=new r.default(t),this.lastDealMjItem.active=!1;for(var e=0;e<this.Define.HandMjMaxCount+1;e++){var i=cc.instantiate(t);i.setParent(this.handLayout.node),i.active=!0;var n=new r.default(i);n.active=!1,n.isOut=!1,this.mjHandList.push(n)}},e.prototype.setHandMjShow=function(t){this.handLayout.node.active=t},e.prototype.setHandMjOutScreen=function(){this.handLayout.node.setPosition(cc.v3(0,-1e3))},e.prototype.dealHandMj=function(t,e){void 0===t&&(t=1),void 0===e&&(e=[]),this.inRoundDeal=!1;for(var i=0;i<t;i++){this.validCount++;var n=this.mjHandList[this.validCount-1];n&&(n.active=!0,n.isOut=!1,n.isFront=!1)}this.updateValidPokers()},e.prototype.drawHandMj=function(){var t=this.validCount-1;if(Logger.error("drawHandMj",this.nSeat,this.validCount),this.validMjList[t]){this.inRoundDeal=!0,this.lastDealMjItem.active=!0,this.lastDealMjItem.isFront=!1,this.lastDealMjItem.isOut=!1;var e=this.validMjList[t].getWorldPos(),i=this.lastDealMjItem.node.parent.convertToNodeSpaceAR(e);this.lastDealMjItem.node.setPosition(i.add(this.Define.LastOneDealOffset[this.nSeat])),this.validCount+=1}},e.prototype.changeFlower=function(t,e){var i=this,n=0,a=t.length;if(this.inRoundDeal&&this.lastDealMjItem&&(this.lastDealMjItem.doChangeFlower(0,.2,.2),n+=1),n<a)for(var o=this.validCount-a;o<this.validCount;o++){var r=this.validMjList[o];r&&r.doChangeFlower(0,.2,.2)}Game.Component.scheduleOnce(function(){e&&e(),Game.Event.event(s.default.doPatchwork,a)},.2),this.inRoundDeal||Game.Component.scheduleOnce(function(){i.sortCardDirectly()},.71)},e.prototype.readyForOut=function(){if(!this.inRoundDeal){var t=this.validMjList.pop();t.active=!1,t.isOut=!0,this.inRoundDeal=!0,this.lastDealMjItem.mahjongValue=t.mahjongValue,this.lastDealMjItem.active=!0,this.lastDealMjItem.isOut=!1;var e=this.validMjList[this.validMjList.length-1].getWorldPos(),i=this.lastDealMjItem.node.parent.convertToNodeSpaceAR(e);this.lastDealMjItem.node.setPosition(i.add(this.Define.LastOneDealOffset[this.nSeat]))}},e.prototype.outCard=function(t,e){var i=this,n=this.getOutItem();n&&!n.isOut?(this.handLayout.enabled=!1,n.active=!1,n.isOut=!0,e&&e(),Game.Component.scheduleOnce(function(){i.handLayout.enabled=!0,i.updateValidPokers(),i.sortCardDirectly(!1),i.inRoundDeal=!1,i.validCount-=1},.5)):console.error("outCard outIndex == -1",this.validCount,n)},e.prototype.pongCard=function(){this.getRightMjItem(2).forEach(function(t){t.active=!1,t.isOut=!0}),this.validCount-=2,this.sortCardDirectly(!1)},e.prototype.chowCard=function(){this.getRightMjItem(2).forEach(function(t){t.active=!1,t.isOut=!0}),this.validCount-=2,this.sortCardDirectly(!1)},e.prototype.kongCard=function(t){if(4==t)this.getRightMjItem(3).forEach(function(t){t.active=!1,t.isOut=!0}),this.validCount-=3;else if(5==t){var e=this.getOutItem();e.active=!1,e.isOut=!0,this.validCount-=1}else 6==t&&(Global.Toolkit.getRoundInteger(0,10)<=5&&this.inRoundDeal?(this.getRightMjItem(3).forEach(function(t){t.active=!1,t.isOut=!0}),this.lastDealMjItem.active=!1,this.lastDealMjItem.isOut=!0):this.getRightMjItem(4).forEach(function(t){t.active=!1,t.isOut=!0}),this.validCount-=4);this.sortCardDirectly(!1)},e.prototype.getOutItem=function(){var t=this.validCount,e=Global.Toolkit.getRoundInteger(t);return this.inRoundDeal&&e==this.validCount-1?this.lastDealMjItem:this.validMjList[e]},e.prototype.getRightMjItem=function(t){return this.validMjList.slice(this.validMjList.length-t,this.validMjList.length)},e.prototype.winHideLastDraw=function(){this.inRoundDeal&&this.lastDealMjItem.active&&(this.lastDealMjItem.active=!1,this.lastDealMjItem.isOut=!0,this.inRoundDeal=!1)},e.prototype.sortCardDirectly=function(t){if(void 0===t&&(t=!1),this.inRoundDeal&&!this.lastDealMjItem.isOut){for(var e=0;e<this.mjHandList.length;e++){var i=this.mjHandList[e];if(!i.active&&i.isOut){i.active=!0,i.isOut=!1,i.mahjongValue=this.lastDealMjItem.mahjongValue;break}}this.lastDealMjItem.active=!1,this.lastDealMjItem.isOut=!0}this.updateValidPokers(),this.sortMjHandList()},e.prototype.updateValidPokers=function(){this.validMjList=[],this.validMjList=this.mjHandList.filter(function(t){return t.active&&!t.isOut})},e.prototype.sortMjHandList=function(){this.mjHandList.sort(function(t,e){return t.mahjongValue&&e.mahjongValue?t.mahjongValue-e.mahjongValue:0})},e.prototype.reset=function(){this.inRoundDeal=!1,this.validCount=0,this.mjHandList.forEach(function(t){t.active=!1,t.isSelect&&t.onSelect(),t.reset()}),this.lastDealMjItem.active=!1,this.lastDealMjItem.reset(),this.handLayout.enabled=!0},e}(o.default);i.ErmjPlayerDarkHandView=h;var u=function(t){function e(e,i){var n=t.call(this)||this;return n.nSeat=i,n.handBrightMjList=[],n.validValueArr=[],n.inRoundDeal=!1,n.outMjMgr=c.default.instance.outMjManager,n.setNode(e),n}return a(e,t),e.prototype.initView=function(){this.handListNode=this.getChild("handList")},e.prototype.showDown=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n=0,a=this.nSeat-this.Context.selfLocalSeat,o=cc.Vec3.ZERO,r=0==a?cc.v3(10,0):cc.v3(-10,0);i&&t.sort(function(t,e){return t-e});for(var s=0;s<t.length;s++){var c=this.handBrightMjList[s];c||(c=this.getOneBrightMj());var h=this.Define.winBrightMjPerspArr[n]||0;c.active=!0,c.mahjongValue=t[s],c.isFront=!0,c.setPerspStyle(h,a);var u=l.default.getPerspectiveCfg(h);if(c.node.setSiblingIndex(14-n),e&&t.length-1==s)c.node.setPosition(o.add(r)),c.active=!1;else{c.node.setPosition(o);var p=u.dir>0?u.cfg.devSpaceX:u.cfg.negDevSpaceX,d=0==a?p:-p;o=cc.v3(o.x+d,0)}n++,this.validValueArr.push(t[s])}},e.prototype.updateBrightMjList=function(t){var e=this.validValueArr.length-this.handBrightMjList.length;if(e>0)for(var i=0;i<e;i++)this.getOneBrightMj();var n=0,a=this.nSeat-this.Context.selfLocalSeat,o=cc.Vec3.ZERO,r=0==a?cc.v3(10,0):cc.v3(-10,0);for(i=0;i<this.handBrightMjList.length;i++){var s=this.handBrightMjList[i],c=this.validValueArr[i];if(c){var h=this.Define.winBrightMjPerspArr[n]||0;s.active=!0,s.mahjongValue=c,s.isFront=!0,s.setPerspStyle(h,a);var u=l.default.getPerspectiveCfg(h);if(s.node.setSiblingIndex(14-n),t&&this.validValueArr.length-1==i)s.node.setPosition(o.add(r));else{s.node.setPosition(o);var p=u.dir>0?u.cfg.devSpaceX:u.cfg.negDevSpaceX,d=0==a?p:-p;o=cc.v3(o.x+d,0)}}else s.active=!1;n++}},e.prototype.drawHandMj=function(t){this.inRoundDeal=!0,this.validValueArr.push(t),this.updateBrightMjList(!0)},e.prototype.readyForOut=function(t){if(!this.inRoundDeal){this.sortValidValueList();var e=this.validValueArr.indexOf(t);e>-1&&(this.validValueArr.splice(e,1),this.validValueArr.push(t)),this.updateBrightMjList(!0)}},e.prototype.changeFlower=function(t,e,i){if(1!=t.length)return console.error("error \u53ea\u4f1a\u8fdb\u6478\u724c\u8865\u82b1\u9636\u6bb5",t.length);var n=t[0],a=e[0],o=this.findMjItemByValue(n);if(o){o.active=!1,i&&i();var r=this.validValueArr.indexOf(n);r>-1&&this.validValueArr.splice(r,1),this.validValueArr.push(a),Game.Component.scheduleOnce(function(){o.active=!0,o.mahjongValue=a},.4)}},e.prototype.outCard=function(t,e){var i=this;this.inRoundDeal=!1;var n=this.findMjItemByValue(t);if(n){e&&e(),n.active=!1;for(var a=-1,o=this.validValueArr.length-1;o>=0;o--)if(this.validValueArr[o]==t){a=o;break}a>-1&&this.validValueArr.splice(a,1),Game.Component.scheduleOnce(function(){i.sortValidValueList(),i.updateBrightMjList(!1)},.5)}},e.prototype.pongCard=function(t){for(var e=2,i=0;i<t.length;i++){this.findMjItemByValue(t[i]).active=!1;var n=this.validValueArr.indexOf(t[i]);if(n>-1&&this.validValueArr.splice(n,1),0==--e)break}this.updateBrightMjList(!1)},e.prototype.chowCard=function(t,e){for(var i=2,n=0;n<t.length;n++){var a=t[n];if(a!=e){this.findMjItemByValue(a).active=!1;var o=this.validValueArr.indexOf(a);if(o>-1&&this.validValueArr.splice(o,1),0==--i)break}}this.updateBrightMjList(!1)},e.prototype.kongCard=function(t,e){if(4==t)for(var i=3,n=0;n<e.length;n++){var a=e[n];if(this.findMjItemByValue(a).active=!1,(o=this.validValueArr.indexOf(a))>-1&&this.validValueArr.splice(o,1),0==--i)break}else if(5==t)a=e[0],this.findMjItemByValue(a).active=!1,(o=this.validValueArr.indexOf(a))>-1&&this.validValueArr.splice(o,1);else if(6==t)for(i=4,n=0;n<e.length;n++){var o;if(a=e[n],this.findMjItemByValue(a).active=!1,(o=this.validValueArr.indexOf(a))>-1&&this.validValueArr.splice(o,1),0==--i)break}this.updateBrightMjList(!1)},e.prototype.winHideLastDraw=function(t){var e=this.handBrightMjList[this.validValueArr.length-1];this.inRoundDeal&&e&&e.mahjongValue==t&&(e.active=!1,this.inRoundDeal=!1)},e.prototype.getOneBrightMj=function(){var t=this.outMjMgr.getOneBrightMj();return t.node.setParent(this.handListNode),this.handBrightMjList.push(t),t},e.prototype.findMjItemByValue=function(t){for(var e=this.handBrightMjList.length-1;e>=0;e--){var i=this.handBrightMjList[e];if(i.active&&i.mahjongValue==t)return i}},e.prototype.sortValidValueList=function(){this.validValueArr.sort(function(t,e){return t-e})},e.prototype.reset=function(){this.inRoundDeal=!1,this.handBrightMjList=[],this.validValueArr=[]},e}(o.default);i.ErmjPlayerBrightHandView=u,cc._RF.pop()},{"../../ErmjDriver":"ErmjDriver","../../data/ErmjGameEvent":"ErmjGameEvent","../../tool/ErmjMjStyleHelper":"ErmjMjStyleHelper","../ErmjBaseView":"ErmjBaseView","./ErmjMahjongHandView":"ErmjMahjongHandView"}],ErmjPlayerView:[function(t,e,i){"use strict";cc._RF.push(e,"dcd4dTzO5RGYaGYvakbO7m5","ErmjPlayerView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../ErmjBaseView"),r=t("../../ErmjDriver"),s=t("../../data/ErmjPathHelper"),l=t("../../data/ErmjRuleConst"),c=t("../../data/ErmjGameConst"),h=t("../../data/ErmjGameEvent"),u=function(t){function e(e,i){var n=t.call(this)||this;return n.viewSeat=i,n._someone=!1,n.clientSit=0,n.setNode(e),n}return a(e,t),e.prototype.initView=function(){this.matchPos=this.getChild("matchPoint").position,this.infoNode=this.getChild("info"),this.infoRawPos=this.infoNode.position,this.headImg=this.getComponent("info/mask/headImg",cc.Sprite),this.emjoyNode=this.getChild("info/emjoyNode"),c.default.addCommonClick(this.emjoyNode,"",this.onHeadClick,this,cc.Button.Transition.NONE),this.headBox=this.getComponent("info/headBox",cc.Sprite),this.nameLbl=this.getComponent("info/nameLbl",cc.Label),this.coinLbl=this.getComponent("info/coinLbl",cc.Label),this.bankerIcon=this.getChild("info/banker"),this.bankerIcon.active=!1,this.stateSp=this.getComponent("info/state",cc.Sprite),this.stateSp.node.active=!1,this.stateEffect=this.getComponent("info/state/effect",sp.Skeleton),this.fanTypeNode=this.getChild("info/fanType"),this.fanTypeNode.active=!1,this.typeBgSp=this.getComponent("info/fanType/bgSp",cc.Sprite),this.typeSp=this.getComponent("info/fanType/bgSp/typeSp",cc.Sprite),this.typeSk=this.getComponent("info/fanType/effect",sp.Skeleton),this.typeStartPos=this.typeBgSp.node.position,this.tingSignNode=this.getChild("info/tingNode"),this.tingSignNode.active=!1,this.autoSign=this.getChild("info/auto"),this.autoSign.active=!1,this.headTipsRoot=this.getChild("headTipsRoot"),this.headTipsRootRawPos=this.headTipsRoot.position},e.prototype.getHeadTipWorldPos=function(){return this.headTipsRoot.parent.convertToWorldSpaceAR(this.headTipsRootRawPos)},e.prototype.onHeadClick=function(){0!=this.viewSeat&&(c.default.playSound(s.ErmjAudioConst.commonAudio.ButtonClick,!0),Game.Event.event(h.default.onUserInfoTouch,this.clientSit,this.getHeadTipWorldPos()))},Object.defineProperty(e.prototype,"someone",{get:function(){return this._someone},enumerable:!1,configurable:!0}),e.prototype.show=function(t){this.node.active=!0,this.setPlayerInfo(t.nickname),this.loadHeadImg(t.headimg),this.loadHeadBox(t.headkuang),this.setPlayerPoint(t.point),this.Context.isWaitMatch&&this.setMatching(),this._someone=null!=t},e.prototype.setPlayerInfo=function(t){this.nameLbl.string=t},e.prototype.loadHeadImg=function(t){var e=this.headImg.node.width,i=this.headImg.node.height;this.headImg.spriteFrame=Global.Toolkit.getLocalHeadSf(t),this.headImg.node.width=e,this.headImg.node.height=i},e.prototype.loadHeadBox=function(t){var e=this.headBox.node.width,i=this.headBox.node.height;r.default.instance.LoadVipHeadKuang(this.headBox,t),this.headBox.node.width=e,this.headBox.node.height=i},e.prototype.setPlayerPoint=function(t){this.coinLbl.string=Global.Toolkit.formatPointStr(t,!0)},e.prototype.hide=function(){this.node.active=!1,this.nameLbl.string="",this.coinLbl.string=""},e.prototype.showBanker=function(t){this.bankerIcon.active=t},e.prototype.setMatching=function(){this.infoNode.setPosition(this.matchPos)},e.prototype.setMatched=function(t,e){void 0===e&&(e=.5),t?(this.infoNode.setPosition(this.matchPos),Game.Tween.get(this.infoNode).to(e,{position:this.infoRawPos},cc.easeCubicActionOut()).start()):this.infoNode.setPosition(this.infoRawPos)},e.prototype.showStateSp=function(t,e){this.stateSp.node.active=t,this.stateEffect.clearTracks(),t&&(this.stateEffect.setAnimation(0,"idle",!1),Global.ResourceManager.loadBundleAutoAtlas(c.default.Gid,this.stateSp,s.default.gameTexturePath+"dynamic/atlas_dynamic",e,null,!0))},e.prototype.showTingSign=function(t){this.tingSignNode.active=t},e.prototype.showFanType=function(t,e){var i=this;if(this.fanTypeNode.active=t,t){this.typeSk.clearTracks(),this.typeBgSp.node.stopAllActions();var n=l.default.cardTypeConfig[e]||{};Global.ResourceManager.loadBundleAutoAtlas(c.default.Gid,this.typeBgSp,s.default.gameTexturePath+"dynamic/atlas_dynamic",n.bg,null,!0),Global.ResourceManager.loadBundleAutoAtlas(c.default.Gid,this.typeSp,s.default.gameTexturePath+"type/atlas_type",n.sp,null,!0),this.typeSk.setAnimation(0,"idle",!1);var a=this.typeStartPos.add(cc.v3(-150,0));this.typeBgSp.node.setPosition(this.typeStartPos),this.typeBgSp.node.opacity=1;var o=cc.spawn([cc.moveTo(.4,cc.v2(a.x,a.y)).easing(cc.easeCubicActionOut()),cc.fadeTo(.2,255)]);this.typeBgSp.node.runAction(cc.sequence([o,cc.delayTime(1.1),cc.callFunc(function(){i.fanTypeNode.active=!1},this)]))}},e.prototype.showAutoSign=function(t){this.autoSign.active=t},e.prototype.getPlayerHeadCenterPos=function(){return this.headImg.node.parent.convertToWorldSpaceAR(this.headImg.node.position)},e.prototype.clearByRound=function(){this.autoSign.active=!1,this.bankerIcon.active=!1,this.tingSignNode.active=!1,this.showStateSp(!1),this.showFanType(!1),this.infoNode.setPosition(this.infoRawPos)},e}(o.default);i.default=u,cc._RF.pop()},{"../../ErmjDriver":"ErmjDriver","../../data/ErmjGameConst":"ErmjGameConst","../../data/ErmjGameEvent":"ErmjGameEvent","../../data/ErmjPathHelper":"ErmjPathHelper","../../data/ErmjRuleConst":"ErmjRuleConst","../ErmjBaseView":"ErmjBaseView"}],ErmjRewardHandler:[function(t,e,i){"use strict";cc._RF.push(e,"ec007q1tspA0pywllH6/cNJ","ErmjRewardHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../ErmjDriver"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){var e=this;this.mainUI.askBtnView.setAutoPlayBtnShow(!0),this.context.set(this.Define.FieldInSettle,!0),this.mainUI.callAllPlayers("showStateSp",!1),this.mainUI.askNoticeView.setTimerShow(!1),this.mainUI.selfPlayView.resetSelectMj(),this.mainUI.selfPlayView.active=!1,this.mainUI.askActionView.active=!1;var i=t._para.win_flag,n=t._para.details||{},a=t._para.all_hand_cards||{},r=t._para.all_an_kongs||{},s=0;for(var l in a){var c=this.SitHelper.serverSToLocalN(Number(l));this.mainUI.callMjPlayer(c,"showDownHand",!0,a[l],!!n[l]),c!=this.context.selfLocalSeat&&this.mainUI.callMjPlayer(c,"showDarkKongSeen",r[l]||[])}s+=.5,0!=i&&(Game.Component.scheduleOnce(function(){for(var t in n){var i=n[t],a=e.SitHelper.serverSToLocalN(Number(t)),o=1e4;for(var r in i.fan_detail)o>Number(r)&&(o=Number(r));1e4!=o&&e.mainUI.callPlayer(a,"showFanType",!0,o)}},s),s+=1.5),Game.Component.scheduleOnce(function(){0==i?e.mainUI.flowView.active=!0:(e.mainUI.settleView.active=!0,e.mainUI.settleView.showSettleInfo(1==i,t._para.award,t._para.fan,n,a))},s),o.default.instance.mainUI.taskManager.reqGetCommisionInfo(),Game.Event.event(Game.EVENT_ADDTIMELOCK,"ErmjLeaveHandler",s+.1)},e.prototype.executeSync=function(t){this.mainUI.diceAnimComp.node.active=!1,this.context.set(this.Define.FieldInSettle,!0),this.mainUI.callAllPlayers("showStateSp",!1),this.mainUI.askNoticeView.setTimerShow(!1),this.mainUI.selfPlayView.resetSelectMj(),this.mainUI.selfPlayView.active=!1;var e=t._para.win_flag,i=t._para.details||{},n=t._para.all_hand_cards||{},a=t._para.all_an_kongs||{};for(var o in n){var r=this.SitHelper.serverSToLocalN(Number(o));this.mainUI.callMjPlayer(r,"showDownHand",!0,n[o],!!i[o]),r!=this.context.selfLocalSeat&&this.mainUI.callMjPlayer(r,"showDarkKongSeen",a[o]||[])}0==e?this.mainUI.flowView.active=!0:(this.mainUI.settleView.active=!0,this.mainUI.settleView.showSettleInfo(1==e,t._para.award,t._para.fan,i,n))},e}(t("./ErmjBaseHandler").default);i.default=r,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjRubMjAnim:[function(t,e,i){"use strict";cc._RF.push(e,"37be1zMxrNHp5yT36H8ca3a","ErmjRubMjAnim");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var a,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,i,r):a(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../data/ErmjPathHelper"),s=t("../tool/ErmjMjStyleHelper"),l=t("../data/ErmjGameConst"),c=cc._decorator,h=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mjFrontSp=null,e}return a(e,t),e.prototype.onLoad=function(){this.effectSk1=cc.find("content/effect1",this.node).getComponent(sp.Skeleton),this.effectSk1.node.active=!1,this.effectSk2=cc.find("content/effect2",this.node).getComponent(sp.Skeleton),this.effectSk2.node.active=!1},e.prototype.doRubAnim=function(t){Global.ResourceManager.loadBundleAutoAtlas(l.default.Gid,this.mjFrontSp,r.default.gameTexturePath+"mahjong/atlas_mahjong",s.default.mjHandMap[t],null,!0),this.effectSk1.node.active=!0,this.effectSk2.node.active=!0,this.effectSk1.setAnimation(0,"idle",!1),this.effectSk2.setAnimation(0,"idle_shouzi",!1)},e.prototype.onDisable=function(){this.effectSk1.clearTracks(),this.effectSk2.clearTracks(),this.effectSk1.node.active=!1,this.effectSk2.node.active=!1},o([u(cc.Sprite)],e.prototype,"mjFrontSp",void 0),o([h],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","../tool/ErmjMjStyleHelper":"ErmjMjStyleHelper"}],ErmjRuleConst:[function(t,e,i){"use strict";cc._RF.push(e,"e7bc3uvOqFLGKDEzjE46/vu","ErmjRuleConst");var n,a=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<i;e++)for(var o=arguments[e],r=0,s=o.length;r<s;r++,a++)n[a]=o[r];return n};Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjTypeDefine=void 0;var o,r,s=t("./ErmjGameConst");(function(t){t[t.Fan_DaSiXi=1001]="Fan_DaSiXi",t[t.Fan_DaSanYuan=1002]="Fan_DaSanYuan",t[t.Fan_JiuLianBaoDeng=1003]="Fan_JiuLianBaoDeng",t[t.Fan_SiGang=1004]="Fan_SiGang",t[t.Fan_LianQiDui=1005]="Fan_LianQiDui",t[t.Fan_TianHu=1006]="Fan_TianHu",t[t.Fan_DiHu=1007]="Fan_DiHu",t[t.Fan_RenHu=1008]="Fan_RenHu",t[t.Fan_BaiWan=1009]="Fan_BaiWan",t[t.Fan_XiaoSiXi=1010]="Fan_XiaoSiXi",t[t.Fan_XiaoSanYuan=1011]="Fan_XiaoSanYuan",t[t.Fan_ZiYiSe=1012]="Fan_ZiYiSe",t[t.Fan_SiAnKe=1013]="Fan_SiAnKe",t[t.Fan_YiSeShuangLongH=1014]="Fan_YiSeShuangLongH",t[t.Fan_YiSeSiTongShun=1015]="Fan_YiSeSiTongShun",t[t.Fan_YiSeSiJieGao=1016]="Fan_YiSeSiJieGao",t[t.Fan_YiSeSiBuGao=1017]="Fan_YiSeSiBuGao",t[t.Fan_SanGang=1018]="Fan_SanGang",t[t.Fan_HunYaoJiu=1019]="Fan_HunYaoJiu",t[t.Fan_QiDui=1020]="Fan_QiDui",t[t.Fan_QingYiSe=1021]="Fan_QingYiSe",t[t.Fan_YiSeSanTongShun=1022]="Fan_YiSeSanTongShun",t[t.Fan_YiSeSanJieGao=1023]="Fan_YiSeSanJieGao",t[t.Fan_QingLong=1024]="Fan_QingLong",t[t.Fan_YiSeSanBuGao=1025]="Fan_YiSeSanBuGao",t[t.Fan_SanAnKe=1026]="Fan_SanAnKe",t[t.Fan_TianTing=1027]="Fan_TianTing",t[t.Fan_SanFengKe=1028]="Fan_SanFengKe",t[t.Fan_DaYuWu=1029]="Fan_DaYuWu",t[t.Fan_XiaoYuWu=1030]="Fan_XiaoYuWu",t[t.Fan_MiaoShouHuiChun=1031]="Fan_MiaoShouHuiChun",t[t.Fan_HaiDiLaoYue=1032]="Fan_HaiDiLaoYue",t[t.Fan_GangShangHua=1033]="Fan_GangShangHua",t[t.Fan_QiangGang=1034]="Fan_QiangGang",t[t.Fan_PengPengHu=1035]="Fan_PengPengHu",t[t.Fan_HunYiSe=1036]="Fan_HunYiSe",t[t.Fan_QuanQiuRen=1037]="Fan_QuanQiuRen",t[t.Fan_ShuangJianKe=1038]="Fan_ShuangJianKe",t[t.Fan_ShuangAnGang=1039]="Fan_ShuangAnGang",t[t.Fan_QuanDaiYao=1040]="Fan_QuanDaiYao",t[t.Fan_BuQiuRen=1041]="Fan_BuQiuRen",t[t.Fan_ShuangMingGang=1042]="Fan_ShuangMingGang",t[t.Fan_HuJueZhang=1043]="Fan_HuJueZhang",t[t.Fan_LiZhi=1044]="Fan_LiZhi",t[t.Fan_JianKe=1045]="Fan_JianKe",t[t.Fan_MenQing=1046]="Fan_MenQing",t[t.Fan_PingHu=1047]="Fan_PingHu",t[t.Fan_SiGuiYi=1048]="Fan_SiGuiYi",t[t.Fan_ShuangAnKe=1049]="Fan_ShuangAnKe",t[t.Fan_DuanYao=1050]="Fan_DuanYao",t[t.Fan_AnGang=1051]="Fan_AnGang",t[t.Fan_ErWuBaJiang=1052]="Fan_ErWuBaJiang",t[t.Fan_YaoTouJiu=1053]="Fan_YaoTouJiu",t[t.Fan_BaoTing=1054]="Fan_BaoTing",t[t.Fan_YiBanGao=1055]="Fan_YiBanGao",t[t.Fan_LianLiu=1056]="Fan_LianLiu",t[t.Fan_LaoShaoFu=1057]="Fan_LaoShaoFu",t[t.Fan_HuaPai=1058]="Fan_HuaPai",t[t.Fan_YaoJiuKe=1059]="Fan_YaoJiuKe",t[t.Fan_MingGang=1060]="Fan_MingGang",t[t.Fan_BianZhang=1061]="Fan_BianZhang",t[t.Fan_KanZhang=1062]="Fan_KanZhang",t[t.Fan_DanDiaoJiang=1063]="Fan_DanDiaoJiang",t[t.Fan_ZiMo=1064]="Fan_ZiMo"})(o=i.ErmjTypeDefine||(i.ErmjTypeDefine={})),function(t){t[t.Wan=1]="Wan",t[t.Tiao=2]="Tiao",t[t.Tong=3]="Tong",t[t.Zi=4]="Zi",t[t.Hua=5]="Hua"}(r||(r={}));var l=function(){function t(){}return t.calculateDealBeigin=function(t,e){var i=0;return e.forEach(function(t){i+=t}),[(t+(i%2-Game.Context.selfLocalSeat))%2,2*i]},t.getDealOrderArr=function(t){for(var e=[],i=0;i<s.default.maxPlayerCount;i++){var n=(t+i+s.default.maxPlayerCount)%s.default.maxPlayerCount;e.push(n)}return e},t.sortMjValueArr=function(t){if(!t||Global.Toolkit.isEmptyObject(t))return[];var e=a(t);return e.sort(function(t,e){return t-e}),e},t.getMjValueType=function(t){return t>=1&&t<=9?r.Wan:t>=11&&t<=19?r.Tiao:t>=21&&t<=29?r.Tong:t>=31&&t<=37?r.Zi:t>=41&&t<=48?r.Hua:void 0},t.checkAlmostWin=function(t,e){if(!e||Global.Toolkit.isEmptyObject(e))return!1;var i=this.getMjValueType(t);if(!i||i==r.Hua)return!1;for(var n=0;n<e.length;n++)if(this.getMjValueType(e[n].card)==i)return!0;return!1},t.cardTypeConfig=((n={})[o.Fan_DaSiXi]={name:"\u5927\u56db\u559c",sp:"paixing_dsx",bg:"di_xiao"},n[o.Fan_DaSanYuan]={name:"\u5927\u4e09\u5143",sp:"paixing_dsy",bg:"di_xiao"},n[o.Fan_JiuLianBaoDeng]={name:"\u4e5d\u83b2\u5b9d\u706f",sp:"paixing_jlbd",bg:"di_xiao"},n[o.Fan_SiGang]={name:"\u56db\u6760",sp:"paixing_sg01",bg:"di_xiao"},n[o.Fan_LianQiDui]={name:"\u8fde\u4e03\u5bf9",sp:"paixing_lqd",bg:"di_xiao"},n[o.Fan_TianHu]={name:"\u5929\u80e1",sp:"paixing_th",bg:"di_xiao"},n[o.Fan_DiHu]={name:"\u5730\u80e1",sp:"paixing_dh",bg:"di_xiao"},n[o.Fan_RenHu]={name:"\u4eba\u80e1",sp:"paixing_rh",bg:"di_xiao"},n[o.Fan_BaiWan]={name:"\u767e\u4e07\u77f3",sp:"paixing_bws",bg:"di_xiao"},n[o.Fan_XiaoSiXi]={name:"\u5c0f\u56db\u559c",sp:"paixing_xsx",bg:"di_xiao"},n[o.Fan_XiaoSanYuan]={name:"\u5c0f\u4e09\u5143",sp:"paixing_xsy",bg:"di_xiao"},n[o.Fan_ZiYiSe]={name:"\u5b57\u4e00\u8272",sp:"paixing_zys",bg:"di_xiao"},n[o.Fan_SiAnKe]={name:"\u56db\u6697\u523b",sp:"paixing_sak02",bg:"di_xiao"},n[o.Fan_YiSeShuangLongH]={name:"\u4e00\u8272\u53cc\u9f99\u4f1a",sp:"paixing_ysslh",bg:"di_da"},n[o.Fan_YiSeSiTongShun]={name:"\u4e00\u8272\u56db\u540c\u987a",sp:"paixing_yssts_01",bg:"di_da"},n[o.Fan_YiSeSiJieGao]={name:"\u4e00\u8272\u56db\u8282\u9ad8",sp:"paixing_yssjg_01",bg:"di_da"},n[o.Fan_YiSeSiBuGao]={name:"\u4e00\u8272\u56db\u6b65\u9ad8",sp:"paixing_yssbg",bg:"di_da"},n[o.Fan_SanGang]={name:"\u4e09\u6760",sp:"paixing_sg",bg:"di_xiao"},n[o.Fan_HunYaoJiu]={name:"\u6df7\u5e7a\u4e5d",sp:"paixing_hyj",bg:"di_xiao"},n[o.Fan_QiDui]={name:"\u4e03\u5bf9",sp:"paixing_qd",bg:"di_xiao"},n[o.Fan_QingYiSe]={name:"\u6e05\u4e00\u8272",sp:"paixing_qys",bg:"di_xiao"},n[o.Fan_YiSeSanTongShun]={name:"\u4e00\u8272\u4e09\u540c\u987a",sp:"paixing_yssts",bg:"di_da"},n[o.Fan_YiSeSanJieGao]={name:"\u4e00\u8272\u4e09\u8282\u9ad8",sp:"paixing_yssjg",bg:"di_da"},n[o.Fan_QingLong]={name:"\u6e05\u9f99",sp:"paixing_ql",bg:"di_xiao"},n[o.Fan_YiSeSanBuGao]={name:"\u4e00\u8272\u4e09\u6b65\u9ad8",sp:"paixing_yssbg_01",bg:"di_da"},n[o.Fan_SanAnKe]={name:"\u4e09\u6697\u523b",sp:"paixing_sak",bg:"di_xiao"},n[o.Fan_TianTing]={name:"\u5929\u542c",sp:"paixing_tt",bg:"di_xiao"},n[o.Fan_SanFengKe]={name:"\u4e09\u98ce\u523b",sp:"paixing_sfk",bg:"di_xiao"},n[o.Fan_DaYuWu]={name:"\u5927\u4e8e5",sp:"paixing_dyw",bg:"di_xiao"},n[o.Fan_XiaoYuWu]={name:"\u5c0f\u4e8e5",sp:"paixing_xyw",bg:"di_xiao"},n[o.Fan_MiaoShouHuiChun]={name:"\u5999\u624b\u56de\u6625",sp:"paixing_mshc",bg:"di_xiao"},n[o.Fan_HaiDiLaoYue]={name:"\u6d77\u5e95\u635e\u6708",sp:"paixing_hdly",bg:"di_xiao"},n[o.Fan_GangShangHua]={name:"\u6760\u4e0a\u5f00\u82b1",sp:"paixing_gsh",bg:"di_xiao"},n[o.Fan_QiangGang]={name:"\u62a2\u6760\u80e1",sp:"paixing_qgh",bg:"di_xiao"},n[o.Fan_PengPengHu]={name:"\u78b0\u78b0\u80e1",sp:"paixing_pph",bg:"di_xiao"},n[o.Fan_HunYiSe]={name:"\u6df7\u4e00\u8272",sp:"paixing_hys",bg:"di_xiao"},n[o.Fan_QuanQiuRen]={name:"\u5168\u6c42\u4eba",sp:"paixing_qqr",bg:"di_xiao"},n[o.Fan_ShuangJianKe]={name:"\u53cc\u7bad\u523b",sp:"paixing_sjk",bg:"di_xiao"},n[o.Fan_ShuangAnGang]={name:"\u53cc\u6697\u6760",sp:"paixing_sag",bg:"di_xiao"},n[o.Fan_QuanDaiYao]={name:"\u5168\u5e26\u5e7a",sp:"paixing_qdy",bg:"di_xiao"},n[o.Fan_BuQiuRen]={name:"\u4e0d\u6c42\u4eba",sp:"paixing_bqr",bg:"di_xiao"},n[o.Fan_ShuangMingGang]={name:"\u53cc\u660e\u6760",sp:"paixing_smg",bg:"di_xiao"},n[o.Fan_HuJueZhang]={name:"\u80e1\u7edd\u5f20",sp:"paixing_hjz",bg:"di_xiao"},n[o.Fan_LiZhi]={name:"\u7acb\u76f4",sp:"paixing_lz",bg:"di_xiao"},n[o.Fan_JianKe]={name:"\u7bad\u523b",sp:"paixing_jk",bg:"di_xiao"},n[o.Fan_MenQing]={name:"\u95e8\u524d\u6e05",sp:"paixing_mqq",bg:"di_xiao"},n[o.Fan_PingHu]={name:"\u5e73\u80e1",sp:"paixing_ph",bg:"di_xiao"},n[o.Fan_SiGuiYi]={name:"\u56db\u5f52\u4e00",sp:"paixing_sgy",bg:"di_xiao"},n[o.Fan_ShuangAnKe]={name:"\u53cc\u6697\u523b",sp:"paixing_sak01",bg:"di_xiao"},n[o.Fan_DuanYao]={name:"\u65ad\u5e7a",sp:"paixing_dy",bg:"di_xiao"},n[o.Fan_AnGang]={name:"\u6697\u6760",sp:"paixing_ag",bg:"di_xiao"},n[o.Fan_ErWuBaJiang]={name:"\u4e8c\u4e94\u516b\u5c06",sp:"paixing_ewbz",bg:"di_xiao"},n[o.Fan_YaoTouJiu]={name:"\u5e7a\u5934\u4e5d",sp:"paixing_ytj",bg:"di_xiao"},n[o.Fan_BaoTing]={name:"\u62a5\u542c",sp:"paixing_bt",bg:"di_xiao"},n[o.Fan_YiBanGao]={name:"\u4e00\u822c\u9ad8",sp:"paixing_ybg",bg:"di_xiao"},n[o.Fan_LianLiu]={name:"\u8fde6",sp:"paixing_ll",bg:"di_xiao"},n[o.Fan_LaoShaoFu]={name:"\u8001\u5c11\u526f",sp:"paixing_lsf",bg:"di_xiao"},n[o.Fan_HuaPai]={name:"\u82b1\u724c",sp:"paixing_hp",bg:"di_xiao"},n[o.Fan_YaoJiuKe]={name:"\u5e7a\u4e5d\u523b",sp:"paixing_yjk",bg:"di_xiao"},n[o.Fan_MingGang]={name:"\u660e\u6760",sp:"paixing_mg",bg:"di_xiao"},n[o.Fan_BianZhang]={name:"\u8fb9\u5f20",sp:"paixing_bz",bg:"di_xiao"},n[o.Fan_KanZhang]={name:"\u574e\u5f20",sp:"paixing_kz",bg:"di_xiao"},n[o.Fan_DanDiaoJiang]={name:"\u5355\u540a\u5c06",sp:"paixing_ddj",bg:"di_xiao"},n[o.Fan_ZiMo]={name:"\u81ea\u6478",sp:"paixing_zm",bg:"di_xiao"},n),t.dealConfig=[[4,4],[4,4],[4,4],[2,1]],t}();i.default=l,cc._RF.pop()},{"./ErmjGameConst":"ErmjGameConst"}],ErmjSettleView:[function(t,e,i){"use strict";cc._RF.push(e,"2b811S4yFhInIxLzZpPNsEl","ErmjSettleView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseView"),r=t("../data/ErmjPathHelper"),s=t("../data/ErmjRuleConst"),l=t("../tool/ErmjMjStyleHelper"),c=t("../data/ErmjGameConst"),h=t("../ErmjDriver"),u=function(t){function e(e){var i=t.call(this)||this;return i.clickLimit=!1,i.typeItemList=[],i.nextIndex=0,i.winMjList=[],i.isPressed=!1,i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.maskNode=this.getChild("mask"),this.actionNode=this.getChild("action"),c.default.addCommonClick(this.node,"action/continueBtn",this.onContinueClick,this),c.default.addCommonClick(this.node,"action/leaveBtn",this.onLeaveClick,this),this.contentNode=this.getChild("contentMask/content"),this.winInfoView=new p(this.getChild("contentMask/content/winNode")),this.loseInfoView=new d(this.getChild("contentMask/content/loseNode")),this.typeScrollView=this.getComponent("contentMask/content/typeScrollView",cc.ScrollView),this.listLayout=this.getComponent("contentMask/content/typeScrollView/mask/listLayout",cc.Layout),this.copyTypeItem=new f(this.getChild("contentMask/content/typeScrollView/mask/listLayout/typeNode")),this.copyTypeItem.active=!1,this.winTypeSp=this.getComponent("contentMask/content/winType",cc.Sprite),this.initWinMjList(),this.hideBtn=this.getChild("hideBtn"),this.upIcon=this.getChild("hideBtn/up"),this.downIcon=this.getChild("hideBtn/down"),c.default.addCommonClick(this.hideBtn,"",this.hideBtnClick,this),this.rawPos=this.contentNode.position},e.prototype.initWinMjList=function(){this.winMjListNode=this.getChild("contentMask/content/winMjList");var t=this.getChild("contentMask/content/winMjList/winMjView"),e=new m(t);e.active=!0,this.winMjList.push(e);for(var i=this.Define.HandMjMaxCount+4,n=0;n<i;n++){var a=cc.instantiate(t);a.setParent(this.winMjListNode);var o=new m(a);o.active=!0,this.winMjList.push(o)}},e.prototype.onOpen=function(){var t=this;this.clickLimit=!1,this.hideBtn.active=!1,this.isPressed=!1,this.showContent(!1),this.contentNode.opacity=1,this.contentNode.runAction(cc.sequence([cc.fadeTo(.5,255),cc.callFunc(function(){t.hideBtn.active=!0},this)])),this.actionNode.active=!1,this.delayShowActionBtn(5e3)},e.prototype.delayShowActionBtn=function(t){var e=this;this.timer=setTimeout(function(){e.showActionBtn(!0)},t)},e.prototype.showActionBtn=function(t){this.actionNode.active=t,t&&(this.actionNode.opacity=1,this.actionNode.stopAllActions(),this.actionNode.runAction(cc.fadeTo(.2,255))),clearTimeout(this.timer)},e.prototype.onClose=function(){this.contentNode.stopAllActions(),this.contentNode.opacity=255,clearTimeout(this.timer)},e.prototype.hideBtnClick=function(){c.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),this.showContent(!0)},e.prototype.showContent=function(t){if(void 0===t&&(t=!0),this.isPressed){var e=cc.v3(0,600);this.isPressed=!1,this.upIcon.active=!1,this.downIcon.active=!0,this.contentNode.stopAllActions(),this.maskNode.opacity=50,t?this.contentNode.runAction(cc.moveBy(.2,cc.v2(e.x,e.y)).easing(cc.easeIn(1))):this.contentNode.setPosition(this.rawPos.add(e))}else this.isPressed=!0,this.upIcon.active=!0,this.downIcon.active=!1,this.contentNode.active=!0,this.contentNode.stopAllActions(),this.maskNode.opacity=153,t?this.contentNode.runAction(cc.moveTo(.2,cc.v2(this.rawPos.x,this.rawPos.y)).easing(cc.easeOut(1))):this.contentNode.setPosition(this.rawPos)},e.prototype.onContinueClick=function(){var t=this;c.default.playSound(r.ErmjAudioConst.commonAudio.ContinueGame,!0),this.clickLimit||(h.default.instance.reMatchPlayer(),this.clickLimit=!0,Game.Component.scheduleOnce(function(){t.clickLimit=!1},3))},e.prototype.onLeaveClick=function(){c.default.playSound(r.ErmjAudioConst.commonAudio.ButtonClick,!0),Game.Server.send(this.Define.CmdLeave,{IsClose:1}),h.default.instance.leaveGame()},e.prototype.showSettleInfo=function(t,e,i,n,a){for(var o in this.winInfoView.active=t,this.loseInfoView.active=!t,t?(c.default.playSound(r.ErmjAudioConst.commonAudio.RewardWin,!0),this.winInfoView.showInfo(i,e)):(c.default.playSound(r.ErmjAudioConst.commonAudio.RewardLose,!0),this.loseInfoView.showInfo(i,e)),n){var s=n[o];if(s)return this.showFanList(s.fan_detail),void this.showWinCardsList(a[o],s.block_list||[])}},e.prototype.setWinType=function(t){var e=1==t?c.default.StateSpStrCfg.WinAll:2==t?c.default.StateSpStrCfg.Win:c.default.StateSpStrCfg.RobWin;Global.ResourceManager.loadBundleAutoAtlas(c.default.Gid,this.winTypeSp,r.default.gameTexturePath+"dynamic/atlas_dynamic",e,null,!0)},e.prototype.showFanList=function(t){if(t){for(var e in t){var i=s.default.cardTypeConfig[e]||{},n=this.getOneTypeItem();n.active=!0,this.nextIndex+=1,n.setContext(i.name,t[e])}this.typeScrollView.scrollToTop(0)}},e.prototype.showWinCardsList=function(t,e){var i=this;if(void 0===e&&(e=[]),t){var n=cc.Vec3.ZERO,a=cc.v3(62,0),o=cc.v3(15,0),r=cc.v3(0,22),s=0;if(e.forEach(function(t){(t.all_cards||[]).forEach(function(e,o){var l=i.winMjList[s];if(l)if(l.active=!0,l.mahjongValue=e,6==t.type&&3!=o?l.isFront=!1:l.isFront=!0,4!=t.type&&5!=t.type&&6!=t.type||3!=o)l.node.setPosition(n),n=n.add(a);else{var c=n.sub(a.mul(2)).add(r);l.node.setPosition(c)}s++}),n=n.add(o)}),t.forEach(function(e,r){var l=i.winMjList[s];l&&(l.active=!0,l.mahjongValue=e,l.isFront=!0,r==t.length-1?l.node.setPosition(n.add(o)):l.node.setPosition(n),n=n.add(a)),s++}),s<this.winMjList.length)for(var l=s;l<this.winMjList.length;l++)this.winMjList[l].active=!1}},e.prototype.getOneTypeItem=function(){if(!this.typeItemList[this.nextIndex]){var t=cc.instantiate(this.copyTypeItem.node);t.setParent(this.listLayout.node);var e=new f(t);this.typeItemList.push(e)}return this.typeItemList[this.nextIndex]},e.prototype.hideAllTypeItem=function(){this.typeItemList.forEach(function(t){t.active=!1})},e.prototype.clearByRound=function(){this.hideAllTypeItem(),this.nextIndex=0,this.winInfoView.active=!1,this.loseInfoView.active=!1,this.active=!1},e}(o.default);i.default=u;var p=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.multLbl=this.getComponent("multLbl",cc.Label),this.winLbl=this.getComponent("winLbl",cc.Label),this.effectSk=this.getComponent("effect",sp.Skeleton)},e.prototype.showInfo=function(t,e){this.multLbl.string=t.toString(),this.winLbl.string=Global.Toolkit.formatPointStr(e,!1,!0),this.effectSk.node.active=!0,this.effectSk.setAnimation(0,"idle",!1),this.effectSk.addAnimation(0,"idle2",!0,1)},e.prototype.onClose=function(){this.effectSk.node.active=!1,this.effectSk.clearTracks()},e}(o.default),d=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.multLbl=this.getComponent("multLbl",cc.Label),this.winLbl=this.getComponent("winLbl",cc.Label),this.effectSk=this.getComponent("effect",sp.Skeleton)},e.prototype.showInfo=function(t,e){this.multLbl.string=t.toString(),this.winLbl.string=Global.Toolkit.formatPointStr(e,!1,!0),this.effectSk.node.active=!0,this.effectSk.setAnimation(0,"idle",!1)},e.prototype.onClose=function(){this.effectSk.node.active=!1,this.effectSk.clearTracks()},e}(o.default),f=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.typeLbl=this.getComponent("typeLbl",cc.Label)},e.prototype.setContext=function(t,e){this.typeLbl.string=t+"  "+e+"\u756a"},e}(o.default),m=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.frontBg=this.getComponent("bg",cc.Sprite),this.frontSp=this.getComponent("front",cc.Sprite),this.backBg=this.getComponent("back",cc.Sprite)},Object.defineProperty(e.prototype,"mahjongValue",{get:function(){return this._value},set:function(t){this._value!=t&&(this._value=t,Global.ResourceManager.loadBundleAutoAtlas(c.default.Gid,this.frontSp,r.default.gameTexturePath+"mahjong/atlas_mahjong",l.default.mjHandMap[t],null,!0),cc.sys.isBrowser&&(this.node.name=String(t)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFront",{set:function(t){this.frontBg.node.active=t,this.frontSp.node.active=t,this.backBg.node.active=!t},enumerable:!1,configurable:!0}),e.prototype.setSpecialColor=function(t){this.frontBg.node.color=t&&l.default.SpecialBgColor||l.default.NormalBgColor},e}(o.default);cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","../data/ErmjRuleConst":"ErmjRuleConst","../tool/ErmjMjStyleHelper":"ErmjMjStyleHelper","./ErmjBaseView":"ErmjBaseView"}],ErmjSyncHandler:[function(t,e,i){"use strict";cc._RF.push(e,"eeb62whMWZCtJTeApE34wO2","ErmjSyncHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjSyncRefreshHandler=i.ErmjSyncEndHandler=i.ErmjSyncBeginHandler=void 0;var o=t("./ErmjBaseHandler"),r=t("../ErmjDriver"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.refreshData=function(){this.context.syncMode=!0},e.prototype.execute=function(){r.default.instance.beginSync()},e}(o.default);i.ErmjSyncBeginHandler=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.refreshData=function(){this.context.syncMode=!1},e}(o.default);i.ErmjSyncEndHandler=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){this.mainUI.leftTipsView.updateLeftLbl(t._para.left_count),this.mainUI.mjHillView.doDeal(t._para.head_count||0),this.mainUI.mjHillView.doPatchwork(t._para.tail_count||0);var e=t._para.flower_cards||{};for(var i in e){var n=this.SitHelper.serverSToLocalN(Number(i));this.mainUI.callMjPlayer(n,"flowerCardAdd",e[i])}var a=this.SitHelper.serverSToLocalN(t._para.last_out_chair),o=t._para.out_cards||{};for(var i in o)(n=this.SitHelper.serverSToLocalN(Number(i)))!=a&&this.mainUI.callMjPlayer(n,"showOutCardDirectly",o[i]);o[t._para.last_out_chair]&&(this.mainUI.callMjPlayer(a,"showOutCardDirectly",o[t._para.last_out_chair]),this.mainUI.showLastOutSign(!0));var r=t._para.set_cards||{};for(var i in r)n=this.SitHelper.serverSToLocalN(Number(i)),this.mainUI.callMjPlayer(n,"syncAllOperView",r[i])},e}(o.default);i.ErmjSyncRefreshHandler=c,cc._RF.pop()},{"../ErmjDriver":"ErmjDriver","./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjTimeAutoRun:[function(t,e,i){"use strict";cc._RF.push(e,"dab40LsU89P8qVAMQ7Evl8H","ErmjTimeAutoRun");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var a,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,i,r):a(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.totalTime=5,e}return a(e,t),e.prototype.onLoad=function(){this.timeLbl=this.getComponent(cc.Label)},e.prototype.onEnable=function(){},e.prototype.setTimer=function(t,e,i){this.totalTime=t,this.finishCal=e,this.target=i,this.setTimeLbl(),this.schedule(this.onTimeRun,1)},e.prototype.onTimerFinish=function(){this.finishCal&&this.target?this.finishCal.call(this.target):this.node.active=!1},e.prototype.onTimeRun=function(){cc.isValid(this.node)&&(this.totalTime--,0==this.totalTime&&this.onTimerFinish(),this.setTimeLbl())},e.prototype.onDisable=function(){this.unschedule(this.onTimeRun)},e.prototype.onDestroy=function(){this.unschedule(this.onTimeRun)},e.prototype.setTimeLbl=function(){this.totalTime<10?this.timeLbl.string="0"+this.totalTime:this.timeLbl.string=""+this.totalTime},o([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],ErmjTingHandler:[function(t,e,i){"use strict";cc._RF.push(e,"b00d6RhEhlN2IJrgapKKip0","ErmjTingHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.ErmjTingResultHandler=i.ErmjCallTingHandler=i.ErmjTingHandler=void 0;var o=t("./ErmjBaseHandler"),r=t("../data/ErmjGameConst"),s=t("../data/ErmjPathHelper"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){this.mainUI.askActionView.active=!1;var e=this.SitHelper.serverSToLocalN(t._src);0==e&&(this.context.set(this.Define.FieldInTing,!0),this.mainUI.selfPlayView.onTing()),this.mainUI.callPlayer(e,"showStateSp",!0,r.default.StateSpStrCfg.Ting),this.mainUI.callPlayer(e,"showTingSign",!0);for(var i=t._para.ting_looks||[],n=0;n<i.length;n++){var a=this.SitHelper.serverSToLocalN(i[n].chair);this.mainUI.callMjPlayer(a,"setBeInTing"),this.mainUI.callMjPlayer(a,"showDownHand",a!=this.context.selfLocalSeat,i[n].cards||[],!1,!0),this.mainUI.callMjPlayer(a,"showDarkKongSeen",i[n].kongs||[])}1==t._para.ting_type?(this.mainUI.onPlay(e,t._para.card),Game.Component.scheduleOnce(function(){r.default.playSound(s.ErmjAudioConst.genderSoundPath("ting",0==e?0:1),!0)},.5),Game.Event.event(Game.EVENT_ADDTIMELOCK,"ErmjTingHandler",1.5)):(r.default.playSound(s.ErmjAudioConst.genderSoundPath("ting",0==e?0:1),!0),Game.Event.event(Game.EVENT_ADDTIMELOCK,"ErmjTingHandler",1))},e.prototype.executeSync=function(t){this.mainUI.askActionView.active=!1;var e=this.SitHelper.serverSToLocalN(t._src);0==e&&(this.context.set(this.Define.FieldInTing,!0),this.mainUI.selfPlayView.onTing()),this.mainUI.callPlayer(e,"showTingSign",!0);for(var i=t._para.ting_looks||[],n=0;n<i.length;n++){var a=this.SitHelper.serverSToLocalN(i[n].chair);this.mainUI.callMjPlayer(a,"setBeInTing"),this.mainUI.callMjPlayer(a,"showDownHand",a!=this.context.selfLocalSeat,i[n].cards||[],!1,!0),this.mainUI.callMjPlayer(a,"showDarkKongSeen",i[n].kongs||[])}},e}(o.default);i.ErmjTingHandler=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){0==this.SitHelper.serverSToLocalN(t._src)&&(this.mainUI.askActionView.active=!0,this.mainUI.askActionView.showTingBtn(!0,t._para));var e=0,i=t._times;if(i&&Game.Component.correctTime){var n=Game.Component.correctTime(i);e=1e3*t._timeo-n}else e=1e3*t._timeo-(Date.now()-t._receiveTime);(!e||e<=0)&&(e=1e3),this.mainUI.askNoticeView.setTimeRunConfig(Math.round(e/1e3),null,null)},e}(o.default);i.ErmjCallTingHandler=c;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){0==this.SitHelper.serverSToLocalN(t._src)&&(this.mainUI.selfPlayView.winTipsView.active=!0,this.mainUI.selfPlayView.winTipsView.updateWinList(t._para.ting_items),this.context.set(this.Define.FieldTingData,t._para.ting_items))},e}(o.default);i.ErmjTingResultHandler=h,cc._RF.pop()},{"../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjWinHandler:[function(t,e,i){"use strict";cc._RF.push(e,"c6cfdKBDz9M4bbS6reQYaKI","ErmjWinHandler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.execute=function(t){this.context.set(this.Define.FieldHandActionEnable,!1),this.context.set(this.Define.FieldInPlayTurn,!1),this.mainUI.callAllPlayers("showStateSp",!1),this.mainUI.askNoticeView.setTimerShow(!1),this.mainUI.selfPlayView.resetSelectMj(),this.mainUI.selfPlayView.showPlayTips(!1),this.mainUI.askActionView.active=!1;var e=this.SitHelper.serverSToLocalN(t._src),i=this.SitHelper.serverSToLocalN(t._para.who);this.mainUI.onWin(e,i,t._para.card,t._para.type,!0),this.context.set(this.Define.FieldHandActionEnable,!1),this.mainUI.settleView.setWinType(t._para.type)},e.prototype.executeSync=function(t){this.context.set(this.Define.FieldHandActionEnable,!1),this.context.set(this.Define.FieldInPlayTurn,!1),this.mainUI.callAllPlayers("showStateSp",!1),this.mainUI.askNoticeView.setTimerShow(!1),this.mainUI.selfPlayView.resetSelectMj(),this.mainUI.selfPlayView.showPlayTips(!1),this.mainUI.askActionView.active=!1;var e=this.SitHelper.serverSToLocalN(t._src),i=this.SitHelper.serverSToLocalN(t._para.who);this.mainUI.onWin(e,i,t._para.card,t._para.type,!1),this.context.set(this.Define.FieldHandActionEnable,!1),this.mainUI.settleView.setWinType(t._para.type)},e}(t("./ErmjBaseHandler").default);i.default=o,cc._RF.pop()},{"./ErmjBaseHandler":"ErmjBaseHandler"}],ErmjWinLightningView:[function(t,e,i){"use strict";cc._RF.push(e,"19db7e0T29MSL+m0NUl1USJ","ErmjWinLightningView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.contentNode=this.getChild("content"),this.effectSk=this.getComponent("content/effect",sp.Skeleton)},e.prototype.onOpen=function(){var t=this;this.effectSk.node.active=!0,this.effectSk.setAnimation(0,"idle",!1),Game.Component.scheduleOnce(function(){t.active=!1},1)},e.prototype.setLightPoint=function(t){this.contentNode.setPosition(this.contentNode.parent.convertToNodeSpaceAR(t))},e.prototype.onClose=function(){this.effectSk.node.active=!1,this.effectSk.clearTracks()},e.prototype.clearByRound=function(){this.active=!1},e}(t("./ErmjBaseView").default);i.default=o,cc._RF.pop()},{"./ErmjBaseView":"ErmjBaseView"}],ErmjWinListTipsView:[function(t,e,i){"use strict";cc._RF.push(e,"b923bxSbnNN7ItoF/faUmHZ","ErmjWinListTipsView");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ErmjBaseView"),r=t("../data/ErmjPathHelper"),s=t("../tool/ErmjMjStyleHelper"),l=t("../data/ErmjGameConst"),c=function(t){function e(e){var i=t.call(this)||this;return i.winMjItemList=[],i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.bgNode=this.getChild("bgNode"),this.winCount=this.getComponent("winCount",cc.Label),this.listLayout=this.getComponent("listLayout",cc.Layout),this.copyNode=this.getChild("winMjItem"),this.copyNode.active=!1},e.prototype.updateWinList=function(t){void 0===t&&(t=[]),this.hideAllMj();for(var e=t.length,i=0,n=0;n<t.length;n++){var a=t[n],o=this.winMjItemList[n];o||(o=this.getOneWinMjItem()),o.active=!0,o.setInfo(a.card,a.fan,a.num),i+=a.num}this.winCount.string=""+i;var r=e>=2?e-2:0;this.bgNode.width=264+65*r},e.prototype.getOneWinMjItem=function(){var t=cc.instantiate(this.copyNode);t.setParent(this.listLayout.node);var e=new h(t);return this.winMjItemList.push(e),e},e.prototype.hideAllMj=function(){this.winMjItemList.forEach(function(t){t.active=!1})},e}(o.default);i.default=c;var h=function(t){function e(e){var i=t.call(this)||this;return i.setNode(e),i}return a(e,t),e.prototype.initView=function(){this.frontSp=this.getComponent("front",cc.Sprite),this.countLbl=this.getComponent("countLbl",cc.Label),this.multLbl=this.getComponent("multLbl",cc.Label)},e.prototype.setInfo=function(t,e,i){Global.ResourceManager.loadBundleAutoAtlas(l.default.Gid,this.frontSp,r.default.gameTexturePath+"mahjong/atlas_mahjong",s.default.mjOutMap[t],null,!0),this.countLbl.string="x"+i,this.multLbl.string=e+"\u756a"},e}(o.default);cc._RF.pop()},{"../data/ErmjGameConst":"ErmjGameConst","../data/ErmjPathHelper":"ErmjPathHelper","../tool/ErmjMjStyleHelper":"ErmjMjStyleHelper","./ErmjBaseView":"ErmjBaseView"}]},{},["ErmjDriver","ErmjAskClockView","ErmjBaseComponent","ErmjDiceAnim","ErmjLoadingUI","ErmjRubMjAnim","ErmjTimeAutoRun","ErmjContext","ErmjDefine","ErmjGameConst","ErmjGameEvent","ErmjPathHelper","ErmjRuleConst","ErmjAutoHandler","ErmjBankerHandler","ErmjBaseHandler","ErmjCallBlockHandler","ErmjChangeFlowerHandler","ErmjChatHandler","ErmjDealHandler","ErmjDrawCardHandler","ErmjEasyHandler","ErmjEnterHandler","ErmjGameCfgHandler","ErmjLeaveHandler","ErmjPlayHandler","ErmjRewardHandler","ErmjSyncHandler","ErmjTingHandler","ErmjWinHandler","ErmjOutMjViewManager","ErmjMainUI","ErmjAskActionView","ErmjAskBtnView","ErmjAskNoticeView","ErmjBaseView","ErmjFlowView","ErmjGameStartView","ErmjLeftTipsView","ErmjMahjongSelfPlayView","ErmjMatchPlayerView","ErmjMenuView","ErmjSettleView","ErmjWinLightningView","ErmjWinListTipsView","ErmjMahjongHandView","ErmjMahjongHillView","ErmjMahjongOperView","ErmjMahjongOutView","ErmjMjPlayerView","ErmjPlayerHandView","ErmjPlayerView","ErmjBasePool","ErmjMjStyleHelper"]);