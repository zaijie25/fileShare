{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\serviver\\ServicerItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import {CustomerEntranceType, PopItemType } from \"../../../hallcommon/model/ServicerModel\";\r\nimport Toolkit from \"../../../core/tool/Toolkit\";\r\nimport AbsServicer from \"../Feedback/AbsServicer\";\r\nimport RightPanelView from \"../Feedback/RightPanelView\";\r\nimport { RightViewType } from \"../Feedback/FeedbackConstants\";\r\nimport Feedback2 from \"../Feedback/Feedback2\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ServicerItem extends cc.Component {\r\n\r\n    @property([cc.SpriteFrame])\r\n    spriteList : Array<cc.SpriteFrame> = [];\r\n\r\n    @property([cc.String])\r\n    stringList: Array<string> = [];\r\n\r\n    @property(cc.Sprite)\r\n    iconSprite: cc.Sprite = null;\r\n\r\n    @property(cc.Label)\r\n    iconName: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    servicerName: cc.Label = null;\r\n\r\n    @property([cc.SpriteFrame])\r\n    btnSpriteList : Array<cc.SpriteFrame> = [];\r\n\r\n    private data : any = null;\r\n    private btn_RichText: cc.RichText;\r\n    private btnSprite: cc.Sprite;\r\n    // private btn_Label: cc.Label;\r\n    private isOnlineServicer: boolean = false;\r\n    private isAtServicer: boolean = false;\r\n    private server : AbsServicer = null;\r\n    private order : number = -1;\r\n\r\n    reset(){\r\n        \r\n    }\r\n    onLoad(){\r\n        if(this.stringList.length == 1){\r\n            // this.btn_Label = cc.find(\"ServicerBtn/Label\",this.node).getComponent(cc.Label);\r\n        }else{\r\n            let richTextNode = cc.find(\"ServicerBtn/RichText\",this.node)\r\n            if(richTextNode)\r\n            {\r\n                this.btn_RichText = richTextNode.getComponent(cc.RichText);\r\n            }\r\n            \r\n            if(this.btnSpriteList.length==2){\r\n                this.btnSprite = cc.find(\"ServicerBtn/btnSprite\",this.node).getComponent(cc.Sprite);\r\n            }\r\n        }\r\n    }\r\n\r\n    setData2(index: number,data: AbsServicer){\r\n        this.server = data;\r\n        this.order = index;\r\n        this.setData(data.initServicerData()[index]);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param data AppId int32  `json:\"app_id\"`\r\n\t\t\tType  int32  `json:\"type\"` //1qq 2微信\r\n\t\t\tInfo  string `json:\"info\"`\r\n     */\r\n    setData(data : any){\r\n        if(data.type <= 0 || data.type > 5 ){\r\n            this.node.active = false;\r\n            return;\r\n        }\r\n        this.data = data;\r\n        this.node.active = true;\r\n        if(this.spriteList.length == 1){\r\n            this.iconSprite.spriteFrame = this.spriteList[0];\r\n        }else{\r\n            this.iconSprite.spriteFrame = this.spriteList[data.type - 1];\r\n        }\r\n        if(this.stringList.length == 1){\r\n            if(data.name){\r\n                this.iconName.string = data.name;\r\n            }else{\r\n                this.iconName.string = this.stringList[0];\r\n            }\r\n        }else{\r\n            if(data.name){\r\n                this.iconName.string = data.name;\r\n            }else{\r\n                this.iconName.string = this.stringList[data.type - 1] || \"\";\r\n            }\r\n        }\r\n        if (data.info!=null&&data.info!=undefined) {\r\n            this.servicerName.node.active = true;\r\n            this.servicerName.string = Global.Toolkit.substrEndWithElli( data.info ,12);\r\n        }\r\n        if(data.type == 5){\r\n            if(this.stringList.length == 1){\r\n                // this.btn_Label.string = \"联系客服\";\r\n            }else{\r\n                if(this.btn_RichText)\r\n                    this.btn_RichText.string = \"立即联系\";\r\n                if(this.btnSpriteList&&this.btnSpriteList.length==2){\r\n                    this.btnSprite.spriteFrame = this.btnSpriteList[1];\r\n                }\r\n            }\r\n            this.isOnlineServicer = true;\r\n            this.isAtServicer = false;\r\n        }else{\r\n            if(data.type == 4){\r\n                this.isAtServicer = true;\r\n            }else{\r\n                this.isAtServicer = false;\r\n            }\r\n            if(this.stringList.length == 1){\r\n                // this.btn_Label.string = \"联系客服\";\r\n            }else{\r\n                if(this.btn_RichText)\r\n                    this.btn_RichText.string = \"立即联系\";\r\n                if(this.btnSpriteList&&this.btnSpriteList.length==2){\r\n                    this.btnSprite.spriteFrame = this.btnSpriteList[1];\r\n                }\r\n            }\r\n            this.isOnlineServicer = false;\r\n        } \r\n        \r\n    }\r\n\r\n    awakeQQCallBack( retStr ){\r\n        if (retStr.result == 0) {\r\n        } \r\n        else {\r\n            let ret = retStr.result\r\n            if (ret == -1) {\r\n                Logger.log(\"请先安装QQ\");\r\n                Global.UI.showSingleBox(\"请先安装QQ\", null);\r\n            } else {\r\n                Logger.log(\"打开QQ失败\");\r\n                Global.UI.showSingleBox(\"打开QQ失败\", null);\r\n            }\r\n        }\r\n    }\r\n\r\n    awakeWeChatCallBack( retStr ){\r\n        if (retStr.result == 0) {\r\n        } else {\r\n            let ret = retStr.result\r\n            if (ret == -1) {\r\n                Logger.log(\"请先安装微信\");\r\n                Global.UI.showSingleBox(\"请先安装微信\", null);\r\n            } else {\r\n                Logger.log(\"打开微信失败\");\r\n                Global.UI.showSingleBox(\"打开微信失败\", null);\r\n            }\r\n        }\r\n    }\r\n\r\n    copyTextToClipboardCallBack( retStr ){\r\n        if (retStr.result == 0) {\r\n            Global.UI.fastTip(\"复制成功\");\r\n            if(this.data.type == PopItemType.QQ){\r\n                Global.NativeEvent.awakeQQApp(this.awakeQQCallBack.bind(this));\r\n            }else if(this.data.type == PopItemType.WX || this.data.type == PopItemType.WX){\r\n                Global.NativeEvent.awakeWechatApp(this.awakeWeChatCallBack.bind(this));\r\n            }\r\n        }else {\r\n            Global.UI.fastTip(\"复制失败\");\r\n        }\r\n    }\r\n\r\n    //复制并前往\r\n    ServicerBtnFunc(event, customEventData){\r\n        if(this.server!= null){\r\n            if(this.isOnlineServicer){\r\n                let rightPanelView = <RightPanelView>Global.UI.getWindow(\"WndFeedback\").getView(\"RightPanelView\");\r\n                rightPanelView.changeView(RightViewType.feedback2);\r\n                let feedback2 = <Feedback2>rightPanelView.getView(\"feedback2\");\r\n                feedback2.server = this.server;\r\n                feedback2.order = this.order;\r\n            }else{\r\n                this.server.acceptService(this.order);\r\n            }\r\n            return;\r\n        }\r\n        \r\n        if(this.isOnlineServicer){\r\n            cc.sys.openURL(Global.Toolkit.DealWithUrl(this.data.info));\r\n        }else{\r\n            if(this.isAtServicer){\r\n                Global.ChatServer.serverType = CustomerEntranceType.HallService;\r\n                if(customEventData && customEventData == \"proxy\" && !this.data.pop)\r\n                {\r\n                    Global.ChatServer.userSetting(null,this.data.aite_url);\r\n                    return\r\n                }\r\n                Global.ChatServer.userSetting(null,this.data.info);\r\n                return;\r\n            }\r\n            Global.NativeEvent.copyTextToClipboard(this.data.info, this.copyTextToClipboardCallBack.bind(this) );\r\n        }\r\n    }\r\n}\r\n"]}