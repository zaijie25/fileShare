{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\recharge\\RechargeOnlineView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ViewBase from \"../../../core/ui/ViewBase\";\r\nimport RechargeModel from \"../../../hallcommon/model/RechargeModel\";\r\nimport { NetAppface } from \"../../../core/net/hall/NetEvent\";\r\n\r\nexport default class RechargeOnlineView extends ViewBase{\r\n        private payKey: string;\r\n        // private id:string;\r\n        private btnLayout: cc.Layout;\r\n        private model: RechargeModel;\r\n    \r\n        protected initView(){\r\n            this.model = Global.ModelManager.getModel(\"RechargeModel\");\r\n            this.btnLayout = this.getComponent(\"btnLayout\", cc.Layout);\r\n            this.addCommonClick(\"goToPayBtn\", this.goToPay, this);\r\n            this.addCommonClick(\"btnLayout\",this.goToPay, this,cc.Button.Transition.NONE);\r\n\r\n        }\r\n    \r\n        //TODO 按钮点击事件\r\n        private goToPay(){\r\n            // this.model.reqGetUserDownPay(this.payKey,0,this.id);\r\n            Logger.log(\"支付请求中----\", this.payKey);\r\n        }\r\n\r\n        public initData(data){\r\n            this.payKey = data.pay_key;\r\n            // this.id =  data.data[0].id;\r\n        }\r\n    \r\n        protected onSubViewShow(){\r\n            Global.HallServer.on(NetAppface.UserDownPay, this, this.onReqOrder);\r\n            this.model.on(RechargeModel.GetPayUrlResult, this, this.onGetPayUrl);\r\n        }\r\n    \r\n        private onReqOrder(data){\r\n            let order = data.order_id;\r\n            if (order){\r\n                this.model.event(RechargeModel.ShowWaitingAnim, true, this.payKey);\r\n                this.model.reqGetPayUrl(order);\r\n            }\r\n        }\r\n    \r\n        private onGetPayUrl(result: number, data: any){\r\n            this.model.event(RechargeModel.ShowWaitingAnim, false);\r\n            if (result == 0){\r\n                let url = data.url;\r\n                if (url){\r\n                    cc.sys.openURL(Global.Toolkit.DealWithUrl(url));\r\n                    Global.UI.showSingleBox(Global.Language.getWord(1606) || \"支付等待中\");\r\n                }\r\n            }\r\n            else if(result == 2){\r\n                let errno = data._errno;\r\n                if (errno){\r\n                    Global.UI.fastTip(data._errstr);\r\n                }\r\n            }\r\n            else{\r\n                Global.UI.fastTip(\"支付失败，请尝试其他充值方式\");\r\n            }\r\n        }\r\n    \r\n        protected onSubViewHide(){\r\n            Global.HallServer.off(NetAppface.UserDownPay, this, this.onReqOrder);\r\n            this.model.off(RechargeModel.GetPayUrlResult, this, this.onGetPayUrl);\r\n        }\r\n       \r\n}"]}