{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\rank\\WndRank.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WndBase from \"../../../core/ui/WndBase\";\r\nimport RankModel from \"../../../hallcommon/model/RankModel\";\r\nimport SpreadModel from \"../../../hallcommon/model/SpreadModel\";\r\nimport WaitingView from \"../waiting/WaitingView\";\r\n\r\nclass WndRank extends WndBase {\r\n    private RankScrollView: cc.ScrollView;\r\n    private selfLabelName: cc.Label;\r\n    private selfLabelID: cc.Label;\r\n    private selfLabelCount: cc.Label;\r\n    private selfRankLab: cc.Label;\r\n    private selfheadImg: cc.Node;\r\n    private selfRankSprite: cc.Sprite;\r\n    //private fontSprite: cc.Sprite;\r\n    private RankModel: RankModel;\r\n    private copyItem: cc.Node;\r\n    private dayRank: cc.Node;\r\n    private weekRank: cc.Node;\r\n    //未上榜\r\n    private notInListNode: cc.Node;\r\n    nodeList: any[] = [];\r\n    listView: any;\r\n    listView2: any;\r\n    private curWin: number = 0;//0日 1周\r\n\r\n    //佣金\r\n    CommissionUn: cc.Label;\r\n    CommissionCh: cc.Label;\r\n\r\n    CommissionUn1: cc.Label;\r\n    CommissionCh1: cc.Label;\r\n    // SpFrameurl = \"hall/texture/rank/rankAtlas\"\r\n    // SpDayWeek = [\"jryl_1\",\"jryl_2\",\"bzyl_1\",\"bzyl_2\",\"jrylb_1\", \"jrylb_2\", \"bzyjb_1\", \"bzyjb_2\"]\r\n    DayWeek = [\"今日盈利榜\", \"本周盈利榜\", \"今日盈利榜\", \"本周佣金榜\"];\r\n\r\n    private waitingNode: cc.Node;\r\n    SpreadModel: SpreadModel;\r\n    protected onOpen() {\r\n        this.RankModel.on(RankModel.RefreshScrollview, this, this.RefreshScrollView)\r\n        this.RankModel.on(RankModel.UpdateRankData, this, this.UpdataListData)\r\n        this.setToggleChecked(this.dayRank, true)\r\n        this.setToggleChecked(this.weekRank, false)\r\n        this.changeInfoNode(null);\r\n    }\r\n\r\n    public afterOpen() {\r\n    }\r\n\r\n    protected onInit() {\r\n        this.isNeedDelay = true\r\n        this.name = \"WndRank\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/RankUI\";\r\n        this.RankModel = <RankModel>Global.ModelManager.getModel(\"RankModel\");\r\n    }\r\n\r\n    protected initView() {\r\n\r\n        this.node.width = cc.Canvas.instance.node.width;\r\n        this.node.height = cc.Canvas.instance.node.height;\r\n\r\n        // this.dayRank = this.getChild(\"PanelNode/RankPanel/TopTitle/topButton/dayRank\");\r\n        // this.weekRank = this.getChild(\"PanelNode/RankPanel/TopTitle/topButton/weekRank\");\r\n        this.dayRank = this.getChild(\"leftPanel/dayRank\");\r\n        this.weekRank = this.getChild(\"leftPanel/weekRank\");\r\n        this.dayRank.on(\"click\", this.changeInfoNode, this);\r\n        this.weekRank.on(\"click\", this.changeInfoNode2, this);\r\n\r\n        this.addCommonClick(\"close\", this.close, this);\r\n        this.RankScrollView = this.getComponent(\"rightPanel/scrollview\", cc.ScrollView);\r\n        this.copyItem = this.getChild(\"rightPanel/scrollview/view/content/Item\");\r\n        this.copyItem.active = false;\r\n        let tmpSelfLbID = this.getChild(\"SelfInfo/LeftNode/IdLab\")\r\n        this.selfLabelID = tmpSelfLbID.getComponent(cc.Label)\r\n\r\n        let tmpSelfLbName = this.getChild(\"SelfInfo/LeftNode/NameLab\")\r\n        this.selfLabelName = tmpSelfLbName.getComponent(cc.Label)\r\n\r\n        let tmpContent = this.getChild(\"SelfInfo/RightNode/CoinLabel\")\r\n        this.selfLabelCount = tmpContent.getComponent(cc.Label)\r\n        // this.fontSprite = this.getChild(\"SelfInfo/RightNode/Font\").getComponent(cc.Sprite);\r\n        // this.fontSprite.node.active = false\r\n        let tmpRankLab = this.getChild(\"SelfInfo/LeftNode/RankBg/RankLabel\")\r\n        this.selfRankLab = tmpRankLab.getComponent(cc.Label)\r\n\r\n        this.notInListNode = this.getChild(\"SelfInfo/LeftNode/RankBg/notInList\");\r\n        this.notInListNode.active = false;\r\n\r\n        let tmpRankSp = this.getChild(\"SelfInfo/LeftNode/RankBg\")\r\n        this.selfRankSprite = tmpRankSp.getComponent(cc.Sprite)\r\n\r\n        // this.CommissionUn = this.getComponent(\"PanelNode/RankPanel/TopTitle/topButton/dayRank/unchecked/unchecked\", cc.Sprite)\r\n        // this.CommissionCh = this.getComponent(\"PanelNode/RankPanel/TopTitle/topButton/dayRank/check/unchecked\", cc.Sprite)\r\n\r\n        // this.CommissionUn1 = this.getComponent(\"PanelNode/RankPanel/TopTitle/topButton/weekRank/unchecked/unchecked\", cc.Sprite)\r\n        // this.CommissionCh1 = this.getComponent(\"PanelNode/RankPanel/TopTitle/topButton/weekRank/check/unchecked\", cc.Sprite)\r\n        this.CommissionUn = this.getComponent(\"leftPanel/dayRank/unchecked/label\", cc.Label)\r\n        this.CommissionCh = this.getComponent(\"leftPanel/dayRank/check/label\", cc.Label)\r\n\r\n        this.CommissionUn1 = this.getComponent(\"leftPanel/weekRank/unchecked/label\", cc.Label)\r\n        this.CommissionCh1 = this.getComponent(\"leftPanel/weekRank/check/label\", cc.Label)\r\n        this.SpreadModel = Global.ModelManager.getModel(\"SpreadModel\");\r\n\r\n        this.RankScrollView.node.on(\"scroll-to-bottom\", () => {\r\n            if (this.waitingNode && this.listView.allDatas && this.listView.allDatas.length < 100) {\r\n                this.waitingNode.active = true;\r\n            }\r\n            this.reqNewData()\r\n        }, this);\r\n        let rank_type = this.SpreadModel.RankType\r\n        if (rank_type == 1) {\r\n            // Global.ResourceManager.loadAutoAtlas(this.CommissionUn, this.SpFrameurl, this.SpDayWeek[2],null,false)\r\n            // Global.ResourceManager.loadAutoAtlas(this.CommissionCh, this.SpFrameurl, this.SpDayWeek[3],null,false)\r\n            // Global.ResourceManager.loadAutoAtlas(this.CommissionUn1, this.SpFrameurl, this.SpDayWeek[0],null,false)\r\n            // Global.ResourceManager.loadAutoAtlas(this.CommissionCh1, this.SpFrameurl, this.SpDayWeek[1],null,false)\r\n\r\n            //暂时屏蔽 @parker\r\n            //this.CommissionUn.string = this.DayWeek[1];\r\n            //this.CommissionCh.string = this.DayWeek[1];\r\n            //this.CommissionUn1.string = this.DayWeek[0];\r\n            //this.CommissionCh1.string = this.DayWeek[0];\r\n\r\n        }\r\n        else if (rank_type == 2) {\r\n            // Global.ResourceManager.loadAutoAtlas(this.CommissionUn, this.SpFrameurl, this.SpDayWeek[6],null,false)\r\n            // Global.ResourceManager.loadAutoAtlas(this.CommissionCh, this.SpFrameurl, this.SpDayWeek[7],null,false)\r\n            // Global.ResourceManager.loadAutoAtlas(this.CommissionUn1, this.SpFrameurl, this.SpDayWeek[4],null,false)\r\n            // Global.ResourceManager.loadAutoAtlas(this.CommissionCh1, this.SpFrameurl, this.SpDayWeek[5],null,false)\r\n\r\n            //暂时屏蔽 @parker\r\n            // this.CommissionUn.string = this.DayWeek[3];\r\n            // this.CommissionCh.string = this.DayWeek[3];\r\n            // this.CommissionUn1.string = this.DayWeek[2];\r\n            // this.CommissionCh1.string = this.DayWeek[2];\r\n\r\n        }\r\n        this.selfheadImg = this.getChild(\"SelfInfo/LeftNode/headImg\")\r\n\r\n        this.InitScrollViewObj()\r\n\r\n        if (this.waitingNode == null || this.waitingNode == undefined) {\r\n            //view 内的loading\r\n            this.waitingNode = WaitingView.initWaitingView(this.node, cc.v2(0, 0));\r\n        }\r\n    }\r\n\r\n    reqNewData() {\r\n        let rankType = this.SpreadModel.RankType\r\n        if (rankType == 1) {\r\n            if (this.curWin == 0) {\r\n                this.RankModel.reqRankInfo(3, true);\r\n                return\r\n            }\r\n            this.RankModel.reqRankInfo(1, true);\r\n        }\r\n        else if (rankType == 2) {\r\n            if (this.curWin == 0) {\r\n                this.RankModel.reqRankInfo(6, true);\r\n                return\r\n            }\r\n            this.RankModel.reqRankInfo(1, true);\r\n        }\r\n\r\n    }\r\n\r\n    InitScrollViewObj() {\r\n        let item_setter = (item, index) => {\r\n            let data = this.listView.allDatas[index];\r\n\r\n            item.getComponent(\"RankItem\").Init(data)\r\n        };\r\n        this.listView = Global.UIHelper.addScrollViewCarmackComp(this.RankScrollView.node, this.copyItem, 15, 0, this, item_setter);\r\n    }\r\n\r\n\r\n    initSelfPanel(rank: any, profit: any) {\r\n        if (Number(Global.PlayerData.headimg)) {\r\n            let headSprite = this.selfheadImg.getComponent(cc.Sprite)\r\n            let tempFrame = Global.Toolkit.getLocalHeadSf(Global.PlayerData.headimg)\r\n            headSprite.spriteFrame = tempFrame\r\n        } else {\r\n            Global.Toolkit.loadWebPic(this.selfheadImg, Global.PlayerData.headimg)\r\n        }\r\n        this.selfLabelID.string = Global.PlayerData.uid.toString();\r\n        this.selfLabelName.string = Global.Toolkit.substrEndWithElli(Global.PlayerData.nickname, 8);\r\n        this.selfLabelCount.string = Global.Toolkit.GetText(profit);\r\n        this.selfRankLab.node.active = false;\r\n\r\n        let atlasPath = \"hall/texture/rank/rankAtlas\"\r\n        if (rank == null || rank == undefined || rank > 100 || rank == 0) {\r\n            this.selfRankSprite.spriteFrame = null;\r\n            this.selfRankLab.node.active = false\r\n            //显示未上榜\r\n            this.notInListNode.active = true;\r\n            return\r\n        }\r\n        if (rank && rank > 3) {\r\n            if (Global.Setting.SkinConfig.isPurple)\r\n                Global.ResourceManager.loadAutoAtlas(this.selfRankSprite, atlasPath, \"rank_04\", null, false);\r\n            else\r\n                this.selfRankSprite.spriteFrame = null;\r\n            this.selfRankLab.node.active = true;\r\n            this.notInListNode.active = false;\r\n            this.selfRankLab.string = rank;\r\n        }\r\n        else {\r\n            this.notInListNode.active = false;\r\n            switch (rank) {\r\n                case 1:\r\n                    Global.ResourceManager.loadAutoAtlas(this.selfRankSprite, atlasPath, \"rank_01\", null, false);\r\n                    break;\r\n                case 2:\r\n                    Global.ResourceManager.loadAutoAtlas(this.selfRankSprite, atlasPath, \"rank_02\", null, false);\r\n                    break;\r\n                case 3:\r\n                    Global.ResourceManager.loadAutoAtlas(this.selfRankSprite, atlasPath, \"rank_03\", null, false);\r\n                    break;\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n    protected onClose() {\r\n        this.RankModel.clear()\r\n        this.RankModel.off(RankModel.RefreshScrollview, this, this.RefreshScrollView)\r\n        this.RankModel.off(RankModel.UpdateRankData, this, this.UpdataListData)\r\n\r\n    }\r\n\r\n    public RefreshScrollView(msg: any) {\r\n        if (!msg)\r\n            return;\r\n        if (this.waitingNode) {\r\n            this.waitingNode.active = false;\r\n        }\r\n        this.OnDataPrepared()\r\n        let arr: Array<any> = msg.pointRankList || [];\r\n        this.listView.allDatas = arr;\r\n        this.listView.updateView();\r\n        this.initSelfPanel(msg.my_rank, msg.my_hit_point);\r\n    }\r\n\r\n    public UpdataListData(data) {\r\n        if (this.waitingNode) {\r\n            this.waitingNode.active = false;\r\n        }\r\n        if (data == null) return\r\n        this.listView.allDatas = data\r\n        this.listView.UpDateScrollData()\r\n    }\r\n\r\n    changeInfoNode(target) {\r\n        if (this.waitingNode) {\r\n            this.waitingNode.active = true;\r\n        }\r\n        this.curWin = 0;\r\n        let cmmi_type = this.SpreadModel.RankType\r\n        if (cmmi_type == 1) {\r\n            this.RankModel.reqRankInfo(3, false);\r\n        }\r\n        else if (cmmi_type == 2) {\r\n            this.RankModel.reqRankInfo(6, false);\r\n        }\r\n        this.setToggleChecked(this.dayRank, true)\r\n        this.setToggleChecked(this.weekRank, false)\r\n        if (target)\r\n            Global.Audio.playBtnSound();\r\n    }\r\n\r\n    changeInfoNode2(target) {\r\n\r\n        if (this.waitingNode) {\r\n            this.waitingNode.active = true;\r\n        }\r\n        this.curWin = 1;\r\n        this.RankModel.reqRankInfo(1, false);\r\n        this.setToggleChecked(this.dayRank, false)\r\n        this.setToggleChecked(this.weekRank, true)\r\n        if (target)\r\n            Global.Audio.playBtnSound();\r\n    }\r\n\r\n    setToggleChecked(targe: cc.Node, flag: boolean) {\r\n        let check = targe.getChildByName(\"check\")\r\n        let normal = targe.getChildByName(\"unchecked\")\r\n        if (check) {\r\n            check.active = flag\r\n        }\r\n        if (normal) {\r\n            normal.active = !flag\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport default WndRank"]}