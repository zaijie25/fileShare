{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\recharge\\WndRechangeBankInfo.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WndBase from \"../../../core/ui/WndBase\";\r\nimport RechargeModel from \"../../../hallcommon/model/RechargeModel\";\r\nimport { NetAppface } from \"../../../core/net/hall/NetEvent\";\r\nexport default class WndRechangeBankInfo extends WndBase{\r\n    private model: RechargeModel;\r\n    private bankLbl: cc.Label;\r\n    private bankNumLbl: cc.Label;\r\n    private bankUserLbl: cc.Label;\r\n    private idLbl: cc.Label;\r\n    private payLbl: cc.Label;\r\n    private payTimeLbl: cc.Label;\r\n    private payNameEdit: cc.EditBox;\r\n    private data: any;\r\n    private isOverseas:boolean; //是否是海外支付\r\n    private viewCfg:any;        //适配海外支付/银行卡支付配置\r\n    protected onInit() {\r\n        this.name = \"WndRechangeBankInfo\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/Recharge/RechangeBankInfoUI\";\r\n    }\r\n\r\n    protected initView(){\r\n        this.model = Global.ModelManager.getModel(\"RechargeModel\");\r\n        \r\n        this.addCommonClick(\"close\", this.closeWnd, this);\r\n        this.bankLbl = this.getComponent(\"centerNode/bank/bankLbl\", cc.Label);\r\n        this.bankNumLbl = this.getComponent(\"centerNode/bankNum/bankNumLbl\", cc.Label);\r\n        this.addCommonClick(\"centerNode/bankNum/copyBtn\", this.onCopyCardNumClick, this);\r\n        this.bankUserLbl = this.getComponent(\"centerNode/bankUser/bankUserLbl\", cc.Label);\r\n        this.addCommonClick(\"centerNode/bankUser/copyBtn\", this.onCopyUserClick, this);\r\n        this.idLbl = this.getComponent(\"centerNode/ID/idLbl\", cc.Label);\r\n        this.addCommonClick(\"centerNode/ID/copyBtn\", this.onCopyUserIdClick, this);\r\n        this.payLbl = this.getComponent(\"centerNode/pay/payLbl\", cc.Label);\r\n        this.payTimeLbl = this.getComponent(\"centerNode/payTime/timeLbl\", cc.Label);\r\n        this.payNameEdit = <cc.EditBox>this.getComponent(\"centerNode/payName/nameEditBox\", cc.EditBox);\r\n        this.addCommonClick(\"centerNode/sureBtn\", this.reqSubmitOrder, this);\r\n    }\r\n\r\n    private initData(){\r\n        this.bankLbl.string = this.data['card_type'];\r\n        this.bankNumLbl.string = this.data[\"card_no\"];\r\n        this.bankUserLbl.string = this.data[\"card_name\"];\r\n        this.idLbl.string = String(Global.PlayerData.uid);\r\n    }\r\n\r\n    private onCopyCardNumClick(){\r\n        Global.NativeEvent.copyTextToClipboard(this.bankNumLbl.string, this.copyTextToClipboardCallBack.bind(this));\r\n    }\r\n\r\n    private onCopyUserClick(){\r\n        Global.NativeEvent.copyTextToClipboard(this.bankUserLbl.string, this.copyTextToClipboardCallBack.bind(this));\r\n    }\r\n\r\n    private onCopyUserIdClick(){\r\n        Global.NativeEvent.copyTextToClipboard(this.idLbl.string, this.copyTextToClipboardCallBack.bind(this));\r\n    }\r\n\r\n    private copyTextToClipboardCallBack(retStr){\r\n        if (retStr.result == 0) {\r\n            Global.UI.fastTip(\"复制成功\");\r\n        }else {\r\n            Global.UI.fastTip(\"复制失败\");\r\n        }\r\n    }\r\n\r\n    protected onOpen(data){\r\n        this.payLbl.string = String(data[0]);\r\n        this.data = data[1] || {};\r\n        this.isOverseas = data[2] || false;\r\n        this.payNameEdit.string = '';\r\n        this.payTimeLbl.string = Global.Toolkit.parseTime(Date.now());\r\n        Global.HallServer.on(NetAppface.UserUnionPay, this, this.onSubmitOrder);\r\n        this.adaptOverseasPay();\r\n        this.initData();\r\n    }\r\n\r\n    private adaptOverseasPay(){\r\n        this.viewCfg = this.isOverseas ? Global.Setting.SkinConfig.rechangeOverseasBankInfoCfg : Global.Setting.SkinConfig.rechangeUnionpayBankInfoCfg;\r\n        //复制按钮\r\n        this.adaptCopyBtn();\r\n        //提交订单按钮\r\n        this.adaptSureBtn();\r\n        //提示内容\r\n        this.adaptTips();\r\n    }\r\n\r\n    private adaptCopyBtn(){\r\n        let type = this.viewCfg['copyBtnType'];\r\n        let content = this.viewCfg['copyBtnContent'];\r\n        if(type === \"cc.RichText\"){\r\n            let bankNumCopy = this.getComponent(\"centerNode/bankNum/copyBtn/New RichText\",type) as cc.RichText;\r\n            let bankUserCopy = this.getComponent(\"centerNode/bankUser/copyBtn/New RichText\",type) as cc.RichText;\r\n            let idCopy = this.getComponent(\"centerNode/ID/copyBtn/New RichText\",type) as cc.RichText;\r\n            bankNumCopy.string = content;\r\n            bankUserCopy.string = content;\r\n            idCopy.string = content;\r\n        }else if(type === \"cc.Sprite\"){\r\n            let bankNumCopy = this.getComponent(\"centerNode/bankNum/copyBtn/New RichText\",type) as cc.Sprite;\r\n            let bankUserCopy = this.getComponent(\"centerNode/bankUser/copyBtn/New RichText\",type) as cc.Sprite;\r\n            let idCopy = this.getComponent(\"centerNode/ID/copyBtn/New RichText\",type) as cc.Sprite;\r\n            // let spName = this.isOverseas ? \"button_zi_copy\" : \"button_zi_fz\";\r\n            // Global.ResourceManager.loadAutoAtlas(bankNumCopy, content, spName);\r\n            // Global.ResourceManager.loadAutoAtlas(bankUserCopy, content, spName);\r\n            // Global.ResourceManager.loadAutoAtlas(idCopy, content, spName);\r\n        }\r\n    }\r\n\r\n    private adaptSureBtn(){\r\n        let type = this.viewCfg['sureBtnType'];\r\n        let content = this.viewCfg['sureBtnContent'];\r\n        // if(type === \"cc.Sprite\"){\r\n        //     let sureBtn = this.getComponent(\"centerNode/sureBtn/g_4\",type) as cc.Sprite;\r\n        //     let spName = this.isOverseas ? \"button_zi_yes\" : \"button_zi_tijiaodd\";\r\n        //     if(Global.Setting.SkinConfig.isPurple && !this.isOverseas){//紫色特殊处理并且不是海外支付的\r\n        //         spName = \"g_4\";\r\n        //         let btnSprite = Global.ResourceManager.getSprite(content,spName);\r\n        //         sureBtn.spriteFrame = btnSprite;\r\n        //     }else{\r\n        //         Global.ResourceManager.loadAutoAtlas(sureBtn, content, spName);\r\n        //     }\r\n        // }else if(type === \"cc.Label\"){\r\n        //     let sureBtn = this.getComponent(\"centerNode/sureBtn/g_4\",type) as cc.Label;\r\n        //     sureBtn.string = content;\r\n        // }\r\n    }\r\n\r\n    private adaptTips(){\r\n        // let tipEnglishSize = this.viewCfg['tipEnglishSize'];\r\n        // let tipEnglishColor = this.viewCfg['tipEnglishColor'];\r\n        // let tipChineseSize = this.viewCfg['tipChineseSize'];\r\n        // let tipChineseColor = this.viewCfg['tipChineseColor'];\r\n        // let tipsRichText = this.getComponent(\"centerNode/tipsLbl\",cc.RichText) as cc.RichText;\r\n        // tipsRichText.horizontalAlign = this.isOverseas ? cc.macro.TextAlignment.CENTER : cc.macro.TextAlignment.LEFT;\r\n        // let tipStr = \"<color=%s><size=%s>请您复制收款银行的卡号和姓名，线下转账至该银行卡后，返回此界面添加您转账账户的真实姓名后提交订单！若有任何疑问请</c><color=%s><size=%s>联系客服</color>\";\r\n        // if(this.isOverseas){\r\n        //     tipStr = \"<color=%s><size=%s>If you have any questions, please contact customer service!</c><br/><color=%s><size=%s>如有问题，请联系客服咨询！</color>\";\r\n        // }\r\n        // let str = cc.js.formatStr(tipStr,tipEnglishColor,tipEnglishSize,tipChineseColor,tipChineseSize);\r\n        // tipsRichText.string = str;\r\n    }\r\n\r\n    private reqSubmitOrder(){\r\n        if (this.payNameEdit.string == '')\r\n            return Global.UI.fastTip(\"请输入转账姓名\");\r\n        this.model.reqUserUnionPay(this.data.type, Number(this.payLbl.string), this.payNameEdit.string);\r\n    }\r\n\r\n    private onSubmitOrder(){\r\n        Global.UI.fastTip(\"提交订单成功\");\r\n        this.closeWnd();\r\n    }\r\n\r\n    private closeWnd(){\r\n        this.close();\r\n    }\r\n}"]}