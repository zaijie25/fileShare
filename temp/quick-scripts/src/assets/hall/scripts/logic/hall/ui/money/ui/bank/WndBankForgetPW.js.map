{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\money\\ui\\bank\\WndBankForgetPW.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WndBase from \"../../../../../core/ui/WndBase\";\r\nimport BankModel from \"../../../../../hallcommon/model/BankModel\";\r\nimport PhoneInputView from \"../../../login/view/PhoneInputView\";\r\nimport AutoCodeView from \"../../../login/view/AutoCodeView\";\r\n\r\nexport default class WndBankForgetPW extends WndBase {\r\n\r\n    //private _pwCheckRx : RegExp = /^.*(?=.{6,16})(?=.*\\d)(?=.*[A-Z]{2,})(?=.*[a-z]{2,})(?=.*[!@#$%^&*?\\(\\)]).*$/;\r\n    // private _pwCheckRx : RegExp = /^.*(?=.{6,16})(?=.*\\d)(?=.*[a-zA-Z]).*$/;\r\n    private _pwCheckString : string = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\r\n\r\n    private model : BankModel;\r\n\r\n    private phoneInputView : PhoneInputView;\r\n    private phoneLabel : cc.RichText;\r\n\r\n    private authCodeView : AutoCodeView;\r\n    private pwEditBox1 : cc.EditBox;\r\n    //private pwEditBox2 : cc.EditBox;\r\n\r\n    protected onInit()\r\n    {\r\n        this.name = \"WndBankForgetPW\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/money/bank/BankForgetPWUI\";\r\n        this.model = <BankModel>Global.ModelManager.getModel(\"BankModel\");\r\n    }\r\n\r\n    protected initView()\r\n    {\r\n        this.node.width = cc.Canvas.instance.node.width;\r\n        this.node.height = cc.Canvas.instance.node.height;\r\n\r\n        this.addCommonClick(\"close\",this.close,this);\r\n        this.addCommonClick(\"confirmBtn\",this.confirmBtnFunc,this);\r\n\r\n        this.phoneInputView = <PhoneInputView>this.addView(\"PhoneInputView\", this.getChild(\"phoneContainer\"), PhoneInputView);\r\n        this.phoneLabel = this.getComponent(\"phoneNumLabel\",cc.RichText);\r\n\r\n        this.authCodeView = <AutoCodeView>this.addView(\"AutoCodeView\", this.getChild(\"authCodeView\"), AutoCodeView);\r\n        this.authCodeView.setPhoneInputAndType(this.phoneInputView, 2);\r\n        this.pwEditBox1 = this.getComponent(\"PasswordBox1/editBox\",cc.EditBox);\r\n        //this.pwEditBox2 = this.getComponent(\"PasswordBox2/editBox\",cc.EditBox);\r\n    }\r\n\r\n    protected onOpen(args)\r\n    {\r\n        this.phoneInputView.subViewState = true\r\n        this.authCodeView.subViewState = true\r\n        var havePhone = (Global.PlayerData.phone != null && Global.PlayerData.phone != \"\");\r\n        if(havePhone){ //已绑定电话\r\n            this.phoneLabel.node.active = true;\r\n            let phone = Global.Toolkit.formateStrWithAsterisk(Global.PlayerData.phone, Global.PlayerData.phone.length-5, 1);\r\n            this.phoneLabel.string = \"<b>\" + phone+ \"</b>\";\r\n            this.phoneInputView.node.active = false;\r\n            var data = Global.PlayerData.phone.split(' ');\r\n            this.phoneInputView.area = data[0].replace(\"+\",\"\");\r\n            this.phoneInputView.phone = data[1];\r\n        }else{ //未绑定电话\r\n            this.phoneLabel.node.active = false;\r\n            this.phoneLabel.string = \"\";\r\n\r\n            this.phoneInputView.node.active = true;\r\n            this.phoneInputView.area = \"86\";\r\n            this.phoneInputView.phone = \"\";\r\n        }\r\n        this.authCodeView.code = \"\";\r\n        this.pwEditBox1.string = \"\";\r\n        //this.pwEditBox2.string = \"\";\r\n    }\r\n\r\n    private checkTextEmptyAndShowTips(text:string, tipsLabel:string)\r\n    {\r\n        if(text.length <= 0)\r\n        {\r\n            this.model.showBankTips(tipsLabel);\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private checkPWFormat(text:string, tipsLabel:string){\r\n        let bValid : boolean = Global.Toolkit.checkPWFormat(text);\r\n        if(!bValid){\r\n            this.model.showBankTips(tipsLabel);\r\n        }\r\n        return bValid;\r\n    }\r\n\r\n    /** 确认按钮 */\r\n    confirmBtnFunc(){\r\n        if(!this.checkTextEmptyAndShowTips(this.phoneInputView.phone, \"手机号不能为空\"))\r\n            return;\r\n        if(!this.checkTextEmptyAndShowTips(this.authCodeView.code, \"验证码不能为空\"))\r\n            return;\r\n        if(!this.checkPWFormat(this.pwEditBox1.string, \"请按要求输入6~16位数字和字母密码\"))\r\n            return;\r\n        \r\n        if(!this.phoneInputView.isAreaVaild())\r\n        {\r\n            Global.UI.fastTip(\"请选择正确的地区信息\");\r\n            return;\r\n        }\r\n        // if(!this.checkPWFormat(this.pwEditBox2.string, \"请按要求输入6~16位数字和字母密码\"))\r\n        //     return;\r\n        // if(this.pwEditBox1.string != this.pwEditBox2.string){\r\n        //     this.model.showBankTips(\"\"新密码输入不一致，请重新输入\"\");\r\n        //     return;\r\n        // }\r\n        this.model.reqForgetBankPwd(this.phoneInputView.phone,this.authCodeView.code,this.pwEditBox1.string,this.phoneInputView.area);\r\n    }\r\n\r\n    \r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]}