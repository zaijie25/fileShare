{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\playerInfo\\WndChooseHead.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WndBase from \"../../../core/ui/WndBase\";\r\nimport PlayerInfoModel from \"../../../hallcommon/model/PlayerInfoModel\";\r\nimport HeadLayerView from \"./HeadLayerView\";\r\nimport HeadFrameLayerView from \"./HeadFrameLayerView\";\r\n\r\nexport default class WndChooseHead extends WndBase{\r\n\r\n    /**\r\n     * 数据对象\r\n     */\r\n    private model: PlayerInfoModel;\r\n    //头像\r\n    spriteHead:cc.Sprite = null;\r\n    //头像框\r\n    spriteHeadFrame:cc.Sprite = null;\r\n\r\n    /**\r\n     * 当前页签\r\n     */\r\n    curViewIndex:number = -1;\r\n    /**\r\n     * 页签根节点集合\r\n     */\r\n    yeqianRootNodeArr:cc.Node[] = [];\r\n    /**\r\n     * 页签节点集合\r\n     */\r\n\r\n    headLayerView:HeadLayerView\r\n    headFrameLayerView:HeadFrameLayerView\r\n    yeqianArr:cc.Node[] = [];\r\n\r\n    /**\r\n     * 初始化脚本\r\n     */\r\n    protected onInit() {\r\n        this.name = \"WndChooseHead\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/PlayerInfo/ChooseHeadUI\";\r\n        this.model = <PlayerInfoModel>Global.ModelManager.getModel(\"PlayerInfoModel\");\r\n    }\r\n\r\n    onDispose(){\r\n        Global.Event.off(GlobalEvent.PERSONALINFOUPDATE, this, this.refreshPersonInfo)\r\n\r\n    }\r\n\r\n    /**\r\n     * 初始化UI\r\n     */\r\n    protected initView() {\r\n        Global.Event.on(GlobalEvent.PERSONALINFOUPDATE, this, this.refreshPersonInfo)\r\n\r\n        this.addCommonClick(\"bg/close\",this.closeBtnFunc,this);\r\n\r\n        this.spriteHead =this.getComponent(\"headImg/headFrame\", cc.Sprite);\r\n        this.spriteHeadFrame = this.getComponent(\"headbox\", cc.Sprite);\r\n\r\n        for(var i = 0; i < 2; i++){\r\n            var yeqianNode:cc.Node = this.addCommonClick( \"yeqian/yeqian_\" + i, this.subViewBtnFunc, this);\r\n            this.yeqianRootNodeArr[i] = yeqianNode;\r\n\r\n            this.yeqianArr[i * 2] = cc.find(\"noSelected\", yeqianNode);\r\n            this.yeqianArr[i * 2 + 1] = cc.find(\"selected\", yeqianNode);\r\n           \r\n        }\r\n        this.headLayerView = <HeadLayerView>this.addView(\"HeadLayerView\", this.getChild(\"content/content_0\"), HeadLayerView);\r\n        this.headFrameLayerView = <HeadFrameLayerView>this.addView(\"HeadFrameLayerView\", this.getChild(\"content/content_1\"), HeadFrameLayerView);\r\n        this.yeqianRootNodeArr[1].active = !Global.Setting.vipDisable;\r\n\r\n    }\r\n\r\n    UpdateUI(){\r\n        for(var i = 0; i < 2; i++){\r\n            var bShow:boolean = (i == this.curViewIndex);\r\n            var yeqianNode = this.yeqianArr[i * 2 + 1];\r\n            yeqianNode.active = bShow;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 页签按钮点击\r\n     * @param target \r\n     */\r\n    subViewBtnFunc(target){\r\n        var arr = target.node.name.split(\"_\");\r\n        var param = arr[arr.length - 1];\r\n        var viewIndex = parseInt(param);\r\n        this.changeView(viewIndex)\r\n    }\r\n\r\n    changeView(viewIndex: number) {\r\n       \r\n        if(this.curViewIndex != viewIndex){\r\n            this.curViewIndex = viewIndex;\r\n            this.headLayerView.subViewState = this.curViewIndex == 0\r\n            this.headFrameLayerView.subViewState = this.curViewIndex == 1\r\n            this.UpdateUI();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 界面打开回调\r\n     */\r\n    protected onOpen(){\r\n        this.model.reqGetUserInfo(null,null);\r\n        this.refreshPersonInfo();\r\n        this.changeView(0);\r\n    }\r\n\r\n    private refreshPersonInfo(){\r\n        if(Global.SceneManager.inGame())\r\n        {\r\n            return\r\n        }\r\n        var data = Global.PlayerData;\r\n        this.spriteHead.spriteFrame = Global.Toolkit.getLocalHeadSf(data.headimg);\r\n        //头像框设置\r\n        Global.Toolkit.loadLocalHeadFrame(this.spriteHeadFrame, data.headkuang);\r\n    }\r\n    /**\r\n     * 界面关闭回调\r\n     */\r\n    protected onClose(){\r\n        this.curViewIndex = -1\r\n    }\r\n\r\n    \r\n    /**\r\n     * 关闭按钮点击\r\n     */\r\n    private closeBtnFunc(){\r\n        this.close();\r\n    }\r\n}"]}