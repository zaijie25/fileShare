{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\rebate\\WndRedEnvelope.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport WndBase, { DestoryType } from \"../../../core/ui/WndBase\";\r\nimport { NetAppface } from \"../../../core/net/hall/NetEvent\";\r\nimport HallModel from \"../../../hallcommon/model/HallModel\";\r\nexport default class WndRedEnvelope extends WndBase{\r\n    private rabateLbl: cc.Label;\r\n    private openSke: sp.Skeleton;\r\n    private goodLuck: cc.Node;\r\n    private winMoney: cc.Node;\r\n    private winMoney2: cc.Node;\r\n    private goodLuckTitle: cc.Node;\r\n    private newPersonTitle: cc.Node;\r\n    private winMoneyTitle: cc.Node;\r\n    private data;\r\n    private model: HallModel;\r\n    private closeCallback: Function;\r\n    protected onInit() {\r\n        this.name = \"WndRedEnvelope\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/Rebate/RedEnvelopeUI\";\r\n        this.destoryType = DestoryType.None\r\n    }\r\n\r\n    protected initView(){\r\n        this.model = <HallModel>Global.ModelManager.getModel(\"HallModel\");\r\n        this.addCommonClick(\"openBtn\", this.onSureBtnClick, this);\r\n        this.rabateLbl = <cc.Label>this.getComponent(\"rebateLbl\", cc.Label);\r\n        this.openSke = <sp.Skeleton>this.getComponent(\"openBtn\", sp.Skeleton);\r\n        this.goodLuck = this.getChild(\"goodLuck\")\r\n        this.winMoney = this.getChild(\"winMoney\")\r\n        this.winMoney2 = this.getChild(\"winMoney2\")\r\n        this.goodLuckTitle = this.getChild(\"goodLuckTitle\")\r\n        this.newPersonTitle = this.getChild(\"newPersonTitle\")\r\n        this.winMoneyTitle = this.getChild(\"winMoneyTitle\")\r\n    }\r\n\r\n    private onSureBtnClick(){\r\n        this.openSke.clearTrack(0)\r\n        this.openSke.setAnimation(0, \"idle_NO\", false)\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.ReceiveRewardPack, {id:this.data.id},(retObj) => {\r\n            this.closeWnd()\r\n            //重新获取剩余红包\r\n        },(error) => {\r\n            Global.UI.fastTip(error._errstr);\r\n            // console.log(error);\r\n        },false);\r\n    }\r\n\r\n    protected onOpen(arr){\r\n        if(this.openSke){\r\n            this.openSke.clearTrack(0)\r\n            this.openSke.setAnimation(0,\"idle_Loop\",true);\r\n        }\r\n        this.data = arr[0];\r\n        this.closeCallback = arr[1];\r\n        let type = this.data.pack_type;\r\n        if(type === 1){ //新人\r\n            this.goodLuck.active = false;\r\n            this.goodLuckTitle.active = false;\r\n            this.winMoney.active =false;\r\n            this.winMoney2.active =false;\r\n            this.newPersonTitle.active =true;\r\n            this.winMoneyTitle.active =false;\r\n        }\r\n        else if(type === 2) //好运\r\n        {\r\n            this.goodLuck.active = true;\r\n            this.goodLuckTitle.active = true;\r\n            this.winMoney.active =false;\r\n            this.winMoney2.active =false;\r\n            this.newPersonTitle.active =false;\r\n            this.winMoneyTitle.active =false;\r\n        }else{ //赢钱\r\n            this.goodLuck.active = false;\r\n            this.goodLuckTitle.active = false;\r\n            this.winMoney.active =true;\r\n            this.winMoney2.active =true;\r\n            this.newPersonTitle.active =false;\r\n            this.winMoneyTitle.active =true;\r\n        }\r\n        this.rabateLbl.string = Global.Toolkit.formatPointStr(this.data.point||0, true)\r\n        // if(arr[1])\r\n        // {\r\n        //     this.bindAwardType = arr[1];\r\n        // }\r\n        // var model = <BindingGiftModel>Global.ModelManager.getModel(\"BindingGiftModel\");\r\n        // this.rabateLbl.node.active = false;\r\n        // this.effectSk && this.effectSk.setAnimation(0, \"idle\", false);\r\n\r\n    }\r\n\r\n    private closeWnd(){\r\n        if(this.closeCallback){\r\n            this.closeCallback();\r\n        }\r\n        this.close();\r\n    }\r\n\r\n    protected onClose(){\r\n\r\n    }\r\n    onDispose()\r\n    {\r\n    }\r\n}"]}