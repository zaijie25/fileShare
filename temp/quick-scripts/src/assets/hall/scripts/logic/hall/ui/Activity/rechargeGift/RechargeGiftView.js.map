{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\Activity\\rechargeGift\\RechargeGiftView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport ViewBase from \"../../../../core/ui/ViewBase\";\r\nimport RechargeGiftModel from \"../../../../hallcommon/model/RechargeGiftModel\";\r\nimport { ActivityConstants, ActivityType } from \"../ActivityConstants\";\r\n\r\nexport default class RechargeGiftView extends ViewBase {\r\n\r\n    private model: RechargeGiftModel\r\n    private timeLabel:cc.Label\r\n    private processLabel:cc.RichText\r\n    private progressBarMask:cc.Node\r\n    private progressBarSprite:cc.Node\r\n\r\n    private panel :cc.Node\r\n    private finished :boolean = true\r\n    private formatStr:string = \"<i><color=#FFF799>赢取进度: </c></i><i><color=#FFF100>%s</c></i>\"\r\n    private progressLabel1:cc.Label\r\n    private progressLabel2:cc.Label\r\n    private progressLabel3:cc.Label\r\n    private progressLabel4:cc.Label\r\n\r\n    private minRechargeLabel:cc.Label\r\n    private rewardLabel:cc.Label\r\n\r\n    private joinConditionLabel :cc.Label\r\n    private getAwardConditionLabel :cc.Label\r\n\r\n\r\n    private boxSpine:sp.Skeleton\r\n    private boxOpen:cc.Node\r\n    private boxClose:cc.Node\r\n    private finishSprite:cc.Node\r\n\r\n    protected initView() {\r\n       \r\n        this.model = <RechargeGiftModel>Global.ModelManager.getModel(\"RechargeGiftModel\");\r\n\r\n        this.model.on(RechargeGiftModel.GetAward, this, this.onGetAward);\r\n        this.model.on(RechargeGiftModel.GetCfg, this, this.onGetCfg);\r\n\r\n        this.timeLabel = this.getComponent(\"spinenNode/panel/content/timeLabel\",cc.Label)\r\n        this.processLabel = this.getComponent(\"spinenNode/panel/awardContent/progress\",cc.RichText)\r\n        this.progressBarMask = cc.find(\"spinenNode/panel/awardContent/progressBarMask\", this.node)\r\n        this.progressBarSprite = cc.find(\"spinenNode/panel/awardContent/progressBarMask/bar\", this.node)\r\n        \r\n        this.joinConditionLabel = this.getComponent(\"spinenNode/panel/content/contionLabel\",cc.Label)\r\n        this.getAwardConditionLabel = this.getComponent(\"spinenNode/panel/content/AwardTips\",cc.Label)\r\n        \r\n\r\n        this.panel = this.getChild(\"spinenNode/panel\")\r\n        this.progressLabel1 = this.getComponent(\"spinenNode/panel/awardContent/NumLabel1\",cc.Label)\r\n        this.progressLabel2 = this.getComponent(\"spinenNode/panel/awardContent/NumLabel2\",cc.Label)\r\n        this.progressLabel3 = this.getComponent(\"spinenNode/panel/awardContent/NumLabel3\",cc.Label)\r\n        this.progressLabel4 = this.getComponent(\"spinenNode/panel/awardContent/NumLabel4\",cc.Label)\r\n        this.rewardLabel = this.getComponent(\"spinenNode/panel/TipSp/award\",cc.Label)\r\n        this.minRechargeLabel = this.getComponent(\"spinenNode/panel/TipSp/min\",cc.Label)\r\n        this.finishSprite = cc.find(\"spinenNode/panel/awardContent/finishSprite\", this.node)\r\n       \r\n        this.addCommonClick(\"spinenNode/panel/getAward\",this.reqGetAward,this)\r\n\r\n        if(Global.Setting.SkinConfig.isPurple || Global.Setting.SkinConfig.isBlue)\r\n        {\r\n            this.boxSpine = this.getComponent(\"spinenNode/panel/box\",sp.Skeleton)\r\n        }\r\n        else\r\n        {\r\n            this.boxOpen = this.getChild(\"spinenNode/panel/box/bx_open\")\r\n            if(this.boxOpen) {\r\n                this.boxOpen.active = false\r\n            }\r\n            this.boxClose = this.getChild(\"spinenNode/panel/box/bx_close\")\r\n            if(this.boxClose) {\r\n                this.boxClose.active = false\r\n            }\r\n        }\r\n    }\r\n\r\n    showPanel() {\r\n        this.panel.active = true;\r\n    }\r\n\r\n    onSubViewShow() {\r\n       \r\n        this.model.reqGetActivityCfg(false)\r\n        this.showPanel();\r\n    }\r\n\r\n    private onGetCfg(data) {\r\n        if(data == null) return\r\n        Global.Event.event(ActivityConstants.SHOW_ACT_WAITTING, false)\r\n        let arr = data.data\r\n        if(arr == null) return\r\n        for (let index = 0; index < arr.length; index++) {\r\n            if(arr[index].atype == ActivityType.rechargeGift)\r\n            {\r\n                this.SetAwardLabel(arr[index].cfg)\r\n                this.SetBtnState(arr[index].cfg)\r\n                let num :number = Global.Toolkit.formatPoint(arr[index].cfg.loss_sum)\r\n                let value = (num /Global.Toolkit.formatPoint(arr[index].cfg.loss_mix))\r\n                if(value>=1)\r\n                {\r\n                    value = 1\r\n                    if(this.processLabel) {\r\n                        this.processLabel.string = \"已完成活动，请领取奖励\"\r\n                        this.processLabel.node.active = false\r\n                    }\r\n                    if(this.finishSprite) {\r\n                        this.finishSprite.active = true\r\n                    }\r\n                    this.SetBoxSprite(true)\r\n                }\r\n                else\r\n                {\r\n                    if(this.processLabel) {\r\n                        let tmpstring = Global.Toolkit.formatPoint(arr[index].cfg.loss_sum)+\"/\"+Global.Toolkit.formatPoint(arr[index].cfg.loss_mix).toString()\r\n                        this.processLabel.string = cc.js.formatStr(this.formatStr,tmpstring)\r\n                        this.processLabel.node.active = true\r\n                    }\r\n                    if(this.finishSprite) {\r\n                        this.finishSprite.active = false\r\n                    }\r\n\r\n                    if(Global.Setting.SkinConfig.isPurple && this.boxSpine)\r\n                    {\r\n                        this.boxSpine.setCompleteListener(()=>{\r\n                            this.boxSpine.setAnimation(0,\"idle_AppearLoop\",true)\r\n                        })\r\n                    }\r\n                    else\r\n                    {\r\n                        if(this.boxClose) {\r\n                            this.boxClose.active = true\r\n                        }\r\n                        if(this.boxOpen) {\r\n                            this.boxOpen.active = false\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // this.processBar.progress = value\r\n                this.progressBarMask.width =  this.progressBarSprite.width*value\r\n                \r\n                if(arr[index].cfg.end_time.length === 0) {\r\n                    this.timeLabel.string = \"长期有效\"\r\n                }\r\n                else {\r\n                    this.timeLabel.string =arr[index].cfg.start_time + \"~\"+ arr[index].cfg.end_time\r\n                }\r\n                \r\n                this.joinConditionLabel.string =Global.Toolkit.formatPoint(arr[index].cfg.pay_mix) +\"y\"\r\n                this.getAwardConditionLabel.string = Global.Toolkit.formatPoint(arr[index].cfg.loss_mix) +\"y\"\r\n            }\r\n        }\r\n    }\r\n\r\n    SetAwardLabel(cfg: any) {\r\n        let limit = Global.Toolkit.formatPoint(cfg.loss_mix)\r\n        \r\n        let num = Math.floor(limit/3000)\r\n        this.progressLabel1.string = \"0\"\r\n        this.progressLabel2.string = (1000*num).toString()\r\n        this.progressLabel3.string = (1000*num*2).toString()\r\n        this.progressLabel4.string = limit.toString()\r\n\r\n        this.minRechargeLabel.string = Global.Toolkit.formatPoint(cfg.pay_mix).toString()\r\n        this.rewardLabel.string =  Global.Toolkit.formatPoint(cfg.point).toString()\r\n    }\r\n\r\n    private SetBtnState(data) {\r\n        if(data.pay_sum<data.pay_mix || data.loss_sum<data.loss_mix)\r\n        {\r\n            this.finished = false\r\n        }\r\n        else\r\n        {\r\n            this.finished = true\r\n        }\r\n    }\r\n\r\n    private SetBoxSprite(open) {\r\n        if(open) {\r\n            if(Global.Setting.SkinConfig.isPurple && this.boxSpine)\r\n            {\r\n                this.boxSpine.setCompleteListener(()=>{\r\n                    this.boxSpine.clearTrack(0)\r\n                    this.boxSpine.setAnimation(0,\"idle_ONLoop\",true)\r\n                })\r\n            }\r\n            else\r\n            {\r\n                if(this.boxClose) {\r\n                    this.boxClose.active = false\r\n                }\r\n                if(this.boxOpen) {\r\n                    this.boxOpen.active = true\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private reqGetAward() {\r\n        if(this.finished)\r\n        {\r\n            this.model.reqReceiveActivityAward(ActivityType.rechargeGift)\r\n        }\r\n        else\r\n        {\r\n            Global.UI.fastTip(\"奖励在您完成任务后才能领取哦！\")\r\n        }\r\n    }\r\n\r\n    private onGetAward(awardData) {\r\n        if(awardData && awardData.atype != ActivityType.rechargeGift)\r\n        {\r\n            return\r\n        }\r\n       \r\n        this.model.Switch = false\r\n        Global.UI.getWindow(\"WndActivityCenter\").close();\r\n        Global.UI.show(\"WndRebateGet\", awardData.award);\r\n        Global.Event.event(ActivityConstants.HIDE_RED_PORT,awardData.atype)\r\n    }\r\n\r\n    protected onDispose() {\r\n        this.model.off(RechargeGiftModel.GetAward, this, this.onGetAward);\r\n        this.model.off(RechargeGiftModel.GetCfg, this, this.onGetCfg);\r\n    }\r\n}"]}