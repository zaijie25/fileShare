{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\recharge\\RechargeListView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ViewBase from \"../../../core/ui/ViewBase\";\r\nimport PoolBase from \"../../../core/tool/PoolBase\";\r\nimport RechargeModel from \"../../../hallcommon/model/RechargeModel\";\r\n\r\n\r\nexport default class RechargeListView extends ViewBase {\r\n    private Rechagemodel: RechargeModel;\r\n    private copyItem: any;\r\n    private contentNode: cc.Node;\r\n    private pageLabel: cc.Label;\r\n    private nextBtn: cc.Node;\r\n    private lastBtn: cc.Node;\r\n    //没有数据\r\n    private nothingNode:cc.Node;\r\n    private itemPool: RecordingItemPool;\r\n    private nodeList: any[] = [];\r\n    //当前显示的页数\r\n    private limit = 6\r\n    private arrList: Array<any>\r\n    private isRecharge: boolean\r\n    protected initView()\r\n    {\r\n        this.Rechagemodel = <RechargeModel>Global.ModelManager.getModel(\"RechargeModel\");\r\n        this.Rechagemodel.on(RechargeModel.UpdateHistory, this, this.InitTeamListView);\r\n        Global.UIHelper.addCommonClick(this.node, \"nexPage\", this.OnNextPagePageBtnClick, this);\r\n        Global.UIHelper.addCommonClick(this.node, \"upPage\", this.OnLastPageBtnClick, this);\r\n        this.contentNode = this.getChild(\"scrollview/view/content\");\r\n        this.copyItem = this.getChild(\"scrollview/view/content/Item\");\r\n        this.pageLabel = this.getChild(\"pageLabel\").getComponent(cc.Label);\r\n        this.nothingNode = this.getChild(\"Nothing\");\r\n        this.nothingNode.active = false;\r\n        this.nextBtn = this.getChild(\"nexPage\");\r\n        this.lastBtn = this.getChild(\"upPage\");\r\n        this.copyItem.active = false;\r\n        this.initItemPool()\r\n        \r\n    }\r\n    onOpenRecharge(isRecharge: boolean = false){\r\n        this.isRecharge = isRecharge;\r\n        this.Rechagemodel.reqGetUserPayList()\r\n    }\r\n\r\n    protected onDispose()\r\n    {\r\n        this.itemPool.resetPool()\r\n        this.Rechagemodel.off(RechargeModel.UpdateHistory, this, this.InitTeamListView);\r\n    }\r\n    //下一页\r\n    OnNextPagePageBtnClick() {\r\n        Global.Audio.playBtnSound();\r\n        if(this.arrList.length > this.Rechagemodel.hisListPage * this.limit)\r\n        {\r\n            this.Rechagemodel.hisListPage++;\r\n            this.InitTeamListView();\r\n        }else{\r\n            this.Rechagemodel.reqGetUserPayList(true)\r\n        }\r\n    }\r\n    // 上一页\r\n    OnLastPageBtnClick() {\r\n        Global.Audio.playBtnSound();\r\n        this.Rechagemodel.hisListPage--;\r\n        if(this.Rechagemodel.hisListPage<=0)\r\n        {\r\n            this.Rechagemodel.hisListPage = 1;\r\n            Global.UI.fastTip(\"已经是第一页了\")\r\n            return\r\n        }\r\n        this.InitTeamListView();\r\n    }\r\n    private initItemPool(){\r\n       \r\n        this.itemPool = new RecordingItemPool(this.copyItem);\r\n    }\r\n\r\n    public recycle()\r\n    {\r\n        this.itemPool.recycleAll(this.nodeList);\r\n        this.nodeList = [];\r\n    }\r\n    InitTeamListView() {\r\n        this.arrList = this.Rechagemodel.getHisListData() || [];\r\n        let count = this.arrList.length;\r\n        if(count < 1){\r\n            this.nothingNode.active = true;\r\n            this.pageLabel.node.active = false;\r\n            this.nextBtn.active = false;\r\n            this.lastBtn.active = false;\r\n        }else{\r\n            this.nothingNode.active = false;\r\n            this.pageLabel.node.active = true;\r\n            this.nextBtn.active = true;\r\n            this.lastBtn.active = true;\r\n        }\r\n        if (count ==0)  return;\r\n        let listCount = count - (this.Rechagemodel.hisListPage-1)*this.limit > this.limit?this.limit:count - (this.Rechagemodel.hisListPage-1)*this.limit\r\n        this.recycle();\r\n        for (let j=0; j< listCount; j++){\r\n            let node = this.itemPool.getItem();\r\n            this.nodeList.push(node);\r\n            node.active = true;\r\n            node.setParent(this.contentNode);\r\n            node.getComponent(\"RecordingItem\").Init(this.arrList[(this.Rechagemodel.hisListPage-1)*this.limit+j],j,this.isRecharge)\r\n        }\r\n        let msgFormat = \"共%s条\"\r\n        let str = \"第%s页\"\r\n        this.pageLabel.string = cc.js.formatStr(msgFormat,this.Rechagemodel.hisTotal) + cc.js.formatStr(str,this.Rechagemodel.hisListPage);\r\n    }\r\n\r\n}\r\nclass RecordingItemPool extends PoolBase{\r\n    constructor(private copyNode: cc.Node){\r\n        super();\r\n    }\r\n\r\n    protected createItem(){\r\n        return cc.instantiate(this.copyNode);\r\n    }\r\n\r\n    protected resetItem(node: cc.Node){\r\n        node.active = false;\r\n        node.setParent(null)\r\n    }\r\n    public recycleAll(arr: Array<any>)\r\n    {\r\n        super.recycleAll(arr)\r\n        arr.forEach(ele => {\r\n            this.resetItem(ele);\r\n        });\r\n\r\n    }\r\n    \r\n}\r\n"]}