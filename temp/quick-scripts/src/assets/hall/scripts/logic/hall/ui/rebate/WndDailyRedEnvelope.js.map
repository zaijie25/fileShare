{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\rebate\\WndDailyRedEnvelope.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport WndBase, { DestoryType } from \"../../../core/ui/WndBase\";\r\nimport { NetAppface } from \"../../../core/net/hall/NetEvent\";\r\nimport { ActivityType } from \"../Activity/ActivityConstants\";\r\nimport HallPopMsgHelper from \"../../tool/HallPopMsgHelper\";\r\nexport default class WndDailyRedEnvelope extends WndBase{\r\n    // private closeCallback: Function;\r\n    /**可领取 */\r\n    private selectedNode = [];\r\n    /**已经领取 */\r\n    private noSelectedNode = [];\r\n    private receivedNode = [];\r\n    private dayImgNode = [];\r\n    protected onInit() {\r\n        this.name = \"WndDailyRedEnvelope\";\r\n        this.layer = Global.UI.PopLayer;\r\n        this.resPath = \"hall/prefabs/ui/Rebate/DailyRedEnvelopeUI\";\r\n        this.destoryType = DestoryType.None\r\n    }\r\n\r\n    protected initView(){\r\n        this.selectedNode = [];\r\n        this.noSelectedNode = [];\r\n        this.dayImgNode = [];\r\n        for (let i = 0; i < 5; i++) {\r\n            let item = this.getChild(\"centerNode/item\" + i)\r\n            let selected = cc.find(\"selectedRed\", item)\r\n            let noSelected = cc.find(\"unselectedRed\", item)\r\n            let received = cc.find(\"receivedRed\", item)\r\n            selected.active = false;\r\n            received.active = false;\r\n            noSelected.active = true;\r\n            this.selectedNode.push(selected);\r\n            this.receivedNode.push(received);\r\n            Global.UIHelper.addCommonClick(item, \"selectedRed\", this.onGetDailyRed, this);\r\n            this.noSelectedNode.push(noSelected)\r\n        }\r\n        let dayImgsNode = this.getChild(\"dayImgsNode\");\r\n        for(let i = 0; i < 5; i++){\r\n            let dayImg = cc.find(\"dayImg\" + i, dayImgsNode);\r\n            dayImg.active = true;\r\n            this.dayImgNode.push(dayImg);\r\n        }\r\n        this.addCommonClick(\"button\", this.onOpenRechargeClick, this);\r\n        this.addCommonClick(\"close\", this.closeWnd, this);\r\n    }\r\n\r\n    private onOpenRechargeClick(){\r\n        Global.UI.show(\"WndRecharge\");\r\n        this.closeWnd();\r\n    }\r\n\r\n    protected onOpen(arr){\r\n        this.updateUI()\r\n        // this.closeCallback = arr[0];\r\n    }\r\n    private updateUI(){\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.GetActivityCfg, {}, (data) => {\r\n            let arr = data.data\r\n            for (let index = 0; index < data.data.length; index++) {\r\n                let cfg = arr[index];\r\n                if (cfg && cfg.atype == ActivityType.dailyPayRedpack) {\r\n                    let dataArr = cfg.cfg.cfg.list\r\n                    for (let i = 0; i < dataArr.length; i++) {\r\n                        let nodeData =  dataArr[i];\r\n                        let selected = this.selectedNode[i]\r\n                        selected.data = nodeData;\r\n                        let noSelected = this.noSelectedNode[i];\r\n                        let received = this.receivedNode[i];\r\n                        let dayImg = this.dayImgNode[i]\r\n                        let selectedlabel = cc.find(\"jibiLabel\", selected).getComponent(cc.Label);\r\n                        let noSelectedlabel = cc.find(\"jibiLabel\", noSelected).getComponent(cc.Label);\r\n                        let receivedlabel = cc.find(\"jibiLabel\", received).getComponent(cc.Label);\r\n                        // let spine = cc.find(\"spine\", selected);\r\n                        selectedlabel.string = noSelectedlabel.string = receivedlabel.string =  Global.Toolkit.GetMoneyFormat(nodeData.reward);\r\n                        // 0未充值 1已充值不能领取 2可以领取 3已领取 4已失效\r\n                        if (nodeData.status == 1) {\r\n                            dayImg.active = true;\r\n                            selected.active = true;\r\n                            noSelected.active = false;\r\n                            received.active = false;\r\n                        }else if (nodeData.status == 2) {\r\n                            dayImg.active = true;\r\n                            selected.active = true;\r\n                            noSelected.active = false;\r\n                            received.active = false;\r\n                        }else if (nodeData.status == 3) {\r\n                            selected.active = false;\r\n                            selected.active = false;\r\n                            received.active = true;\r\n                            noSelected.active = false;\r\n                        }else{\r\n                            selected.active = true;\r\n                            selected.active = false;\r\n                            received.active = false;\r\n                            noSelected.active = true;\r\n                        }\r\n                    }\r\n                    break\r\n                }\r\n            }\r\n        }, null, false, 0);\r\n    }\r\n    private onGetDailyRed(target){\r\n        if(target && target.node && target.node.data){\r\n            if(target.node.data.status == 1){\r\n                Global.UI.fastTip(\"明日才可以领取红包哦\");\r\n            }else if(target.node.data.status == 2){\r\n                Global.HallServer.send(NetAppface.mod, NetAppface.ReciveDailyRedpack, {},(retObj) => {\r\n                    this.updateUI()\r\n                    Global.UI.show(\"WndRebateGet\", retObj.recive_point,null,() => {\r\n                    })\r\n                },(error) => {\r\n                    Global.UI.fastTip(error._errstr);\r\n                    // console.log(error);\r\n                },false);\r\n            }\r\n        }\r\n    }\r\n    private closeWnd(){\r\n        // if(this.closeCallback){\r\n        //     this.closeCallback();\r\n        // }\r\n        this.close();\r\n    }\r\n\r\n    protected onClose(){\r\n        HallPopMsgHelper.Instance.releaseLock(ActivityType.dailyPayRedpack);\r\n    }\r\n    onDispose()\r\n    {\r\n        this.selectedNode = [];\r\n        this.noSelectedNode = [];\r\n        this.receivedNode = [];\r\n    }\r\n}"]}