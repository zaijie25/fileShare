{"version":3,"sources":["assets\\hall\\scripts\\logic\\hall\\ui\\hall\\views\\HallBottomView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ViewBase from \"../../../../core/ui/ViewBase\";\r\nimport HallBtnHelper from \"./HallBtnHelper\";\r\nimport HallModel, { HallRedSpotType } from \"../../../../hallcommon/model/HallModel\";\r\nimport AppHelper from \"../../../../core/tool/AppHelper\";\r\nimport PlayerInfoModel from \"../../../../hallcommon/model/PlayerInfoModel\";\r\nimport { NetAppface } from \"../../../../core/net/hall/NetEvent\";\r\nimport { CustomerEntranceType } from \"../../../../hallcommon/model/ServicerModel\";\r\nimport PlayerWallet from \"../../../../core/component/PlayerWallet\";\r\nimport PlayerHeadView from \"./PlayerHeadView\";\r\n/** 大厅底部控件(包括红点控制) */\r\nexport default class HallBottomView extends ViewBase {\r\n    private model: HallModel;\r\n\r\n    // private tixianRedSpot: cc.Node;\r\n    private mailRedSpot: cc.Node;\r\n    private kefuSpot: cc.Node;\r\n \r\n    // private actNode:cc.Node\r\n\r\n    private playerWalllet: PlayerWallet;\r\n\r\n    private playerHead: PlayerHeadView\r\n\r\n    private layoutNode:cc.Node = null;\r\n\r\n    private rechargeNode:cc.Node;\r\n    private comissionNode:cc.Node\r\n    private commisionRedRpot: cc.Node;\r\n    private kefuNode: cc.Node;\r\n    private bottomLayout: cc.Layout;\r\n    private botOrignalWidth:any;\r\n    buzhuNode: cc.Node; //转运金\r\n    private moneyLabel: cc.Label;\r\n    private countLabel: cc.Label;\r\n    \r\n    \r\n\r\n    protected initView() {\r\n        this.model = <HallModel>Global.ModelManager.getModel(\"HallModel\");\r\n\r\n         //头像组件\r\n        this.playerHead = <PlayerHeadView>this.addView(\"PlayerHeadView\", this.getChild(\"PlayerHeadView\"), PlayerHeadView);\r\n\r\n         //钱包组件\r\n        this.playerWalllet = <PlayerWallet>this.addView(\"PlayerWallet\", this.getChild(\"PlayerHeadView/PlayerWallet\"), PlayerWallet);\r\n         // wallet.subViewState = true\r\n        this.playerWalllet.refreshAction();\r\n        this.layoutNode = this.getChild(\"layoutNode\");\r\n      \r\n        this.mailRedSpot = this.getChild(\"layoutNode/mailNode/hongdian\");\r\n        this.kefuSpot = this.getChild(\"layoutNode/kefuNode/hongdian\");\r\n        this.rechargeNode = this.getChild(\"rechargeNode\");\r\n        this.mailRedSpot.active = false;\r\n       \r\n        this.kefuSpot.active = false;\r\n        this.kefuNode = this.addCommonClick(\"layoutNode/kefuNode\", this.onServiceClick, this);\r\n        this.comissionNode = this.addCommonClick(\"layoutNode/caishenNode\", this.onCommisionClick, this);\r\n        this.bottomLayout = this.getChild(\"layoutNode\").getComponent(cc.Layout)\r\n        this.botOrignalWidth = this.bottomLayout.node.width\r\n        this.commisionRedRpot = this.getChild(\"layoutNode/caishenNode/hongdian\")\r\n\r\n        this.addCommonClick(\"layoutNode/yinhang\", this.onBankClick, this);\r\n        if(this.commisionRedRpot)\r\n        {\r\n            this.commisionRedRpot.active = false\r\n        }\r\n        //点击事件注册\r\n        this.addCommonClick(\"layoutNode/rankNode\", this.onRankClick, this);\r\n        \r\n        this.addCommonClick(\"layoutNode/mailNode\", this.onMailClick, this);\r\n       \r\n        this.addCommonClick(\"rechargeNode\", this.onRechargeClick, this);\r\n        //this.addCommonClick(\"lobby_03/PlayerHeadView/head\", this.onHeadClick, this, null);\r\n        // this.actNode = this.addCommonClick(\"layoutNode/activityCenter\", this.openActivityCenter, this)\r\n\r\n\r\n        this.moneyLabel = this.getComponent(\"layoutNode/zhuanyunNode/moneyLabel\", cc.Label);\r\n        this.countLabel = this.getComponent(\"layoutNode/zhuanyunNode/countLabel\", cc.Label);\r\n        this.buzhuNode = this.addCommonClick(\"layoutNode/zhuanyunNode\", this.onBuZhuClick, this);\r\n\r\n\r\n        //调整底部按钮适配\r\n        // --------- start\r\n        let canvas_width = cc.view.getFrameSize().width;\r\n        let canvas_height = cc.view.getFrameSize().height; \r\n        let scale1 = canvas_width/canvas_height;\r\n        let scale2 = 1280/720;\r\n        this.layoutNode.width = this.layoutNode.width * scale1/scale2;\r\n        for(let i = 0 ;i < this.layoutNode.childrenCount ; i++){\r\n            this.layoutNode.children[i].x = (this.layoutNode.width/(this.layoutNode.childrenCount))*i + (this.layoutNode.children[i].width/2);\r\n        }\r\n        // --------- end\r\n        // this.actNode.active = false\r\n\r\n        this.registEvent()\r\n    }\r\n\r\n\r\n\r\n \r\n\r\n    CheckKefu()\r\n    {\r\n        let data = null\r\n        let model = Global.ModelManager.getModel(\"ServicerModel\")\r\n        if(model)\r\n        {\r\n            data = model.getServiceInfo(CustomerEntranceType.HallService)\r\n        }\r\n        if(!data || !data.status)\r\n        {\r\n            this.kefuNode.active = false\r\n        }\r\n    }\r\n\r\n    private registEvent() {\r\n     \r\n        Global.Event.on(GlobalEvent.PERSONALINFOUPDATE, this, this.checkCommisionRedSpot);\r\n    }\r\n\r\n\r\n    private onBuZhuClick() {\r\n        let param: any = {}\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.GetSubsidyPoint, param, (retObj) => {\r\n            PlayerInfoModel.instance.vipSubsidyCount = retObj.times\r\n            this.countLabel.string = PlayerInfoModel.instance.vipSubsidyCount + \"\";\r\n            Global.UI.show(\"WndRebateGet\", retObj.point);\r\n        }, (error) => {\r\n            Global.UI.fastTip(error._errstr);\r\n            // console.log(error);\r\n        }, false, 10);\r\n    }\r\n\r\n    \r\n    openActivityCenter() {\r\n        HallBtnHelper.WndActivityOpen()\r\n    }\r\n\r\n\r\n    private onHeadClick() {\r\n        HallBtnHelper.WndPersonalInfoOpen();\r\n    }\r\n\r\n    private onCommisionClick() {\r\n        this.model.closeRedSpot(HallRedSpotType.Commision);\r\n        HallBtnHelper.WndCommision();\r\n    }\r\n\r\n\r\n    onSubViewShow() {\r\n      \r\n        this.model.on(\"UpdateResSpot\", this, this.updateResSpot);\r\n        this.playerWalllet.subViewState = true\r\n        this.playerHead.subViewState = true\r\n       \r\n        //this.CheckKefu()\r\n        this.checkCommisionRedSpot()\r\n        var CommisionModel = Global.ModelManager.getModel(\"CommisionModel\");\r\n        let RedFlag = CommisionModel.redSwitch\r\n        if (RedFlag) {\r\n            this.commisionRedRpot.active = true\r\n        }\r\n    }\r\n\r\n\r\n    onSubViewHide() {\r\n        Global.Event.off(GlobalEvent.SHOW_SPREAD_NODE, this, this.showSpreadNode);\r\n        this.model.off(\"UpdateResSpot\", this, this.updateResSpot);\r\n    }\r\n\r\n    onDispose() {\r\n        Global.Event.off(GlobalEvent.PERSONALINFOUPDATE, this, this.checkCommisionRedSpot);\r\n    }\r\n\r\n    /***************************************************** 点击事件区域 **************************************/\r\n    private updateResSpot(redSpotType) {\r\n        switch (redSpotType) {\r\n            case HallRedSpotType.Mail:\r\n                {\r\n                    this.mailRedSpot.active = this.model.mailRedSpotSwitch;\r\n                    break;\r\n                }\r\n            case HallRedSpotType.Gonggao:\r\n                {\r\n                    this.mailRedSpot.active = this.model.mailRedSpotSwitch;\r\n                    break;\r\n                }\r\n            case HallRedSpotType.Kefu:\r\n                {\r\n                    this.kefuSpot.active = this.model.kefuSpotSwitch;\r\n                    break;\r\n                }\r\n            case HallRedSpotType.Spread:\r\n                {\r\n                    this.spreadRedSpot.active = this.model.SpreadRedSpot;\r\n                    break;\r\n                }\r\n            case HallRedSpotType.Commision:\r\n                {\r\n                    this.commisionRedRpot.active = this.model.CommisionRedSpotActive;\r\n                    break;\r\n                }\r\n        }\r\n    }\r\n\r\n\r\n    checkCommisionRedSpot() {\r\n\r\n        this.buzhuNode.active = PlayerInfoModel.instance.vipSubsidyStatus !== 0\r\n\r\n        if (PlayerInfoModel.instance.vipSubsidy != null) {\r\n            // let subsidy = PlayerInfoModel.instance.vipSubsidy[Global.PlayerData.vip]\r\n            let subsidy = PlayerInfoModel.instance.vipSubsidy[Global.PlayerData.vip]\r\n            if (subsidy) {\r\n                this.moneyLabel.string = Global.Toolkit.formatPointStr(subsidy.point, true).toString();\r\n            }\r\n            else {\r\n                this.moneyLabel.string = \"0\"\r\n            }\r\n        }\r\n        this.countLabel.string = PlayerInfoModel.instance.vipSubsidyCount + \"\";\r\n        //刷新剩余次数\r\n        let param: any = {}\r\n        Global.HallServer.send(NetAppface.mod, NetAppface.SubsidyPoint, param, (retObj) => {\r\n            PlayerInfoModel.instance.vipSubsidyCount = retObj.times\r\n            this.countLabel.string = PlayerInfoModel.instance.vipSubsidyCount + \"\";\r\n        }, (error) => {\r\n            // Global.UI.fastTip(error._errstr);\r\n            // console.log(error);\r\n        }, false, 10);\r\n    }\r\n\r\n\r\n    private onRankClick() {\r\n        this.model.closeRedSpot(HallRedSpotType.Rank);\r\n        HallBtnHelper.WndRankOpen();\r\n    }\r\n\r\n    private onBankClick() {\r\n        HallBtnHelper.WndBankOpen();\r\n        Global.Audio.playAudioSource(\"hall/sound/bank\")\r\n    }\r\n\r\n    private onMailClick() {\r\n        this.model.closeRedSpot(HallRedSpotType.Mail);\r\n        HallBtnHelper.WndMailOpen();\r\n    }\r\n\r\n    private onServiceClick() {\r\n        this.model.closeRedSpot(HallRedSpotType.Kefu);\r\n        Global.Audio.playAudioSource(\"hall/sound/Customer_service\")\r\n        HallBtnHelper.WndServiceOpen();\r\n    }\r\n    private onRechargeClick() {\r\n        Global.Component.scheduleOnce(()=>{\r\n            HallBtnHelper.WndRechargeOpen();\r\n            Global.Audio.playAudioSource(\"hall/sound/recharge\")\r\n         },0);\r\n    }\r\n}"]}