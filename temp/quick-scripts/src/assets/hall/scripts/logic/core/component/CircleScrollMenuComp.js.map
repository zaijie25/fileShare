{"version":3,"sources":["assets\\hall\\scripts\\logic\\core\\component\\CircleScrollMenuComp.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class CircleScrollMenuComp extends cc.Component {\r\n    @property({\r\n        tooltip: \"显示可见的最大item数量, 并且预设上要多两个节点用于动画\"\r\n    })\r\n    public showCount: number = 0;\r\n\r\n    private readonly moveTime = 0.2;        // 滚动时长\r\n    private readonly slideDev = 5;          // 手势判定有效位移\r\n\r\n    private dotNode: cc.Node;\r\n    private itemList: MenuItem[] = [];\r\n    private itemRawPosArr: cc.Vec3[] = [];\r\n    private isRolling: boolean = false;\r\n    private touchStartPos: cc.Vec2;\r\n    private menuSelectCallback: Function;\r\n    private menuSelectTarget: any;\r\n\r\n    private dataList: any[] = [];\r\n    /** 显示的item序号 上第一个item基准 */\r\n    private showIndex: number = 0;\r\n    /** 实际显示的数据序号 上第一个item基准 */\r\n    private realIndex: number = 0;\r\n    /** 中心指向的本地item序号 1~showCount+2 */\r\n    private curSelectIndex: number = 0;\r\n    /** 是否可滚动 */\r\n    private isRollEnable: boolean = false;\r\n    \r\n\r\n    private get totalCount(){\r\n        return this.showCount + 2;\r\n    }\r\n\r\n    private get centerCount(){\r\n        return Math.floor(this.showCount / 2);\r\n    }\r\n\r\n    protected onLoad(){\r\n        let contentNode = cc.find(\"mask/touch\", this.node);\r\n        contentNode.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this); \r\n        contentNode.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        contentNode._touchListener.setSwallowTouches(false)\r\n\r\n        this.dotNode = cc.find(\"mask/circleDot\", this.node);\r\n        for(let i = 0; i < this.totalCount; i++){        // 额外多出两个用于辅助滚动动画\r\n            let node = cc.find(\"item\" + i, this.dotNode);\r\n            if (node){\r\n                let item: MenuItem = Global.UIHelper.safeGetComponent(node, \"\", MenuItem);\r\n                item.index = i;\r\n                item.setCallback(this.onMenuItemClick, this);\r\n                item.node.active = false;\r\n                item.setCheck(false);\r\n                this.itemList.push(item);\r\n                this.itemRawPosArr.push(node.position);\r\n            }\r\n        }\r\n        if (this.itemList.length != this.totalCount){\r\n          //  console.error(\"节点数量异常\", this.itemList.length, this.totalCount);\r\n        }\r\n    }\r\n\r\n    private onTouchStart(event: cc.Event.EventTouch){\r\n        this.touchStartPos = event.getLocation();\r\n    }\r\n\r\n    private onTouchEnd(event: cc.Event.EventTouch){\r\n        if (!this.isRollEnable)     // 数量太少\r\n            return;\r\n        if (this.isRolling)\r\n            return;\r\n        let endPos = event.getLocation();\r\n        let se = endPos.sub(this.touchStartPos);\r\n        let dev = se.mag();\r\n        let comDev = Math.pow(this.slideDev, 2);\r\n        if (se.y > 0){      // 向上滑   先判断y方向偏移量, 处理横向滑动的问题 暂未扩展到横向滑动\r\n            if (dev >= comDev){\r\n                // event.stopPropagation();\r\n                this.rollForward(this.moveTime, 1, true, ()=>{\r\n                    this.itemList[this.curSelectIndex].setCheck(false);\r\n                    this.curSelectIndex = this.getNextIndex(this.showIndex, this.centerCount);\r\n                    this.onMenuSelect(this.curSelectIndex);\r\n                });\r\n            }\r\n        }\r\n        else{               // 向下滑\r\n            if (dev >= comDev){\r\n                // event.stopPropagation();\r\n                this.rollBack(this.moveTime, 1, true, ()=>{\r\n                    this.itemList[this.curSelectIndex].setCheck(false);\r\n                    this.curSelectIndex = this.getNextIndex(this.showIndex, this.centerCount);\r\n                    this.onMenuSelect(this.curSelectIndex);\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private onMenuItemClick(index: number){\r\n        if (this.isRolling)\r\n            return;\r\n        if (this.isRollEnable){\r\n            this.autoRollToItem(index, ()=>{\r\n                this.itemList[this.curSelectIndex].setCheck(false);\r\n                this.curSelectIndex = this.getNextIndex(this.showIndex, this.centerCount);\r\n                this.onMenuSelect(this.curSelectIndex);\r\n            })\r\n        }\r\n        else{\r\n            this.switchItemWithoutRoll(index);\r\n        }\r\n    }\r\n\r\n    private onMenuSelect(index: number){\r\n        let curItem = this.itemList[index];\r\n        if (curItem){\r\n            curItem.setCheck(true);\r\n            if (this.menuSelectTarget && this.menuSelectCallback){\r\n                this.menuSelectCallback.call(this.menuSelectTarget, curItem.key);\r\n            }\r\n        }\r\n        else{\r\n           // console.error(\"item not exist\", index, this.itemList.length);\r\n        }\r\n    }\r\n\r\n    public setMenuItemCallback(callback: Function, target: any){\r\n        this.menuSelectCallback = callback;\r\n        this.menuSelectTarget = target;\r\n    }\r\n\r\n    public initData(list: any[] = []){\r\n        if (list.length <= 0){\r\n            this.node.active = false;\r\n            return Global.UI.fastTip(\"菜单项列表为空: \" + list.length);\r\n        }\r\n        this.dataList = list || [];\r\n        // 数据数量小于showCount 设置标志不可滚动, 直接刷新\r\n        this.isRollEnable = list.length >= this.showCount;\r\n\r\n        for(let i = 0; i < this.itemList.length; i++){\r\n            let item = this.itemList[i];\r\n            if (list[i]){\r\n                item.node.active = true;\r\n                item.setData(list[i]);\r\n            }\r\n            else{\r\n                item.node.active = this.isRollEnable;       // 可转动时显示辅助item\r\n            }\r\n        }\r\n    }\r\n\r\n    public setDefaultSelect(rIndex?: number){\r\n        if (rIndex >= 0)\r\n            this.realIndex = this.getPrevRealIndex(rIndex, this.centerCount);\r\n        else\r\n            this.realIndex = 0;\r\n        for(let i = 0; i < this.showCount; i++){\r\n            let next = this.getNextIndex(this.showIndex, i);\r\n            let item = this.itemList[next];\r\n            let tempRealIndex = this.getNextRealIndex(this.realIndex, i);\r\n            item.setData(this.dataList[tempRealIndex]);\r\n        }\r\n        let nSelectIndex = this.getNextIndex(this.showIndex, this.centerCount);\r\n        this.onMenuSelect(nSelectIndex);\r\n        this.curSelectIndex = nSelectIndex;\r\n    }\r\n\r\n    private autoRollToItem(index: number, finishCal: Function){\r\n        let pos = index - this.curSelectIndex;\r\n        let dev = Math.abs(pos);\r\n        if (dev > this.centerCount){    // 超过显示的一半 就反向\r\n            if (pos > 0)\r\n                pos -= this.totalCount;\r\n            else\r\n                pos += this.totalCount;\r\n            dev = Math.abs(pos);\r\n        }\r\n        if (dev != 0){\r\n            this.isRolling = true;\r\n            if (pos > 0){\r\n                this.rollForward(this.moveTime, dev, true, finishCal);\r\n            }\r\n            else{\r\n                this.rollBack(this.moveTime, dev, true, finishCal);\r\n            }\r\n        }\r\n    }\r\n\r\n    private switchItemWithoutRoll(index: number){\r\n        let pos = index - this.curSelectIndex;\r\n        let dev = Math.abs(pos);\r\n        if (dev != 0){\r\n            let dataCount = this.dataList.length;\r\n            let realIndex = this.realIndex;\r\n            for(let i = 0; i < this.itemList.length; i++){       // 不旋转 第一个item索引一直都是0 切换数据\r\n                let item = this.itemList[i];\r\n                let rIndex = 0;\r\n                let tempIndex = this.getNextRealIndex(this.realIndex, i);       // 先计算每个item的当前realIndex, 再前移或后移\r\n                if (pos > 0){\r\n                    rIndex = this.getNextRealIndex(tempIndex, dev);\r\n                }\r\n                else{\r\n                    rIndex = this.getPrevRealIndex(tempIndex, dev);\r\n                }\r\n                if (this.dataList[rIndex]){\r\n                    item.setData(this.dataList[rIndex]);\r\n                    if (i == 0)\r\n                        realIndex = rIndex;\r\n                }\r\n                if (i >= dataCount - 1)\r\n                    break;\r\n            }\r\n            this.realIndex = realIndex;\r\n            this.onMenuSelect(this.curSelectIndex);\r\n        }\r\n    }\r\n\r\n    /** 转盘向下转 */\r\n    private rollBack(time: number, step: number = 1, isAnim: boolean = true, callback?: Function){\r\n        Logger.error(\"rollBack 向下转\");\r\n        this.setHideItemDataBack();      // 设置首尾显示的内容更新\r\n        let frameInSecond = cc.game.getFrameRate();\r\n        let everyFrame = Math.floor(frameInSecond * time / step);\r\n        for(let i =0; i < this.itemList.length; i++){\r\n            let item = this.itemList[i];\r\n            let next = this.getNextIndex(i + this.totalCount - this.showIndex, step);\r\n            // Logger.error(\"rollBack\", this.showIndex, i, next);\r\n            if (isAnim){\r\n                let arr = [];\r\n                let start = cc.v2(item.node.position);\r\n                for(let s = 1; s <= step; s ++){\r\n                    let nextStep = this.getNextIndex(i + this.totalCount - this.showIndex, s);\r\n                    let end = cc.v2(this.itemRawPosArr[nextStep]);\r\n                    let temp = this.getLerpPosArr(start, end, everyFrame);\r\n                    start = end;\r\n                    arr = arr.concat(temp);\r\n                }\r\n                item.startRun(arr);\r\n            }\r\n            else{\r\n                item.node.setPosition(this.itemRawPosArr[next]);\r\n            }\r\n        }\r\n        \r\n        if (isAnim){\r\n            this.isRolling = true;\r\n            this.scheduleOnce(() => {\r\n                if (!cc.isValid(this.node))\r\n                    return\r\n                this.isRolling = false;\r\n                this.realIndex = this.getPrevRealIndex(this.realIndex, step);\r\n                this.showIndex = this.getPrevIndex(this.showIndex, step);\r\n                callback && callback();\r\n            }, time + 0.05);\r\n        }\r\n        else{\r\n            this.realIndex = this.getPrevRealIndex(this.realIndex, step);\r\n            this.showIndex = this.getPrevIndex(this.showIndex, step);\r\n            callback && callback();\r\n        }\r\n    }\r\n\r\n    /** 转盘向上转 */\r\n    private rollForward(time: number, step: number = 1, isAnim: boolean = true, callback?: Function){\r\n        Logger.error(\"rollForward 向上转\");\r\n        this.setHideItemDataForward();     // 设置首尾显示的内容更新\r\n        let frameInSecond = cc.game.getFrameRate();\r\n        let everyFrame = Math.floor(frameInSecond * time / step);\r\n        for(let i =0; i < this.itemList.length; i++){\r\n            let item = this.itemList[i];\r\n            let prev = this.getPrevIndex(i  + this.totalCount - this.showIndex, step);\r\n            // Logger.error(\"rollForward\", this.showIndex, i, prev);\r\n            if (isAnim){\r\n                let arr = [];\r\n                let start = cc.v2(item.node.position);\r\n                for(let s = 1; s <= step; s ++){\r\n                    let nextStep = this.getPrevIndex(i + this.totalCount - this.showIndex, s);\r\n                    let end = cc.v2(this.itemRawPosArr[nextStep]);\r\n                    let temp = this.getLerpPosArr(start, end, everyFrame);\r\n                    start = end;\r\n                    arr = arr.concat(temp);\r\n                }\r\n                item.startRun(arr);\r\n            }\r\n            else{\r\n                item.node.setPosition(this.itemRawPosArr[prev]);\r\n            }\r\n        }\r\n        \r\n        if (isAnim){\r\n            this.isRolling = true;\r\n            this.scheduleOnce(() => {\r\n                if (!cc.isValid(this.node))\r\n                    return\r\n                this.isRolling = false;\r\n                this.realIndex = this.getNextRealIndex(this.realIndex, step);\r\n                this.showIndex = this.getNextIndex(this.showIndex, step);\r\n                callback && callback();\r\n            }, time + 0.05);\r\n        }\r\n        else{\r\n            this.realIndex = this.getNextRealIndex(this.realIndex, step);\r\n            this.showIndex = this.getNextIndex(this.showIndex, step);\r\n            callback && callback();\r\n        }\r\n    }\r\n\r\n    private setHideItemDataForward(){\r\n        let step = this.showCount;\r\n        let last2nd = this.getNextIndex(this.showIndex, step);\r\n        let last = this.getNextIndex(this.showIndex, step + 1);\r\n\r\n        let last2ndRealIndex = this.getNextRealIndex(this.realIndex, step);\r\n        let lastRealIndex = this.getNextRealIndex(this.realIndex, step + 1);\r\n        this.itemList[last2nd].setData(this.dataList[last2ndRealIndex]);\r\n        this.itemList[last].setData(this.dataList[lastRealIndex]);\r\n    }\r\n\r\n    private setHideItemDataBack(){\r\n        let step = this.showCount;\r\n        let last2nd = this.getNextIndex(this.showIndex, step);\r\n        let last = this.getNextIndex(this.showIndex, step + 1);\r\n\r\n        let last2ndRealIndex = this.getPrevRealIndex(this.realIndex, 2);\r\n        let lastRealIndex = this.getPrevRealIndex(this.realIndex, 1);\r\n        this.itemList[last2nd].setData(this.dataList[last2ndRealIndex]);\r\n        this.itemList[last].setData(this.dataList[lastRealIndex]);\r\n    }\r\n    \r\n    private getLerpPosArr(start: cc.Vec2, end: cc.Vec2, totalFrame: number){\r\n        let arr = [];\r\n        for(let i = 1; i <= totalFrame; i++){\r\n            arr.push(start.lerp(end, i / totalFrame));\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    private getNextIndex(value: number, step: number = 1){\r\n        return (value + step) % this.totalCount;\r\n    }\r\n\r\n    private getPrevIndex(value: number, step: number = 1){\r\n        return (value - step + this.totalCount) % this.totalCount;\r\n    }\r\n\r\n    private getNextRealIndex(value: number, step: number = 1){\r\n        return (value + step) % this.dataList.length;\r\n    }\r\n\r\n    private getPrevRealIndex(value: number, step: number = 1){\r\n        return (value - step + this.dataList.length) % this.dataList.length;\r\n    }\r\n\r\n    protected onDisable(){\r\n        this.unscheduleAllCallbacks();\r\n    }\r\n}\r\n\r\nclass MenuItem extends cc.Component{\r\n    private uncheckNode: cc.Node;\r\n    private checkNode: cc.Node;\r\n    private uncheckIconSp: cc.Sprite;\r\n    private checkIconSp: cc.Sprite;\r\n    private uncheckTextSp: cc.Sprite;\r\n    private checkTextSp: cc.Sprite;\r\n    private callback: Function;\r\n    private target: any;\r\n    private _key: number = 0;\r\n    private _index: number = 0;\r\n    public get key(){\r\n        return this._key;\r\n    }\r\n\r\n    private runEnable: boolean = false;\r\n    private runPosArr: cc.Vec3[] = [];\r\n    private frameCount: number = 0;\r\n\r\n    protected onLoad(){\r\n        this.uncheckNode = cc.find(\"uncheckNode\", this.node);\r\n        this.uncheckIconSp = cc.find(\"iconSp\", this.uncheckNode).getComponent(cc.Sprite);\r\n        this.uncheckTextSp = cc.find(\"textSp\", this.uncheckNode).getComponent(cc.Sprite);\r\n        this.checkNode = cc.find(\"checkNode\", this.node);\r\n        this.checkIconSp = cc.find(\"iconSp\", this.checkNode).getComponent(cc.Sprite);\r\n        this.checkTextSp = cc.find(\"textSp\", this.checkNode).getComponent(cc.Sprite);\r\n\r\n        Global.UIHelper.addCommonClick(this.node, \"\", this.onItemClick, this);\r\n    }\r\n\r\n    public setData(data: any){\r\n        this._key = data.key;\r\n        Global.ResourceManager.loadBundleAutoAtlas(\"resources\", this.uncheckIconSp, \"hall/images/circle/atlas_circle\", data.icon);\r\n        Global.ResourceManager.loadBundleAutoAtlas(\"resources\", this.uncheckTextSp, \"hall/images/circle/atlas_circle\", data.ucText);\r\n        Global.ResourceManager.loadBundleAutoAtlas(\"resources\", this.checkIconSp, \"hall/images/circle/atlas_circle\", data.icon);\r\n        Global.ResourceManager.loadBundleAutoAtlas(\"resources\", this.checkTextSp, \"hall/images/circle/atlas_circle\", data.cText);\r\n        if (!data.cText){\r\n            this.checkTextSp.node.active = false;\r\n        }\r\n        if (!data.ucText){\r\n            this.uncheckTextSp.node.active = false;\r\n        }\r\n    }\r\n\r\n    public set index(value: number){\r\n        this._index = value;\r\n    }\r\n\r\n    public get index(){\r\n        return this._index;\r\n    }\r\n\r\n    public setCallback(func: Function, target: any){\r\n        this.callback = func;\r\n        this.target = target;\r\n    }\r\n\r\n    private onItemClick(){\r\n        if (this.callback && this.target){\r\n            this.callback.call(this.target, this.index, this.key);\r\n        }\r\n    }\r\n\r\n    public setCheck(flag: boolean){\r\n        this.uncheckNode.active = !flag;\r\n        this.checkNode.active = flag;\r\n    }\r\n\r\n    public startRun(arr: cc.Vec3[]){\r\n        if (arr && arr.length > 0){\r\n            this.frameCount = 0;\r\n            this.runPosArr = arr;\r\n            this.runEnable = true;\r\n        }\r\n    }\r\n\r\n    protected update(){\r\n        if (!this.runEnable || this.runPosArr.length <= 0)\r\n            return;\r\n        let pos = this.runPosArr[this.frameCount];\r\n        if (pos){\r\n            this.node.setPosition(pos);\r\n            this.frameCount += 1;\r\n            if (this.frameCount == this.runPosArr.length){\r\n                this.runEnable = false;\r\n                this.runPosArr = [];\r\n            }\r\n        }\r\n    }\r\n}"]}