{"version":3,"sources":["assets\\hall\\scripts\\logic\\core\\tool\\HeadTipsManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import InteractHeadTipComp from \"../component/InteractHeadTipComp\";\r\nimport InteractPlayComp from \"../component/InteractPlayComp\";\r\n\r\nconst baseBundle = \"resources\";\r\nconst headTipPath = \"hall/prefabs/ui/interact/headTip\";\r\nconst interactPlayPath = \"hall/prefabs/ui/interact/interactPlayView\";\r\nexport default class HeadTipsManager {\r\n    private headTipsComp: InteractHeadTipComp;\r\n    private interactPlayComp: InteractPlayComp;\r\n\r\n    // 版本迭代暂用, 后续删除\r\n    public async preloadRes(){\r\n        return new Promise((resolve, reject)=>{\r\n            Global.ResourceManager.loadBundleRes(baseBundle, [headTipPath, interactPlayPath], (err, res)=>{\r\n                if (err){\r\n                    reject(err);\r\n                }\r\n                else{\r\n                    resolve(res);\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    public static async preloadRes(){\r\n        return new Promise((resolve, reject)=>{\r\n            Global.ResourceManager.loadBundleRes(baseBundle, [headTipPath, interactPlayPath], (err, res)=>{\r\n                if (err){\r\n                    reject(err);\r\n                }\r\n                else{\r\n                    resolve(res);\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    public init(headTipsRoot: cc.Node, playRoot: cc.Node, isNeedHeadInfo: boolean){\r\n        let node0 = <cc.Node>cc.instantiate(Global.ResourceManager.getBundleRes(baseBundle, headTipPath));\r\n        let node1 = <cc.Node>cc.instantiate(Global.ResourceManager.getBundleRes(baseBundle, interactPlayPath));\r\n        // 挂到场景上初始化后再挂到游戏UI下\r\n        node0.setParent(cc.Canvas.instance.node);\r\n        node1.setParent(cc.Canvas.instance.node);\r\n        this.headTipsComp = Global.UIHelper.safeGetComponent(node0, \"\", InteractHeadTipComp);\r\n        this.interactPlayComp = Global.UIHelper.safeGetComponent(node1, \"\", InteractPlayComp);\r\n\r\n        this.headTipsComp.node.setParent(headTipsRoot);\r\n        this.interactPlayComp.node.setParent(playRoot);\r\n\r\n        this.headTipsComp.node.active = false;      // 默认隐藏\r\n        this.interactPlayComp.node.active = true;   // 不隐藏\r\n        \r\n        this.headTipsComp.needHeadTip = isNeedHeadInfo;\r\n    }\r\n\r\n    public setConfig(sChair: number){\r\n        this.headTipsComp.interactChooseView.setSelfSrc(sChair);\r\n    }\r\n\r\n    /**\r\n     * 显示头像信息\r\n     * @param isShow 是否显示\r\n     * @param localSeat 显示者本地座位\r\n     * @param data \r\n     */\r\n    public showHeadView(isShow: boolean, localSeat: number, worldPos: cc.Vec3, data: any){\r\n        let wPos = worldPos || cc.Vec3.ZERO;\r\n        this.headTipsComp.showHeadView(isShow, localSeat, wPos, data);\r\n    }\r\n\r\n    /** 打开时更新玩家信息的金币变换 */\r\n    public updatePoint(localSeat: number, point: any) {\r\n        this.headTipsComp.updatePoint(localSeat, point);\r\n    }\r\n\r\n    /**\r\n     * 播放表情\r\n     * @param key 表情key\r\n     * @param fWPos 世界起点\r\n     * @param tWPos 世界终点\r\n     * @param localSeat 表情归属的本地座位\r\n     */\r\n    public playAct(key: string, fWPos: cc.Vec3, tWPos: cc.Vec3, localSeat: number){\r\n        this.interactPlayComp.node.active = true;\r\n        this.interactPlayComp.playAct(key, fWPos, tWPos, localSeat);\r\n    }\r\n\r\n    /** 玩家leave时调用清理正在飞的表情 */\r\n    public clearOneOwner(owner: string){\r\n        this.interactPlayComp.clearOneOwner(owner);\r\n    }\r\n\r\n    /** 退出时调用 */\r\n    public clearByGame(){\r\n        if (this.headTipsComp && cc.isValid(this.headTipsComp)){\r\n            this.headTipsComp.node.active = false;\r\n        }\r\n        if(this.interactPlayComp && cc.isValid(this.interactPlayComp)){\r\n            this.interactPlayComp.node.active = false;\r\n            this.interactPlayComp.clearAllOwner();\r\n        }\r\n    }\r\n}"]}