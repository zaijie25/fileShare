{"version":3,"sources":["assets\\hall\\scripts\\logic\\core\\tool\\AESUtil.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Hasher } from \"../../../framework/libs/cryptoTs/lib/Hasher\";\r\nimport { MD5 } from \"../../../framework/libs/cryptoTs/algo/MD5\";\r\nimport * as Crypto from \"../../../framework/libs/cryptoTs/crypto-ts\"\r\n/**\r\n * 加解密,MD5操作\r\n * @author Peter\r\n * \r\n*/\r\nexport class AESUtil {\r\n    public cryptoKey: string = \"yaoxing8901234561234567890123488\";\r\n    public cryptoIv: string = \"yaoxing890123488\";\r\n\r\n    public routeCrypKey: string = \"kjhlouyuf20987677869887978987277\";\r\n    public routeCrypIv: string = \"kjhlouyuf2098767\";\r\n\r\n    /** 密码检测字符串*/\r\n    private _pwCheckString: string = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\r\n    private MD5Hasher;\r\n\r\n    public md5(content) {\r\n        if (this.MD5Hasher == null) {\r\n            this.MD5Hasher = Hasher._createHelper(MD5);\r\n        }\r\n        return this.MD5Hasher(content).toString();\r\n    }\r\n\r\n    //加密客户端发送的内容\r\n    public aesEncrptMsg(msg) {\r\n        let encryptMsg = this.aesEncrypt(this.routeCrypKey, this.routeCrypIv, msg)\r\n        // Logger.error(\"encryptMsg \" + encryptMsg)\r\n        return \"s:\" + encryptMsg\r\n    }\r\n\r\n    public decodeMsg(msg) {\r\n        let tmp = msg.trim();\r\n        if (!tmp) {\r\n            return \"\"\r\n        }\r\n        if (tmp.charAt(0) == \"{\")\r\n            return msg;\r\n        //有出现server 底层被拦截直接返回客户端一个html 页面，导致底层解密失败报错\r\n        if (tmp.indexOf(\"<html\") > 0 || tmp.indexOf(\" \") > 0 || tmp.indexOf(\"\\t\") > 0 || tmp.indexOf(\">\") > 0) {\r\n            return \"\";\r\n        }\r\n        let result = Global.NativeEvent.decryptData(msg);\r\n        if (result == null || result.result < 0)\r\n            return this.decodeInternal(msg)\r\n        else {\r\n            return result.funcParam;\r\n        }\r\n    }\r\n\r\n    private decodeInternal(msg) {\r\n        return this.aesDecrypt(msg);\r\n    }\r\n\r\n    public aesEncryptWithCommonKey(msg) {\r\n        let encryptMsg = this.aesEncrypt(this.cryptoKey, this.cryptoIv, msg)\r\n        return encryptMsg;\r\n    }\r\n\r\n    public aesEncrypt(cryptoKey, cryptoIv, msg) {\r\n        let key = Crypto.enc.Utf8.parse(cryptoKey);\r\n        let iv = Crypto.enc.Utf8.parse(cryptoIv);\r\n        let encrypt = Crypto.AES.encrypt(msg, key, {\r\n            iv: iv,\r\n            mode: Crypto.mode.CBC,\r\n            padding: Crypto.pad.PKCS7\r\n        });\r\n        return encrypt.toString();\r\n    }\r\n\r\n    public aesDcryptWithPKC27(msg) {\r\n        let key = Crypto.enc.Utf8.parse(this.cryptoKey);\r\n        let iv = Crypto.enc.Utf8.parse(this.cryptoIv);\r\n        let decrypted = Crypto.AES.decrypt(msg, key, {\r\n            iv: iv,\r\n            mode: Crypto.mode.CBC,\r\n            padding: Crypto.pad.PKCS7\r\n        });\r\n        return decrypted.toString(Crypto.enc.Utf8);\r\n    }\r\n\r\n    public aesDecrypt(msg) {\r\n        let key = Crypto.enc.Utf8.parse(this.cryptoKey);\r\n        let iv = Crypto.enc.Utf8.parse(this.cryptoIv);\r\n        let decrypted = Crypto.AES.decrypt(msg, key, {\r\n            iv: iv,\r\n            mode: Crypto.mode.CBC,\r\n            padding: Crypto.pad.NoPadding\r\n        });\r\n        return decrypted.toString(Crypto.enc.Utf8);\r\n    }\r\n\r\n    //加密客户端发送的内容\r\n    public aesEncrptSendMsg(msg) {\r\n        let encryptMsg = this.aesEncrypt(this.routeCrypKey, this.routeCrypIv, msg)\r\n        // Logger.error(\"encryptMsg \" + encryptMsg)\r\n        return \"s:\" + encryptMsg\r\n    }\r\n\r\n    //解密host\r\n    public aesDecrptHost(host) {\r\n        let key = Crypto.enc.Utf8.parse(this.routeCrypKey);\r\n        let iv = Crypto.enc.Utf8.parse(this.routeCrypIv);\r\n        let decrypted = Crypto.AES.decrypt(host, key, {\r\n            iv: iv,\r\n            mode: Crypto.mode.CBC,\r\n            padding: Crypto.pad.NoPadding\r\n        });\r\n        let decryptedStr = decrypted.toString(Crypto.enc.Utf8);\r\n        //有控制字符，替换为空\r\n        decryptedStr = Global.Toolkit.strReplaceCtrChar(decryptedStr)\r\n        return decryptedStr\r\n    }\r\n}\r\n"]}