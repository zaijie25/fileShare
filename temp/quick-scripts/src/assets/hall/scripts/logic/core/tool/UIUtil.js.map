{"version":3,"sources":["assets\\hall\\scripts\\logic\\core\\tool\\UIUtil.ts"],"names":[],"mappings":";;;;;AAAA;;;GAGG;;AAEH,yCAA6D;AAE7D;IAAA;IAgPA,CAAC;IA9OG;;;;;MAKE;IACK,8BAAa,GAApB,UAAqB,WAAsB,EAAE,MAAW,EAAE,UAA2B;QAAxC,uBAAA,EAAA,WAAW;QAAE,2BAAA,EAAA,kBAA2B;QACjF,IAAI,WAAW,IAAI,IAAI;YACnB,OAAO;QACX,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ;YAChB,OAAO;QACX,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS;YACpC,OAAO;QACX,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,IAAI,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;YAC1B,IAAI,IAAI,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO;gBAC7B,SAAS;YACb,IAAI,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;YAC1C,IAAI,MAAM,EAAE;gBACR,IAAI,UAAU;oBACV,MAAM,CAAC,GAAG,IAAI,MAAM,CAAC;;oBAErB,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC;aAC7B;SACJ;IACL,CAAC;IAED;;;;MAIE;IACK,8BAAa,GAApB,UAAqB,KAAc,EAAE,MAAe,EAAE,OAAuB;QAAvB,wBAAA,EAAA,cAAuB;QACzE,IAAI,KAAK,IAAI,MAAM,IAAI,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;YAC5D,IAAI,OAAO,EAAE;gBACT,IAAI,GAAG,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,MAAM,EAAE,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;gBACxE,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;gBACxB,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;aAC1B;iBACI;gBACD,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;aAC3B;SACJ;aACI;YACD,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;SAC1B;IACL,CAAC;IAEA;;;;;MAKE;IACI,mCAAkB,GAAzB,UAA0B,KAAc,EAAE,KAAc,EAAE,KAAoB;QAApB,sBAAA,EAAA,QAAQ,EAAE,CAAC,IAAI,CAAC,IAAI;QAC1E,IAAI,QAAQ,GAAG,KAAK,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;QAClD,OAAO,KAAK,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC;IAChD,CAAC;IAEM,2BAAU,GAAjB,UAAkB,IAAa,EAAE,GAAW;QACxC,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,EAAE,UAAC,KAAK,EAAE,OAAO;YAC5C,IAAI,KAAK,EAAE;gBACP,MAAM,CAAC,KAAK,CAAC,qCAAqC,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;gBAChE,OAAO;aACV;YACD,IAAI,EAAE,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;YACtC,IAAI,CAAC,EAAE,EAAE;gBACL,OAAO,MAAM,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;aACtD;YACD,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC;YAC3B,IAAI,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC;YAC7B,EAAE,CAAC,WAAW,GAAG,IAAI,EAAE,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;YAC7C,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;YACvB,IAAI,CAAC,MAAM,GAAG,UAAU,CAAC;QAC7B,CAAC,CAAC,CAAA;IACN,CAAC;IAEM,+BAAc,GAArB,UAAsB,MAAc,EAAE,MAAkB,EAAE,KAAc,EAAE,MAAe;QACrF,kFAAkF;QAClF,IAAI,MAAM,IAAI,IAAI,IAAI,MAAM,IAAI,SAAS,IAAI,MAAM,IAAI,EAAE,EAAE;YACvD,MAAM,CAAC,KAAK,CAAC,6CAA6C,CAAC,CAAC;YAC5D,OAAO,IAAI,CAAC;SACf;QAED,IAAI,MAAM,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa,EAAE;YACjE,IAAI,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa,CAAA,CAAC,uCAAuC;YAC9F,IAAI,EAAE,IAAI,CAAC,EAAE;gBACT,EAAE,GAAG,CAAC,CAAA;aACT;YACD,MAAM,GAAG,CAAC,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAA;SAC3B;QACD,IAAI,WAAW,GAAG,MAAM,CAAC,eAAe,CAAC,SAAS,CAAC,6BAA6B,EAAE,MAAM,CAAC,CAAC;QAC1F,IAAI,WAAW,IAAI,IAAI,EAAE;YACrB,MAAM,CAAC,KAAK,CAAC,mCAAmC,GAAG,MAAM,GAAG,aAAa,CAAC,CAAC;YAC3E,OAAO,IAAI,CAAC;SACf;QAED,IAAI,MAAM,IAAI,IAAI,IAAI,MAAM,IAAI,SAAS,EAAE;YACvC,KAAK,GAAG,CAAC,KAAK,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;YACpD,MAAM,GAAG,CAAC,MAAM,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YAExD,MAAM,CAAC,QAAQ,GAAG,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAA;YACxC,MAAM,CAAC,IAAI,GAAG,KAAK,CAAA;YACnB,MAAM,CAAC,WAAW,GAAG,WAAW,CAAC;YACjC,MAAM,CAAC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YAC1B,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;SAC/B;QACD,OAAO,WAAW,CAAC;IACvB,CAAC;IAED;;;;;MAKE;IACK,mCAAkB,GAAzB,UAA0B,MAAiB,EAAE,SAAiB,EAAE,MAAuB;QAAvB,uBAAA,EAAA,cAAuB;QACnF,wEAAwE;QACxE,IAAI,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC;QAChE,IAAI,QAAQ,GAAG,aAAa,GAAG,SAAS,CAAC;QACzC,IAAI,MAAM,EAAE;YACR,QAAQ,IAAI,QAAQ,CAAC;SACxB;QACD,OAAO,MAAM,CAAC,eAAe,CAAC,aAAa,CAAC,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE;YACvE,MAAM,CAAC,QAAQ,GAAG,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAA;YACxC,MAAM,CAAC,IAAI,GAAG,KAAK,CAAA;QACvB,CAAC,EAAE,KAAK,CAAC,CAAC;IACd,CAAC;IAED;;;;OAIG;IACI,6BAAY,GAAnB,UAAoB,MAAiB,EAAE,GAAG;QACtC,wEAAwE;QACxE,IAAI,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC;QAChE,IAAI,QAAQ,GAAG,QAAQ,GAAG,GAAG,CAAC;QAC9B,OAAO,MAAM,CAAC,eAAe,CAAC,aAAa,CAAC,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;IAC5F,CAAC;IAED;;;;OAIG;IACI,iCAAgB,GAAvB,UAAwB,MAAiB,EAAE,GAAG;QAC1C,wEAAwE;QACxE,IAAI,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC;QAChE,IAAI,QAAQ,GAAG,QAAQ,GAAG,GAAG,CAAC;QAC9B,OAAO,MAAM,CAAC,eAAe,CAAC,aAAa,CAAC,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;IAC5F,CAAC;IAGD;;;;GAID;IACQ,qCAAoB,GAA3B,UAA4B,MAAiB,EAAE,GAAG;QAC9C,wEAAwE;QACxE,IAAI,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC;QAChE,IAAI,QAAQ,GAAG,QAAQ,GAAG,GAAG,CAAC;QAC9B,OAAO,MAAM,CAAC,eAAe,CAAC,aAAa,CAAC,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;IAC5F,CAAC;IAID;;;;;OAKG;IACH,2BAAU,GAAV,UAAW,IAAI,EAAE,GAAG,EAAE,MAAW;QAAX,uBAAA,EAAA,WAAW;QAC7B,IAAI,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,EAAE,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAA,CAAA,iCAAiC;QAClG,IAAI,GAAG,EAAE;YACL,GAAG,CAAC,KAAK,EAAE,CAAA;SACd;QACD,4BAA4B;QAC5B,gFAAgF;QAChF,IAAI;QACJ,iBAAiB;QACjB,QAAQ;QACR,+CAA+C;QAC/C,oCAAoC;QACpC,QAAQ;QACR,KAAK;QACL,uCAAuC;QACvC,IAAI,OAAO,CAAC,GAAG,CAAC,KAAK,QAAQ,EAAE;YAC3B,MAAM,CAAC,GAAG,CAAC,mBAAmB,EAAE,GAAG,CAAC,CAAC;YACrC,wCAAwC;YACxC,OAAO;SACV;QACD,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;QACtC,wCAAwC;IAC5C,CAAC;IAED;;;;;;OAMG;IACH,yBAAQ,GAAR,UAAS,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI;QAE3B,GAAG,CAAC,KAAK,EAAE,CAAC;QAEZ,KAAK;QACL,GAAG,CAAC,SAAS,GAAG,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;QAC/B,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACvB,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK,GAAG,GAAG,EAAE,CAAC,GAAG,KAAK,GAAG,GAAG,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;QACzD,GAAG,CAAC,IAAI,EAAE,CAAC;QACX,GAAG,CAAC,KAAK,EAAE,CAAC;QAEZ,SAAS;QACT,IAAI,MAAM,GAAG,IAAI,eAAM,CAAC,CAAC,CAAC,EAAE,4BAAmB,CAAC,CAAC,CAAC,CAAC;QACnD,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QACpB,MAAM,CAAC,IAAI,EAAE,CAAC;QACd,GAAG,CAAC,SAAS,GAAG,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;QAC/B,IAAI,IAAI,GAAG,KAAK,GAAG,MAAM,GAAG,CAAC,CAAC;QAC9B,IAAI,GAAG,GAAG,MAAM,CAAC,cAAc,EAAE,CAAC;QAElC,IAAI,KAAK,GAAG,IAAI,GAAG,GAAG,CAAC;QACvB,IAAI,KAAK,GAAG,IAAI,GAAG,GAAG,CAAC;QACvB,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACzB,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACzB,KAAK,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE;YAChC,KAAK,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE;gBAChC,IAAI,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE;oBACzB,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,GAAG,GAAG,KAAK,GAAG,KAAK,GAAG,GAAG,EAAE,IAAI,GAAG,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,MAAM,GAAG,KAAK,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;oBAClH,GAAG,CAAC,IAAI,EAAE,CAAC;iBACd;aACJ;SACJ;IACL,CAAC;IAEL,aAAC;AAAD,CAhPA,AAgPC,IAAA","file":"","sourceRoot":"/","sourcesContent":["/**\r\n * UIUtils:UI节点工具类\r\n * @author Peter\r\n */\r\n\r\nimport { QRCode, QRErrorCorrectLevel } from \"../libs/qrcode\";\r\n\r\nexport default class UIUtil {\r\n\r\n    /**\r\n    * 调整iphoneX坐标\r\n    * @param widgetsList  需要调整的widget节点\r\n    * @param offset 偏移值，默认为60\r\n    * @param isPortrait 新增竖屏变量, 处理按钮在顶部状态栏点不到\r\n    */\r\n    public adjustIphoneX(widgetsList: cc.Node[], offset = 60, isPortrait: boolean = false) {\r\n        if (widgetsList == null)\r\n            return;\r\n        if (!cc.sys.isNative)\r\n            return;\r\n        if (!Global.Setting.SystemInfo.isIphoneX)\r\n            return;\r\n        for (let i = 0; i < widgetsList.length; i++) {\r\n            let node = widgetsList[i];\r\n            if (node == null || !node.isValid)\r\n                continue;\r\n            let widght = node.getComponent(cc.Widget);\r\n            if (widght) {\r\n                if (isPortrait)\r\n                    widght.top += offset;\r\n                else\r\n                    widght.left += offset;\r\n            }\r\n        }\r\n    }\r\n\r\n    /* 设置节点的父节点，保持位置不变\r\n    * @param child 要操作节点\r\n    * @param parent 要设置到的父节点\r\n    * @param isFixed 是否保持位置不变\r\n    */\r\n    public setNodeParent(child: cc.Node, parent: cc.Node, isFixed: boolean = true) {\r\n        if (child && parent && cc.isValid(child) && cc.isValid(parent)) {\r\n            if (isFixed) {\r\n                let pos = this.convertSameNodePos(child.parent, parent, child.position);\r\n                child.setParent(parent);\r\n                child.setPosition(pos);\r\n            }\r\n            else {\r\n                child.setParent(parent);\r\n            }\r\n        }\r\n        else {\r\n            Logger.error('父子节点非法');\r\n        }\r\n    }\r\n\r\n     /**\r\n     * 将node1坐标系下的point转换到node2坐标系下的本地坐标\r\n     * @param node1 要转换坐标的父节点\r\n     * @param node2 目的父节点\r\n     * @param point 转换坐标\r\n     */\r\n    public convertSameNodePos(node1: cc.Node, node2: cc.Node, point = cc.Vec3.ZERO) {\r\n        let worldPos = node1.convertToWorldSpaceAR(point);\r\n        return node2.convertToNodeSpaceAR(worldPos);\r\n    }\r\n\r\n    public loadWebPic(node: cc.Node, url: string) {\r\n        Global.ResourceManager.load(url, (error, texture) => {\r\n            if (error) {\r\n                Logger.error(\"--------------load pic error-------\" + error.msg);\r\n                return;\r\n            }\r\n            let sp = node.getComponent(cc.Sprite);\r\n            if (!sp) {\r\n                return Logger.error(\"_________找不到Sprite_________\");\r\n            }\r\n            let headwidth = node.width;\r\n            let headHeight = node.height;\r\n            sp.spriteFrame = new cc.SpriteFrame(texture);\r\n            node.width = headwidth;\r\n            node.height = headHeight;\r\n        })\r\n    }\r\n\r\n    public getLocalHeadSf(sfName: string, sprite?: cc.Sprite, width?: number, height?: number) {\r\n        // return Global.ResourceManager.getSprite(\"hall/texture/common/headImg\", sfName);\r\n        if (sfName == null || sfName == undefined || sfName == \"\") {\r\n            Logger.error(\"getLocalHeadSf() sfName is empty, return!!!\");\r\n            return null;\r\n        }\r\n\r\n        if (Number(sfName) && Number(sfName) > Global.Setting.headNameRange) {\r\n            let id = Number(sfName) % Global.Setting.headNameRange // 2020.1.20暂时特殊处理 防止大批头像一样的问题 // grace\r\n            if (id == 0) {\r\n                id = 1\r\n            }\r\n            sfName = (id).toString()\r\n        }\r\n        let spriteFrame = Global.ResourceManager.getSprite(\"hall/texture/common/headImg\", sfName);\r\n        if (spriteFrame == null) {\r\n            Logger.error(\"getLocalHeadSf() 找不到头像, sfName = \" + sfName + \", return!!!\");\r\n            return null;\r\n        }\r\n\r\n        if (sprite != null && sprite != undefined) {\r\n            width = (width != null) ? width : sprite.node.width;\r\n            height = (height != null) ? height : sprite.node.height;\r\n\r\n            sprite.sizeMode = cc.Sprite.SizeMode.RAW\r\n            sprite.trim = false\r\n            sprite.spriteFrame = spriteFrame;\r\n            sprite.node.width = width;\r\n            sprite.node.height = height;\r\n        }\r\n        return spriteFrame;\r\n    }\r\n\r\n    /**\r\n    * 加载头像框\r\n    * @param sprite 图片精灵\r\n    * @param headKuang 头像框的id值字符串\r\n    * @param bGuang 是否发光的框\r\n    */\r\n    public loadLocalHeadFrame(sprite: cc.Sprite, headKuang: string, bGuang: boolean = false) {\r\n        //var atlasString = \"hall/texture/hall/playerInfo/AutoAtlas_playerinfo\";\r\n        var atlasString = Global.Setting.SkinConfig.playerInfoAtlasPath;\r\n        var sfString = \"txkuang_vip\" + headKuang;\r\n        if (bGuang) {\r\n            sfString += \"_guang\";\r\n        }\r\n        return Global.ResourceManager.loadAutoAtlas(sprite, atlasString, sfString, () => {\r\n            sprite.sizeMode = cc.Sprite.SizeMode.RAW\r\n            sprite.trim = false\r\n        }, false);\r\n    }\r\n\r\n    /**\r\n     * 加载vip大图标\r\n     * @param sprite 图片精灵\r\n     * @param vip vip等级\r\n     */\r\n    public loadLocalVip(sprite: cc.Sprite, vip) {\r\n        //var atlasString = \"hall/texture/hall/playerInfo/AutoAtlas_playerinfo\";\r\n        var atlasString = Global.Setting.SkinConfig.playerInfoAtlasPath;\r\n        var sfString = \"icon_v\" + vip;\r\n        return Global.ResourceManager.loadAutoAtlas(sprite, atlasString, sfString, null, false);\r\n    }\r\n\r\n    /**\r\n     * 加载vip小标识\r\n     * @param sprite 图片精灵\r\n     * @param vip vip等级\r\n     */\r\n    public loadLocalVipIcon(sprite: cc.Sprite, vip) {\r\n        //var atlasString = \"hall/texture/hall/playerInfo/AutoAtlas_playerinfo\";\r\n        var atlasString = Global.Setting.SkinConfig.playerInfoAtlasPath;\r\n        var sfString = \"vip_tq\" + vip;\r\n        return Global.ResourceManager.loadAutoAtlas(sprite, atlasString, sfString, null, false);\r\n    }\r\n\r\n\r\n    /**\r\n * 加载vip小标识子游戏调用\r\n * @param sprite 图片精灵\r\n * @param vip vip等级\r\n */\r\n    public loadLocalVipIconGame(sprite: cc.Sprite, vip) {\r\n        //var atlasString = \"hall/texture/hall/playerInfo/AutoAtlas_playerinfo\";\r\n        var atlasString = Global.Setting.SkinConfig.playerInfoAtlasPath;\r\n        var sfString = \"icon_v\" + vip;\r\n        return Global.ResourceManager.loadAutoAtlas(sprite, atlasString, sfString, null, false);\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * \r\n     * @param node 生成二维码的节点\r\n     * @param url 二维码的url\r\n     * @param margin 二维码边界空隙长宽\r\n     */\r\n    initQRCode(node, url, margin = 10) {\r\n        var ctx = Global.UIHelper.safeGetComponent(node, \"\", cc.Graphics)//node.addComponent(cc.Graphics);\r\n        if (ctx) {\r\n            ctx.clear()\r\n        }\r\n        // let Tip = new QRCodeTip()\r\n        // Global.ResourceManager.loadRes(\"hall/prefabs/ui/QRCodeTip\", (error, prefab)=>\r\n        // {\r\n        //     if(prefab)\r\n        //     {\r\n        //         Tip.setNode(cc.instantiate(prefab));\r\n        //         Tip.node.setParent(node);\r\n        //     }\r\n        // })\r\n        // Global.UI.showLodingTip(\"加载中\",node);\r\n        if (typeof (url) !== 'string') {\r\n            Logger.log('url is not string', url);\r\n            // Global.UI.hideLodingTip(\"加载失败\",node);\r\n            return;\r\n        }\r\n        this.QRCreate(ctx, url, margin, node);\r\n        // Global.UI.hideLodingTip(\"加载成功\",node);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param ctx 绘制api\r\n     * @param url 二维码的url\r\n     * @param margin 二维码边界空隙长宽\r\n     * @param node 生成二维码的节点\r\n     */\r\n    QRCreate(ctx, url, margin, node) {\r\n\r\n        ctx.clear();\r\n\r\n        //背景色\r\n        ctx.fillColor = cc.Color.WHITE;\r\n        let width = node.width;\r\n        ctx.rect(0 - width * 0.5, 0 - width * 0.5, width, width);\r\n        ctx.fill();\r\n        ctx.close();\r\n\r\n        //生成二维码数据\r\n        let qrcode = new QRCode(-1, QRErrorCorrectLevel.H);\r\n        qrcode.addData(url);\r\n        qrcode.make();\r\n        ctx.fillColor = cc.Color.BLACK;\r\n        let size = width - margin * 2;\r\n        let num = qrcode.getModuleCount();\r\n\r\n        let tileW = size / num;\r\n        let tileH = size / num;\r\n        let w = Math.ceil(tileW);\r\n        let h = Math.ceil(tileH);\r\n        for (let row = 0; row < num; row++) {\r\n            for (let col = 0; col < num; col++) {\r\n                if (qrcode.isDark(row, col)) {\r\n                    ctx.rect(margin + col * tileW - width * 0.5, size - tileH - Math.round(row * tileH) + margin - width * 0.5, w, h);\r\n                    ctx.fill();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n}"]}