{"version":3,"sources":["assets\\ddz\\ddz\\scripts\\component\\DDZTimeAutoRun.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAA4C,kCAAY;IADxD,cAAc;IACd;QAAA,qEA+CC;QA7CW,eAAS,GAAG,CAAC,CAAC;;IA6C1B,CAAC;IA1Ca,+BAAM,GAAhB;QACI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;IAC/C,CAAC;IAES,iCAAQ,GAAlB;IACA,CAAC;IAEM,iCAAQ,GAAf,UAAgB,IAAY,EAAE,QAAkB,EAAE,MAAW;QACzD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAC1B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;IACrC,CAAC;IAEO,sCAAa,GAArB;QACI,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,MAAM,EAAC;YAC9B,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACpC;IACL,CAAC;IAEO,kCAAS,GAAjB;QACI,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAU,yBAAyB;YACzD,OAAO;QACX,IAAI,CAAC,SAAS,EAAG,CAAC;QAClB,IAAI,IAAI,CAAC,SAAS,IAAI,CAAC,EAAC;YACpB,IAAI,CAAC,aAAa,EAAE,CAAC;SACxB;QACD,IAAI,CAAC,UAAU,EAAE,CAAC;IACtB,CAAC;IAES,kCAAS,GAAnB;QACI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACpC,CAAC;IAES,kCAAS,GAAnB;QACI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACpC,CAAC;IAEO,mCAAU,GAAlB;QACI,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,KAAG,IAAI,CAAC,SAAW,CAAC;IAC9C,CAAC;IA9CgB,cAAc;QAFlC,OAAO;QACR,cAAc;OACO,cAAc,CA+ClC;IAAD,qBAAC;CA/CD,AA+CC,CA/C2C,EAAE,CAAC,SAAS,GA+CvD;kBA/CoB,cAAc","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n@ccclass\r\n//倒计时组件  提供倒计时\r\nexport default class DDZTimeAutoRun extends cc.Component{\r\n    private timeLbl: cc.Label;\r\n    private totalTime = 5;\r\n    private finishCal: Function;\r\n    private target: any;\r\n    protected onLoad(){\r\n        this.timeLbl = this.getComponent(cc.Label);\r\n    }\r\n\r\n    protected onEnable(){\r\n    }\r\n\r\n    public setTimer(time: number, callback: Function, target: any){\r\n        this.totalTime = time;\r\n        this.finishCal = callback;\r\n        this.target = target;\r\n        this.setTimeLbl();\r\n        this.schedule(this.onTimeRun, 1);\r\n    }\r\n\r\n    private onTimerFinish(){\r\n        if (this.finishCal && this.target){\r\n            this.finishCal.call(this.target);\r\n        }\r\n    }\r\n\r\n    private onTimeRun(){\r\n        if (!cc.isValid(this.node))         // debug退出时 实际还未销毁, 可能还在跑\r\n            return;\r\n        this.totalTime --;\r\n        if (this.totalTime == 0){\r\n            this.onTimerFinish();\r\n        }\r\n        this.setTimeLbl();\r\n    }\r\n\r\n    protected onDisable(){\r\n        this.unschedule(this.onTimeRun);\r\n    }\r\n\r\n    protected onDestroy(){\r\n        this.unschedule(this.onTimeRun);\r\n    }\r\n\r\n    private setTimeLbl(){\r\n        this.timeLbl.string = `${this.totalTime}`;\r\n    }\r\n}"]}