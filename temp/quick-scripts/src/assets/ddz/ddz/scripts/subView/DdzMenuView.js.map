{"version":3,"sources":["assets\\ddz\\ddz\\scripts\\subView\\DdzMenuView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DdzBaseView from \"./DdzBaseView\";\r\nimport DdzPathHelper, { DdzAudioConst } from \"../data/DdzPathHelper\";\r\nimport DdzDriver from \"../DdzDriver\";\r\nimport DdzGameConst from \"../data/DdzGameConst\";\r\n\r\nexport default class DdzMenuView extends DdzBaseView{\r\n    private bgNode: cc.Node;\r\n    private isPressed: boolean = false;\r\n    private pressDownBtn: cc.Node;\r\n    private pressUpBtn: cc.Node;\r\n    private menuContainer: cc.Node;\r\n    private menuRawPos: cc.Vec3;\r\n\r\n    constructor(node: cc.Node){\r\n        super();\r\n        this.setNode(node);\r\n    }\r\n\r\n    protected initView(){\r\n        this.bgNode = this.getChild('maskBg');\r\n        this.bgNode.active = false;\r\n        DdzGameConst.addCommonClick(this.bgNode, \"\", this.onBgTouch, this, cc.Button.Transition.NONE);\r\n        this.pressDownBtn = this.getChild(\"menuBtn/sprite_down\");\r\n        this.pressDownBtn.active = true;\r\n        this.pressUpBtn = this.getChild(\"menuBtn/sprite_up\");\r\n        this.pressUpBtn.active = false;\r\n        DdzGameConst.addCommonClick(this.node, \"menuBtn\", this.onMenuBtnClick, this);\r\n\r\n        this.menuContainer = this.getChild(\"maskNode/menuContainer\");\r\n        this.menuRawPos = this.menuContainer.position;\r\n        this.menuContainer.active = false;\r\n        this.menuContainer.setPosition(0, this.menuContainer.height);\r\n        \r\n        DdzGameConst.addCommonClick(this.node, \"maskNode/menuContainer/settingBtn\", this.onSettingBtnClick, this);\r\n        DdzGameConst.addCommonClick(this.node, \"maskNode/menuContainer/ruleBtn\", this.onRuleBtnClick, this);\r\n        DdzGameConst.addCommonClick(this.node, \"maskNode/menuContainer/exitBtn\", this.onExitBtnClick, this);\r\n    }\r\n\r\n    private onBgTouch(){\r\n        this.bgNode.active = false;\r\n        this.menuBtnClick();\r\n    }\r\n\r\n    private menuBtnClick(isTween = true) {\r\n        if (this.isPressed) {\r\n            this.isPressed = false;\r\n            this.pressUpBtn.active = false;\r\n            this.pressDownBtn.active = true;\r\n            this.bgNode.active = false;\r\n\r\n            this.menuContainer.stopAllActions();\r\n            let endPos = cc.v2(this.menuRawPos.x, this.menuRawPos.y + this.menuContainer.height);\r\n            if (isTween){\r\n                this.menuContainer.runAction(cc.moveTo(0.2, endPos).easing(cc.easeBackIn()));\r\n            }\r\n            else{\r\n                this.menuContainer.setPosition(endPos);\r\n            }\r\n        } else {\r\n            this.isPressed = true;\r\n            this.pressUpBtn.active = true;\r\n            this.pressDownBtn.active = false;\r\n\r\n            this.menuContainer.active = true;\r\n            this.bgNode.active = true;\r\n\r\n            this.menuContainer.stopAllActions();\r\n            if (isTween){\r\n                this.menuContainer.runAction(cc.moveTo(0.2, cc.v2(this.menuRawPos.x, this.menuRawPos.y)).easing(cc.easeBackOut()));\r\n            }\r\n            else{\r\n                this.menuContainer.setPosition(cc.v2(this.menuRawPos.x, this.menuRawPos.y));\r\n            }\r\n        }\r\n    }\r\n\r\n    private onMenuBtnClick(){\r\n        Global.Audio.playGameBundleSound(DdzAudioConst.audioCommonPath + DdzAudioConst.commonAudio.ButtonClick, true);\r\n        this.menuBtnClick();\r\n    }\r\n\r\n    private onSettingBtnClick(){\r\n        this.menuBtnClick();\r\n        Global.Audio.playGameBundleSound(DdzAudioConst.audioCommonPath + DdzAudioConst.commonAudio.ButtonClick, true);\r\n        DdzDriver.instance.openSettingPop();\r\n    }\r\n\r\n    private onRuleBtnClick(){\r\n        this.menuBtnClick();\r\n        Global.Audio.playGameBundleSound(DdzAudioConst.audioCommonPath + DdzAudioConst.commonAudio.ButtonClick, true);\r\n        DdzDriver.instance.openRulePop();\r\n    }\r\n\r\n    private onExitBtnClick(){\r\n        Global.Audio.playGameBundleSound(DdzAudioConst.audioCommonPath + DdzAudioConst.commonAudio.ButtonClick, true);\r\n        this.menuBtnClick(false);\r\n        \r\n        let inGame = this.Context.get(this.Define.FieldGameStart);\r\n        if(inGame){\r\n            Global.UI.showYesNoBox('退出后将自动变为托管出牌，且在牌局结束前无法进入其他游戏。确定退出吗？', ()=>{\r\n                Game.Server.send(this.Define.CmdLeave, { \"IsClose\": 1 });\r\n                DdzDriver.instance.leaveGame();\r\n            });\r\n        }\r\n        else{\r\n            Game.Server.send(this.Define.CmdLeave, { \"IsClose\": 1 });\r\n            DdzDriver.instance.leaveGame();\r\n            Global.UI.close(\"WndMessageBox\");\r\n        }\r\n    }\r\n\r\n    public clearByGame(){\r\n        if(this.isPressed){\r\n            this.menuBtnClick(false);\r\n        }\r\n    }\r\n}"]}