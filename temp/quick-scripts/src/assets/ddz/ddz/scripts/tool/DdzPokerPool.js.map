{"version":3,"sources":["assets\\ddz\\ddz\\scripts\\tool\\DdzPokerPool.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DdzPokerView from \"../subView/DdzPokerView\";\r\nimport DdzPathHelper from \"../data/DdzPathHelper\";\r\nimport DdzPokerHelper from \"../data/DdzPokerHelper\";\r\n\r\nexport default class DdzPokerPool{\r\n    private pool: Array<DdzPokerView> =  [];\r\n    private preCount = 54;\r\n\r\n    constructor(private rootNode: cc.Node){\r\n        this.preCreate();\r\n    }\r\n\r\n        /**\r\n     * 扑克牌的面值：A-K 小鬼 大鬼\r\n     * 索引值为前端定义 数组中的值为后端定义\r\n     */\r\n    static readonly POKER_VALUE = [\r\n        0x0E, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D,  //--方块 A - K\r\n        0x1E, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D,  //--梅花 A - K\r\n        0x2E, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D,  //--红桃 A - K\r\n        0x3E, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D,  //--黑桃 A - K\r\n        0x4F, 0x5F  //小鬼 大鬼\r\n    ];\r\n\r\n    private preCreate(){\r\n        let count = 0;\r\n        let loadByFrame = ()=>{\r\n            for(let i = 0; i < this.preCount /2; i++){\r\n                let item = this.createItem();\r\n                this.recycleItem(item);\r\n                count++;\r\n                if (count >= this.preCount){\r\n                    Game.Component.unschedule(loadByFrame);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        Game.Component.schedule(loadByFrame, 0);\r\n    }\r\n\r\n    private createItem(){\r\n        let prefab = Global.ResourceManager.getGameBundleRes(DdzPathHelper.gamePrefabsPath + \"panel/subView/pokerPreNode\", cc.Prefab);\r\n        let node: cc.Node = cc.instantiate(prefab);\r\n        node.setParent(this.rootNode);\r\n        let item = new DdzPokerView(node);\r\n        return item;\r\n    }\r\n\r\n    private resetItem(item: DdzPokerView){\r\n        item.active = false;\r\n        item.reset();\r\n        item.node.setParent(this.rootNode);\r\n    }\r\n\r\n    public getItem(): DdzPokerView{\r\n        if (this.pool.length > 0){\r\n            return this.pool.pop();\r\n        }\r\n        return this.createItem();\r\n    }\r\n\r\n    public getItemArr(count: number): DdzPokerView[]{\r\n        let arr = [];\r\n        for(let i=0; i< count; i++){\r\n            let item = this.getItem();\r\n            arr.push(item);\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    public recycleItem(item: DdzPokerView){\r\n        this.resetItem(item);\r\n        this.pool.push(item);\r\n    }\r\n\r\n    public recycleAll(arr: Array<DdzPokerView>){\r\n        arr.forEach(ele => {\r\n            this.recycleItem(ele);\r\n        });\r\n    }\r\n\r\n    public resetPool(){\r\n        this.pool = [];\r\n    }\r\n\r\n       /**\r\n     * 根据扑克的值 得扑克花色索引\r\n     * @param value 后端定义的扑克牌的值\r\n     * @return number 0-黑桃 1-红心 2-草花 3-方块 4-鬼牌（小鬼） 5-鬼牌（大鬼）\r\n     */\r\n    static GetPokerHuaseByValue(value:number):number{\r\n        var index = DdzPokerPool.POKER_VALUE.indexOf(value);\r\n        if(index < 0){\r\n            Logger.error(\"计算花色错误：\" + value);\r\n            return -1;\r\n        }\r\n        var huase = Math.floor(index / 13);\r\n        if(huase >= 4){\r\n            //鬼牌\r\n            if(index == 52){\r\n                return 4;//4\r\n            }else if(index == 53){\r\n                return 5;//5\r\n            }\r\n            Logger.error(\"计算鬼牌花色错误：\" + value);\r\n            return -1;\r\n        }\r\n\r\n        return huase;\r\n    }\r\n\r\n        /**\r\n     * 根据扑克的值 得扑克面值\r\n     * @param value 后端定义的扑克牌的值\r\n     * @return number 0-12:A-K 如果是鬼牌，-1:鬼牌\r\n     */\r\n    static GetPokerNumByValue(value:number):number{\r\n        var index = DdzPokerPool.POKER_VALUE.indexOf(value);\r\n        if(index < 0){\r\n            Logger.error(\"计算面值错误：\" + value);\r\n            return -2;\r\n        }else if(index >= 52){\r\n            return -1;\r\n        }\r\n        var num = Math.floor(index % 13);\r\n        return num;\r\n    }\r\n}"]}