{"version":3,"sources":["assets\\bbwz\\Bbwz\\scripts\\panel\\BbwzSettingPop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BbwzConstDefine from \"../data/BbwzConstDefine\";\r\nimport BbwzBaseView from \"../subview/BbwzBaseView\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n/**\r\n * 弹窗 设置界面\r\n */\r\n@ccclass\r\nexport default class BbwzSettingPop extends cc.Component{\r\n    private maskNode: cc.Node;\r\n    private contentNode: cc.Node;\r\n    private animComp: any;\r\n    private versionLbl: cc.Label;\r\n    \r\n    protected onLoad(){\r\n        this.node.setContentSize(cc.Canvas.instance.node.getContentSize());\r\n        this.maskNode = cc.find(\"mask\", this.node);\r\n        this.contentNode = cc.find(\"content\", this.node);\r\n        this.animComp = Global.UIHelper.addAnimComp(this.node, this.contentNode, this.maskNode);\r\n\r\n        BbwzConstDefine.addCommonClick(this.contentNode, \"button_close\", this.onCloseClick, this);\r\n        BbwzConstDefine.addCommonClick(this.node, \"mask\", this.onCloseClick, this,cc.Button.Transition.NONE);\r\n\r\n        this.versionLbl = cc.find('content/label_version', this.node).getComponent(cc.Label);\r\n        let gameInfo = Global.GameData.getGameInfo(BbwzConstDefine.GAME_ID);\r\n        if(gameInfo)\r\n            this.versionLbl.string = `版本号:V${gameInfo.native_version}`;\r\n            \r\n        this.initToggle();\r\n    }\r\n\r\n    private initToggle(){\r\n        let musicEnable = Global.Setting.settingData.musicEnable;\r\n        let soundEnable = Global.Setting.settingData.soundEnable;\r\n        let musicToggle = new SetToggle(cc.find(\"musicToggle\", this.contentNode), this.onMusicToggle, this);\r\n        let soundToggle = new SetToggle(cc.find(\"soundToggle\", this.contentNode), this.onAudioToggle, this);\r\n        musicToggle.isChecked = musicEnable;\r\n        soundToggle.isChecked = soundEnable;\r\n    }\r\n\r\n    protected onEnable(){\r\n        this.animComp.doPopupOpenAnim();\r\n    }\r\n\r\n    private onCloseClick(){\r\n        BbwzConstDefine.playBtnSound();\r\n        this.animComp.doPopupCloseAnim(()=>{\r\n            this.node.active = false;\r\n        });\r\n    }\r\n\r\n    private onMusicToggle(toggle: SetToggle){\r\n        BbwzConstDefine.playBtnSound();\r\n        let state = toggle.isChecked;\r\n        Global.Audio.setMusicEnable(state);\r\n    }\r\n\r\n    private onAudioToggle(toggle: SetToggle){\r\n        BbwzConstDefine.playBtnSound();\r\n        let state = toggle.isChecked;\r\n        Global.Audio.setSoundEnable(state);\r\n    }\r\n}\r\n\r\nclass SetToggle extends BbwzBaseView{\r\n    private normalNode: cc.Node;\r\n    private checkNode: cc.Node;\r\n    private _isCheck: boolean;\r\n\r\n    constructor(node: cc.Node, private callback: Function, private target: any){\r\n        super();\r\n        this.setNode(node);\r\n    }\r\n\r\n    protected initView(){\r\n        this.normalNode = this.getChild(\"close\");\r\n        this.checkNode = this.getChild(\"open\");\r\n        BbwzConstDefine.addCommonClick(this.node, \"\", this.onToggleClick, this);\r\n    }\r\n\r\n    private onToggleClick(){\r\n        this.isChecked = !this._isCheck;\r\n        if (this.callback && this.target){\r\n            this.callback.call(this.target, this);\r\n        }\r\n    }\r\n\r\n    public set isChecked(flag: boolean){\r\n        if (flag === this._isCheck)\r\n            return;\r\n        this._isCheck = flag;\r\n        this.updateStyle();\r\n    }\r\n\r\n    public get isChecked(){\r\n        return this._isCheck;\r\n    }\r\n\r\n    private updateStyle(){\r\n        this.normalNode.active = !this._isCheck;\r\n        this.checkNode.active = !!this._isCheck;\r\n    }\r\n}"]}