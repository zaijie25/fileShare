{"version":3,"sources":["assets\\bbwz\\Bbwz\\scripts\\subview\\BbwzMenuView.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,+CAA0C;AAC1C,2DAAyE;AACzE,4CAAuC;AACvC,6CAAwC;AAExC;IAA0C,gCAAY;IAOlD,sBAAY,IAAa;QAAzB,YACI,iBAAO,SAEV;QARO,eAAS,GAAY,KAAK,CAAC;QAO/B,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;;IACvB,CAAC;IAES,+BAAQ,GAAlB;QACI,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACtC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC;QAC3B,yBAAe,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QACrG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC;QACzD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC;QACrD,yBAAe,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QAEhF,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,wBAAwB,CAAC,CAAC;QAC7D,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;QAClC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC7D,yBAAe,CAAC,cAAc,CAAC,IAAI,CAAC,aAAa,EAAE,YAAY,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;QAC/F,yBAAe,CAAC,cAAc,CAAC,IAAI,CAAC,aAAa,EAAE,SAAS,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QACzF,yBAAe,CAAC,cAAc,CAAC,IAAI,CAAC,aAAa,EAAE,SAAS,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;IAC7F,CAAC;IAEO,gCAAS,GAAjB;QACI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC;QAC3B,IAAI,CAAC,YAAY,EAAE,CAAC;IACxB,CAAC;IAEO,mCAAY,GAApB,UAAqB,OAAuB;QAAvB,wBAAA,EAAA,cAAuB;QACxC,IAAI,IAAI,CAAC,SAAS,EAAE;YAChB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACvB,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,KAAK,CAAC;YAC/B,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC;YAChC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC;YAE3B,IAAI,CAAC,aAAa,CAAC,cAAc,EAAE,CAAC;YACpC,IAAI,OAAO,EAAC;gBACR,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;aAC7G;iBACG;gBACA,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;aACvE;SACJ;aAAM;YACH,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;YAC9B,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,KAAK,CAAC;YAEjC,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,IAAI,CAAC;YACjC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC;YAE1B,IAAI,CAAC,aAAa,CAAC,cAAc,EAAE,CAAC;YACpC,IAAI,OAAO,EAAC;gBACR,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;aACvF;iBACG;gBACA,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAChD;SACJ;IACL,CAAC;IAEO,qCAAc,GAAtB;QACI,yBAAe,CAAC,YAAY,EAAE,CAAC;QAC/B,IAAI,CAAC,YAAY,EAAE,CAAC;IACxB,CAAC;IAEO,wCAAiB,GAAzB;QACI,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,yBAAe,CAAC,YAAY,EAAE,CAAC;QAC/B,oBAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACtD,CAAC;IAEO,qCAAc,GAAtB;QACI,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,yBAAe,CAAC,YAAY,EAAE,CAAC;QAC/B,oBAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACnD,CAAC;IAEO,qCAAc,GAAtB;QACI,yBAAe,CAAC,YAAY,EAAE,CAAC;QAC/B,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAEzB,IAAI,kBAAQ,CAAC,QAAQ,CAAC,SAAS,IAAI,+BAAa,CAAC,MAAM,EAAE;YACrD,SAAS;YACT,oBAAU,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;YACnC,OAAO;SACV;aAAM;YACH,YAAY;YACZ,IAAI,UAAU,GAAW,kBAAQ,CAAC,QAAQ,CAAC,aAAa,EAAE,CAAC;YAC3D,IAAI,UAAU,IAAI,CAAC,EAAE;gBACjB,cAAc;gBACd,oBAAU,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;gBACnC,OAAO;aACV;SACJ;QACD,IAAI,IAAI,GAAG,iCAAiC,CAAC;QAC7C,oBAAU,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACjD,oBAAU,CAAC,QAAQ,CAAC,SAAS,CAAC,mBAAmB,CAAC,IAAI,EAAE,CAAC,EAAE;YACvD,oBAAU,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;QACvC,CAAC,CAAC,CAAC;IACP,CAAC;IAEM,kCAAW,GAAlB;QACI,IAAG,IAAI,CAAC,SAAS,EAAC;YACd,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;SAC5B;IACL,CAAC;IACL,mBAAC;AAAD,CA/GA,AA+GC,CA/GyC,sBAAY,GA+GrD","file":"","sourceRoot":"/","sourcesContent":["import BbwzBaseView from \"./BbwzBaseView\";\r\nimport BbwzConstDefine, { BbwzGameState } from \"../data/BbwzConstDefine\";\r\nimport BbwzDriver from \"../BbwzDriver\";\r\nimport BbwzData from \"../data/BbwzData\";\r\n\r\nexport default class BbwzMenuView extends BbwzBaseView{\r\n    private bgNode: cc.Node;\r\n    private isPressed: boolean = false;\r\n    private pressDownBtn: cc.Node;\r\n    private pressUpBtn: cc.Node;\r\n    private menuContainer: cc.Node;\r\n\r\n    constructor(node: cc.Node){\r\n        super();\r\n        this.setNode(node);\r\n    }\r\n\r\n    protected initView(){\r\n        this.bgNode = this.getChild('maskBg');\r\n        this.bgNode.active = false;\r\n        BbwzConstDefine.addCommonClick(this.node, \"maskBg\", this.onBgTouch, this, cc.Button.Transition.NONE);\r\n        this.pressDownBtn = this.getChild(\"menuBtn/sprite_down\");\r\n        this.pressUpBtn = this.getChild(\"menuBtn/sprite_up\");\r\n        BbwzConstDefine.addCommonClick(this.node, \"menuBtn\", this.onMenuBtnClick, this);\r\n\r\n        this.menuContainer = this.getChild(\"maskNode/menuContainer\");\r\n        this.menuContainer.active = false;\r\n        this.menuContainer.setPosition(0, this.menuContainer.height);\r\n        BbwzConstDefine.addCommonClick(this.menuContainer, \"settingBtn\", this.onSettingBtnClick, this);\r\n        BbwzConstDefine.addCommonClick(this.menuContainer, \"ruleBtn\", this.onRuleBtnClick, this);\r\n        BbwzConstDefine.addCommonClick(this.menuContainer, \"exitBtn\", this.onExitBtnClick, this);\r\n    }\r\n\r\n    private onBgTouch(){\r\n        this.bgNode.active = false;\r\n        this.menuBtnClick();\r\n    }\r\n\r\n    private menuBtnClick(isTween: boolean = true){\r\n        if (this.isPressed) {\r\n            this.isPressed = false;\r\n            this.pressUpBtn.active = false;\r\n            this.pressDownBtn.active = true;\r\n            this.bgNode.active = false;\r\n\r\n            this.menuContainer.stopAllActions();\r\n            if (isTween){\r\n                this.menuContainer.runAction(cc.moveTo(0.2, cc.v2(0, this.menuContainer.height)).easing(cc.easeBackIn()));\r\n            }\r\n            else{\r\n                this.menuContainer.setPosition(cc.v2(0, this.menuContainer.height));\r\n            }\r\n        } else {\r\n            this.isPressed = true;\r\n            this.pressUpBtn.active = true;\r\n            this.pressDownBtn.active = false;\r\n\r\n            this.menuContainer.active = true;\r\n            this.bgNode.active = true;\r\n\r\n            this.menuContainer.stopAllActions();\r\n            if (isTween){\r\n                this.menuContainer.runAction(cc.moveTo(0.2, cc.Vec2.ZERO).easing(cc.easeBackOut()));\r\n            }\r\n            else{\r\n                this.menuContainer.setPosition(cc.Vec2.ZERO);\r\n            }\r\n        }\r\n    }\r\n\r\n    private onMenuBtnClick(){\r\n        BbwzConstDefine.playBtnSound();\r\n        this.menuBtnClick();\r\n    }\r\n\r\n    private onSettingBtnClick(){\r\n        this.menuBtnClick();\r\n        BbwzConstDefine.playBtnSound();\r\n        BbwzDriver.instance.settingPop.node.active = true;\r\n    }\r\n\r\n    private onRuleBtnClick(){\r\n        this.menuBtnClick();\r\n        BbwzConstDefine.playBtnSound();\r\n        BbwzDriver.instance.rulePop.node.active = true;\r\n    }\r\n\r\n    private onExitBtnClick(){\r\n        BbwzConstDefine.playBtnSound();\r\n        this.menuBtnClick(false);\r\n\r\n        if (BbwzData.instance.gameState >= BbwzGameState.Reward) {\r\n            //当前局已经开奖\r\n            BbwzDriver.instance.reqLeaveGame();\r\n            return;\r\n        } else {\r\n            //判断自己是否已经下注\r\n            let myTotalBet: number = BbwzData.instance.getMyTotalBet();\r\n            if (myTotalBet <= 0) {\r\n                //自己没下注，可以直接退出\r\n                BbwzDriver.instance.reqLeaveGame();\r\n                return;\r\n            }\r\n        }\r\n        var text = \"您已开始游戏，退出游戏会自动托管，不影响金币结算，确定退出吗？\";\r\n        BbwzDriver.instance.noticePop.node.active = true;\r\n        BbwzDriver.instance.noticePop.setCustomMessageBox(text, 0, () => {\r\n            BbwzDriver.instance.reqLeaveGame();         \r\n        });\r\n    }\r\n\r\n    public clearByGame(){\r\n        if(this.isPressed){\r\n            this.menuBtnClick(false);\r\n        }\r\n    }\r\n}"]}