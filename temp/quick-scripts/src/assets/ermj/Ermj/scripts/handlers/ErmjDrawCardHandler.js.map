{"version":3,"sources":["assets\\ermj\\Ermj\\scripts\\handlers\\ErmjDrawCardHandler.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,qDAAgD;AAChD,uDAAkD;AAElD;IAAiD,uCAAe;IAAhE;;IAsBA,CAAC;IArBa,qCAAO,GAAjB,UAAkB,GAAG;QACjB,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QACjD,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;QAEzC,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAChE,IAAI,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE,CAAC;QAClC,IAAI,UAAU,GAAG,GAAG,CAAC,KAAK,CAAC,SAAS,IAAI,CAAC,CAAC;QAC1C,IAAI,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;QAC/D,IAAI,YAAY,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,EAAC;YACzG,IAAI,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;YAChD,IAAI,KAAK,GAAG,uBAAa,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,YAAY,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,MAAM,IAAI,CAAC,CAAC,CAAC;YACjG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,SAAS,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACrF;aACG;YACA,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,SAAS,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SACrF;IACL,CAAC;IAES,yCAAW,GAArB,UAAsB,GAAG;QACrB,uBAAuB;IAC3B,CAAC;IACL,0BAAC;AAAD,CAtBA,AAsBC,CAtBgD,yBAAe,GAsB/D","file":"","sourceRoot":"/","sourcesContent":["import ErmjBaseHandler from \"./ErmjBaseHandler\";\r\nimport ErmjRuleConst from \"../data/ErmjRuleConst\";\r\n\r\nexport default class ErmjDrawCardHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        this.mainUI.callAllPlayers(\"showStateSp\", false);\r\n        this.mainUI.askActionView.active = false;\r\n        \r\n        let localSeat = this.SitHelper.serverSToLocalN(msg._para.chair);\r\n        let cards = msg._para.cards || [];\r\n        let isHeadDraw = msg._para.head_draw == 1;\r\n        let tingDataList = this.context.get(this.Define.FieldTingData);\r\n        if (tingDataList && !Global.Toolkit.isEmptyObject(tingDataList) && this.context.get(this.Define.FieldInTing)){\r\n            let random = Global.Toolkit.getRoundInteger(10);\r\n            let isRub = ErmjRuleConst.checkAlmostWin(cards[0], tingDataList) && (random <= 1 || random >= 9);\r\n            this.mainUI.onDrawCard(localSeat, cards, isHeadDraw, msg._para.left_count, isRub);\r\n        }\r\n        else{\r\n            this.mainUI.onDrawCard(localSeat, cards, isHeadDraw, msg._para.left_count, false);\r\n        }\r\n    }\r\n\r\n    protected executeSync(msg){\r\n        // 重连不会进这个协议, 合并到deal里了\r\n    }\r\n}"]}