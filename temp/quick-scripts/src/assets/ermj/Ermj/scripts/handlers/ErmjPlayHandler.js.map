{"version":3,"sources":["assets\\ermj\\Ermj\\scripts\\handlers\\ErmjPlayHandler.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ErmjBaseHandler from \"./ErmjBaseHandler\";\r\n\r\nexport class ErmjPlayStartHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        this.context.set(this.Define.FieldHandActionEnable, true);\r\n        this.mainUI.diceAnimComp.node.active = false;\r\n        this.mainUI.askBtnView.setAutoPlayBtnShow(true);\r\n    }\r\n}\r\n\r\nexport class ErmjCallPlayHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        this.mainUI.callAllPlayers(\"showStateSp\", false);\r\n        this.mainUI.askActionView.active = false;\r\n        let time = 0;\r\n        let serverTime = msg._times;\r\n        if (serverTime && Game.Component.correctTime){\r\n            let dev = Game.Component.correctTime(serverTime);\r\n            time = msg._timeo * 1000 - dev;\r\n        }\r\n        else{\r\n            time = msg._timeo * 1000 - (Date.now() - msg._receiveTime);\r\n        }\r\n        if (!time || time <= 0)\r\n            time = 1000;\r\n        \r\n        let localSeat = this.SitHelper.serverSToLocalN(msg._src);\r\n        this.mainUI.askNoticeView.whichLocationTurn(localSeat);\r\n        this.mainUI.askNoticeView.setTimeRunConfig(Math.round(time / 1000), null, null);\r\n        Game.Component.scheduleOnce(()=>{\r\n            this.mainUI.callMjPlayer(localSeat, \"readyForOut\", msg._para.draw_card);     // 重连时等UI初始化帧结束, 下一帧再执行\r\n        }, 0);\r\n        if (localSeat == 0){\r\n            this.context.set(this.Define.FieldInPlayTurn, true);\r\n            this.mainUI.selfPlayView.showPlayTips(true);\r\n            this.mainUI.selfPlayView.readyForOut(msg._para.draw_card);\r\n        }\r\n    }\r\n}\r\n\r\nexport class ErmjPlayHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        let localSeat = this.SitHelper.serverSToLocalN(msg._src);\r\n        if (localSeat == 0){\r\n            this.context.set(this.Define.FieldInPlayTurn, false);\r\n            this.mainUI.selfPlayView.showPlayTips(false);\r\n            this.mainUI.askActionView.active = false;\r\n        }\r\n        this.mainUI.onPlay(localSeat, msg._para.card, msg._para.flag == 1);\r\n    }\r\n\r\n    protected  executeSync(msg){\r\n        \r\n    }\r\n}\r\n\r\nexport class ErmjChowHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        let localSeat = this.SitHelper.serverSToLocalN(msg._src);\r\n        let whoSeat = this.SitHelper.serverSToLocalN(msg._para.who);\r\n        this.mainUI.onChow(localSeat, msg._para.cards, msg._para.chow_card, whoSeat);\r\n    }\r\n}\r\n\r\nexport class ErmjPongHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        let localSeat = this.SitHelper.serverSToLocalN(msg._src);\r\n        let whoSeat = this.SitHelper.serverSToLocalN(msg._para.who);\r\n        this.mainUI.onPong(localSeat, msg._para.cards, whoSeat);\r\n    }\r\n}\r\n\r\nexport class ErmjKongHandler extends ErmjBaseHandler{\r\n    protected execute(msg){\r\n        let localSeat = this.SitHelper.serverSToLocalN(msg._src);\r\n        let whoSeat = this.SitHelper.serverSToLocalN(msg._para.who);\r\n        this.mainUI.onKong(localSeat, msg._para.cards || [], msg._para.type, whoSeat);\r\n    }\r\n}"]}